System.register([], function(_export, _context) { return { execute: function () {
System.register("chunks:///_virtual/env",[],(function(I){return{execute:function(){I("HTML5",!0),I("NATIVE",!1),I("ANDROID",!1),I("IOS",!1),I("MAC",!1),I("WINDOWS",!1),I("LINUX",!1),I("OHOS",!1),I("OPEN_HARMONY",!1),I("WECHAT",!1),I("WECHAT_MINI_PROGRAM",!1),I("BAIDU",!1),I("XIAOMI",!1),I("ALIPAY",!1),I("TAOBAO",!1),I("TAOBAO_MINIGAME",!1),I("BYTEDANCE",!1),I("OPPO",!1),I("VIVO",!1),I("HUAWEI",!1),I("COCOSPLAY",!1),I("QTT",!1),I("LINKSURE",!1),I("MIGU",!1),I("EDITOR",!1),I("EDITOR_NOT_IN_PREVIEW",!1),I("PREVIEW",!1),I("BUILD",!0),I("TEST",!1),I("DEBUG",!1),I("DEV",!1),I("MINIGAME",!1),I("RUNTIME_BASED",!1),I("SUPPORT_JIT",!0),I("JSB",!1),I("NET_MODE",0)}}}));

System.register("chunks:///_virtual/rollupPluginModLoBabelHelpers.js",[],(function(t){return{execute:function(){function e(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function r(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,p(n.key),n)}}function n(e){return(n=t("getPrototypeOf",Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)}))(e)}function o(e,r){return(o=t("setPrototypeOf",Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t}))(e,r)}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function a(e,r,n){return(a=i()?t("construct",Reflect.construct.bind()):t("construct",(function(t,e,r){var n=[null];n.push.apply(n,e);var i=new(Function.bind.apply(t,n));return r&&o(i,r.prototype),i}))).apply(null,arguments)}function u(t){return-1!==Function.toString.call(t).indexOf("[native code]")}function c(e){var r="function"==typeof Map?new Map:void 0;return(c=t("wrapNativeSuper",(function(t){if(null===t||!u(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==r){if(r.has(t))return r.get(t);r.set(t,e)}function e(){return a(t,arguments,n(this).constructor)}return e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),o(e,t)})))(e)}function l(t,e){if(t){if("string"==typeof t)return f(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?f(t,e):void 0}}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function s(t,e){if("object"!=typeof t||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function p(t){var e=s(t,"string");return"symbol"==typeof e?e:String(e)}t({applyDecoratedDescriptor:function(t,e,r,n,o){var i={};Object.keys(n).forEach((function(t){i[t]=n[t]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0);i=r.slice().reverse().reduce((function(r,n){return n(t,e,r)||r}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0);void 0===i.initializer&&(Object.defineProperty(t,e,i),i=null);return i},arrayLikeToArray:f,assertThisInitialized:function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t},asyncToGenerator:function(t){return function(){var r=this,n=arguments;return new Promise((function(o,i){var a=t.apply(r,n);function u(t){e(a,o,i,u,c,"next",t)}function c(t){e(a,o,i,u,c,"throw",t)}u(void 0)}))}},construct:a,createClass:function(t,e,n){e&&r(t.prototype,e);n&&r(t,n);return Object.defineProperty(t,"prototype",{writable:!1}),t},createForOfIteratorHelperLoose:function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=l(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},getPrototypeOf:n,inheritsLoose:function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,o(t,e)},initializerDefineProperty:function(t,e,r,n){if(!r)return;Object.defineProperty(t,e,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(n):void 0})},isNativeFunction:u,isNativeReflectConstruct:i,regeneratorRuntime:function(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */
t("regeneratorRuntime",(function(){return r}));var e,r={},n=Object.prototype,o=n.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},u=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(e){f=function(t,e,r){return t[e]=r}}function s(t,e,r,n){var o=e&&e.prototype instanceof g?e:g,a=Object.create(o.prototype),u=new T(n||[]);return i(a,"_invoke",{value:E(t,r,u)}),a}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}r.wrap=s;var h="suspendedStart",y="executing",v="completed",d={};function g(){}function b(){}function m(){}var w={};f(w,u,(function(){return this}));var O=Object.getPrototypeOf,L=O&&O(O(k([])));L&&L!==n&&o.call(L,u)&&(w=L);var j=m.prototype=g.prototype=Object.create(w);function x(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function P(t,e){function r(n,i,a,u){var c=p(t[n],t,i);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==typeof f&&o.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(f).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var n;i(this,"_invoke",{value:function(t,o){function i(){return new e((function(e,n){r(t,o,e,n)}))}return n=n?n.then(i,i):i()}})}function E(t,r,n){var o=h;return function(i,a){if(o===y)throw new Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=_(u,n);if(c){if(c===d)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var l=p(t,r,n);if("normal"===l.type){if(o=n.done?v:"suspendedYield",l.arg===d)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(o=v,n.method="throw",n.arg=l.arg)}}}function _(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,_(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=p(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,d;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,d):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,d)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function N(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function k(t){if(t||""===t){var r=t[u];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function r(){for(;++n<t.length;)if(o.call(t,n))return r.value=t[n],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(typeof t+" is not iterable")}return b.prototype=m,i(j,"constructor",{value:m,configurable:!0}),i(m,"constructor",{value:b,configurable:!0}),b.displayName=f(m,l,"GeneratorFunction"),r.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,f(t,l,"GeneratorFunction")),t.prototype=Object.create(j),t},r.awrap=function(t){return{__await:t}},x(P.prototype),f(P.prototype,c,(function(){return this})),r.AsyncIterator=P,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new P(s(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},x(j),f(j,l,"Generator"),f(j,u,(function(){return this})),f(j,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},r.values=k,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(N),!t)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(n,o){return u.type="throw",u.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var c=o.call(a,"catchLoc"),l=o.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),N(r),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;N(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:k(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),d}},r},setPrototypeOf:o,toPrimitive:s,toPropertyKey:p,unsupportedIterableToArray:l,wrapNativeSuper:c})}}}));

} }; });
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3ZpcnR1YWw6L2NjL3ZpcnR1YWw6L2NjL2VudiIsIi4uL2NjZTovaW50ZXJuYWwvY2NlOi9pbnRlcm5hbC9yb2xsdXBQbHVnaW5Nb2RMb0JhYmVsSGVscGVycy5qcyJdLCJuYW1lcyI6WyJhc3luY0dlbmVyYXRvclN0ZXAiLCJnZW4iLCJyZXNvbHZlIiwicmVqZWN0IiwiX25leHQiLCJfdGhyb3ciLCJrZXkiLCJhcmciLCJpbmZvIiwidmFsdWUiLCJlcnJvciIsImRvbmUiLCJQcm9taXNlIiwidGhlbiIsIl9kZWZpbmVQcm9wZXJ0aWVzIiwidGFyZ2V0IiwicHJvcHMiLCJpIiwibGVuZ3RoIiwiZGVzY3JpcHRvciIsImVudW1lcmFibGUiLCJjb25maWd1cmFibGUiLCJ3cml0YWJsZSIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiX3RvUHJvcGVydHlLZXkiLCJfZ2V0UHJvdG90eXBlT2YiLCJvIiwic2V0UHJvdG90eXBlT2YiLCJnZXRQcm90b3R5cGVPZiIsImJpbmQiLCJfX3Byb3RvX18iLCJfc2V0UHJvdG90eXBlT2YiLCJwIiwiX2lzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCIsIlJlZmxlY3QiLCJjb25zdHJ1Y3QiLCJzaGFtIiwiUHJveHkiLCJCb29sZWFuIiwicHJvdG90eXBlIiwidmFsdWVPZiIsImNhbGwiLCJlIiwiX2NvbnN0cnVjdCIsIlBhcmVudCIsImFyZ3MiLCJDbGFzcyIsImEiLCJwdXNoIiwiYXBwbHkiLCJpbnN0YW5jZSIsIkZ1bmN0aW9uIiwiYXJndW1lbnRzIiwiX2lzTmF0aXZlRnVuY3Rpb24iLCJmbiIsInRvU3RyaW5nIiwiaW5kZXhPZiIsIl93cmFwTmF0aXZlU3VwZXIiLCJfY2FjaGUiLCJNYXAiLCJ1bmRlZmluZWQiLCJUeXBlRXJyb3IiLCJoYXMiLCJnZXQiLCJzZXQiLCJXcmFwcGVyIiwidGhpcyIsImNvbnN0cnVjdG9yIiwiY3JlYXRlIiwiX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5IiwibWluTGVuIiwiX2FycmF5TGlrZVRvQXJyYXkiLCJuIiwic2xpY2UiLCJuYW1lIiwiQXJyYXkiLCJmcm9tIiwidGVzdCIsImFyciIsImxlbiIsImFycjIiLCJfdG9QcmltaXRpdmUiLCJpbnB1dCIsImhpbnQiLCJwcmltIiwiU3ltYm9sIiwidG9QcmltaXRpdmUiLCJyZXMiLCJTdHJpbmciLCJOdW1iZXIiLCJwcm9wZXJ0eSIsImRlY29yYXRvcnMiLCJjb250ZXh0IiwiZGVzYyIsImtleXMiLCJmb3JFYWNoIiwiaW5pdGlhbGl6ZXIiLCJyZXZlcnNlIiwicmVkdWNlIiwiZGVjb3JhdG9yIiwic2VsZiIsIlJlZmVyZW5jZUVycm9yIiwiZXJyIiwiQ29uc3RydWN0b3IiLCJwcm90b1Byb3BzIiwic3RhdGljUHJvcHMiLCJhbGxvd0FycmF5TGlrZSIsIml0IiwiaXRlcmF0b3IiLCJuZXh0IiwiaXNBcnJheSIsInN1YkNsYXNzIiwic3VwZXJDbGFzcyIsInQiLCJyIiwiaGFzT3duUHJvcGVydHkiLCJjIiwiYXN5bmNJdGVyYXRvciIsInUiLCJ0b1N0cmluZ1RhZyIsImRlZmluZSIsIndyYXAiLCJHZW5lcmF0b3IiLCJDb250ZXh0IiwibWFrZUludm9rZU1ldGhvZCIsInRyeUNhdGNoIiwidHlwZSIsImgiLCJmIiwicyIsInkiLCJHZW5lcmF0b3JGdW5jdGlvbiIsIkdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlIiwiZCIsInYiLCJ2YWx1ZXMiLCJnIiwiZGVmaW5lSXRlcmF0b3JNZXRob2RzIiwiX2ludm9rZSIsIkFzeW5jSXRlcmF0b3IiLCJpbnZva2UiLCJfX2F3YWl0IiwiY2FsbEludm9rZVdpdGhNZXRob2RBbmRBcmciLCJFcnJvciIsIm1ldGhvZCIsImRlbGVnYXRlIiwibWF5YmVJbnZva2VEZWxlZ2F0ZSIsInNlbnQiLCJfc2VudCIsImRpc3BhdGNoRXhjZXB0aW9uIiwiYWJydXB0IiwicmV0dXJuIiwicmVzdWx0TmFtZSIsIm5leHRMb2MiLCJwdXNoVHJ5RW50cnkiLCJ0cnlMb2MiLCJjYXRjaExvYyIsImZpbmFsbHlMb2MiLCJhZnRlckxvYyIsInRyeUVudHJpZXMiLCJyZXNldFRyeUVudHJ5IiwiY29tcGxldGlvbiIsInJlc2V0IiwiaXNOYU4iLCJkaXNwbGF5TmFtZSIsImlzR2VuZXJhdG9yRnVuY3Rpb24iLCJtYXJrIiwiYXdyYXAiLCJhc3luYyIsInBvcCIsInByZXYiLCJjaGFyQXQiLCJzdG9wIiwicnZhbCIsImhhbmRsZSIsImNvbXBsZXRlIiwiZmluaXNoIiwiY2F0Y2giLCJkZWxlZ2F0ZVlpZWxkIl0sIm1hcHBpbmdzIjoiOzhGQUFxQixlQUNDLGdCQUNDLFlBQ0osWUFDQSxnQkFDSSxjQUNGLGFBQ0QscUJBQ1EsZUFDTiw0QkFDYSxjQUNkLGVBQ0MsZUFDQSxlQUNBLHdCQUNTLGtCQUNOLGFBQ0wsYUFDQSxlQUNFLGtCQUNHLFlBQ04saUJBQ0ssYUFDSixlQUNFLDhCQUNlLGdCQUNkLGNBQ0YsYUFDRCxjQUNDLFlBQ0YsaUJBQ0ssc0JBQ0ssb0JBQ0YsWUFDUixnQkFDSzs7Z0hDcW1EeEIsU0FBU0EsRUFBbUJDLEVBQUtDLEVBQVNDLEVBQVFDLEVBQU9DLEVBQVFDLEVBQUtDLEdBQ3BFLElBQ0UsSUFBSUMsRUFBT1AsRUFBSUssR0FBS0MsR0FDaEJFLEVBQVFELEVBQUtDLE1BQ2pCLE1BQU9DLEdBRVAsWUFEQVAsRUFBT08sR0FHTEYsRUFBS0csS0FDUFQsRUFBUU8sR0FFUkcsUUFBUVYsUUFBUU8sR0FBT0ksS0FBS1QsRUFBT0MsR0F3QnZDLFNBQVNTLEVBQWtCQyxFQUFRQyxHQUNqQyxJQUFLLElBQUlDLEVBQUksRUFBR0EsRUFBSUQsRUFBTUUsT0FBUUQsSUFBSyxDQUNyQyxJQUFJRSxFQUFhSCxFQUFNQyxHQUN2QkUsRUFBV0MsV0FBYUQsRUFBV0MsYUFBYyxFQUNqREQsRUFBV0UsY0FBZSxFQUN0QixVQUFXRixJQUFZQSxFQUFXRyxVQUFXLEdBQ2pEQyxPQUFPQyxlQUFlVCxFQUFRVSxFQUFlTixFQUFXYixLQUFNYSxJQXlHbEUsU0FBU08sRUFBZ0JDLEdBSXZCLE9BSEFELHFCQUFrQkgsT0FBT0ss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QUNoQixJQUFLLElBQUl2RSxFQUFJd0IsS0FBSzZGLFdBQVc5SSxPQUFTLEVBQUd5QixHQUFLLElBQUtBLEVBQUcsQ0FDcEQsSUFBSXdFLEVBQUloRCxLQUFLNkYsV0FBV3JILEdBQ3hCLEdBQUl3RSxFQUFFMkMsYUFBZTVDLEVBQUcsT0FBTy9DLEtBQUs2RyxTQUFTN0QsRUFBRStDLFdBQVkvQyxFQUFFNEMsVUFBV0UsRUFBYzlDLEdBQUlnQixJQUc5RitDLE1BQU8sU0FBVWhFLEdBQ2YsSUFBSyxJQUFJdkUsRUFBSXdCLEtBQUs2RixXQUFXOUksT0FBUyxFQUFHeUIsR0FBSyxJQUFLQSxFQUFHLENBQ3BELElBQUl3RSxFQUFJaEQsS0FBSzZGLFdBQVdySCxHQUN4QixHQUFJd0UsRUFBRXlDLFNBQVcxQyxFQUFHLENBQ2xCLElBQUl6QyxFQUFJMEMsRUFBRStDLFdBQ1YsR0FBSSxVQUFZekYsRUFBRXNELEtBQU0sQ0FDdEIsSUFBSXBHLEVBQUk4QyxFQUFFbEUsSUFDVjBKLEVBQWM5QyxHQUVoQixPQUFPeEYsR0FHWCxNQUFNLElBQUlxSCxNQUFNLDBCQUVsQm1DLGNBQWUsU0FBVXhJLEVBQUd3RSxFQUFHMUMsR0FDN0IsT0FBT04sS0FBSytFLFNBQVcsQ0FDckJyQyxTQUFVMkIsRUFBTzdGLEdBQ2pCOEcsV0FBWXRDLEVBQ1p1QyxRQUFTakYsR0FDUixTQUFXTixLQUFLOEUsU0FBVzlFLEtBQUs1RCxJQUFNMkcsR0FBSWlCLElBRTlDeEYiLCJmaWxlIjoiYWxsLmpzIiwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNvbnN0IEhUTUw1ID0gdHJ1ZTtcbmV4cG9ydCBjb25zdCBOQVRJVkUgPSBmYWxzZTtcbmV4cG9ydCBjb25zdCBBTkRST0lEID0gZmFsc2U7XG5leHBvcnQgY29uc3QgSU9TID0gZmFsc2U7XG5leHBvcnQgY29uc3QgTUFDID0gZmFsc2U7XG5leHBvcnQgY29uc3QgV0lORE9XUyA9IGZhbHNlO1xuZXhwb3J0IGNvbnN0IExJTlVYID0gZmFsc2U7XG5leHBvcnQgY29uc3QgT0hPUyA9IGZhbHNlO1xuZXhwb3J0IGNvbnN0IE9QRU5fSEFSTU9OWSA9IGZhbHNlO1xuZXhwb3J0IGNvbnN0IFdFQ0hBVCA9IGZhbHNlO1xuZXhwb3J0IGNvbnN0IFdFQ0hBVF9NSU5JX1BST0dSQU0gPSBmYWxzZTtcbmV4cG9ydCBjb25zdCBCQUlEVSA9IGZhbHNlO1xuZXhwb3J0IGNvbnN0IFhJQU9NSSA9IGZhbHNlO1xuZXhwb3J0IGNvbnN0IEFMSVBBWSA9IGZhbHNlO1xuZXhwb3J0IGNvbnN0IFRBT0JBTyA9IGZhbHNlO1xuZXhwb3J0IGNvbnN0IFRBT0JBT19NSU5JR0FNRSA9IGZhbHNlO1xuZXhwb3J0IGNvbnN0IEJZVEVEQU5DRSA9IGZhbHNlO1xuZXhwb3J0IGNvbnN0IE9QUE8gPSBmYWxzZTtcbmV4cG9ydCBjb25zdCBWSVZPID0gZmFsc2U7XG5leHBvcnQgY29uc3QgSFVBV0VJID0gZmFsc2U7XG5leHBvcnQgY29uc3QgQ09DT1NQTEFZID0gZmFsc2U7XG5leHBvcnQgY29uc3QgUVRUID0gZmFsc2U7XG5leHBvcnQgY29uc3QgTElOS1NVUkUgPSBmYWxzZTtcbmV4cG9ydCBjb25zdCBNSUdVID0gZmFsc2U7XG5leHBvcnQgY29uc3QgRURJVE9SID0gZmFsc2U7XG5leHBvcnQgY29uc3QgRURJVE9SX05PVF9JTl9QUkVWSUVXID0gZmFsc2U7XG5leHBvcnQgY29uc3QgUFJFVklFVyA9IGZhbHNlO1xuZXhwb3J0IGNvbnN0IEJVSUxEID0gdHJ1ZTtcbmV4cG9ydCBjb25zdCBURVNUID0gZmFsc2U7XG5leHBvcnQgY29uc3QgREVCVUcgPSBmYWxzZTtcbmV4cG9ydCBjb25zdCBERVYgPSBmYWxzZTtcbmV4cG9ydCBjb25zdCBNSU5JR0FNRSA9IGZhbHNlO1xuZXhwb3J0IGNvbnN0IFJVTlRJTUVfQkFTRUQgPSBmYWxzZTtcbmV4cG9ydCBjb25zdCBTVVBQT1JUX0pJVCA9IHRydWU7XG5leHBvcnQgY29uc3QgSlNCID0gZmFsc2U7XG5leHBvcnQgY29uc3QgTkVUX01PREUgPSAwOyIsImV4cG9ydCB7IF9Bc3luY0dlbmVyYXRvciBhcyBBc3luY0dlbmVyYXRvciwgX092ZXJsb2FkWWllbGQgYXMgT3ZlcmxvYWRZaWVsZCwgX2FwcGx5RGVjcyBhcyBhcHBseURlY3MsIF9hcHBseURlY3MyMjAzIGFzIGFwcGx5RGVjczIyMDMsIF9hcHBseURlY3MyMjAzUiBhcyBhcHBseURlY3MyMjAzUiwgX2FwcGx5RGVjczIzMDEgYXMgYXBwbHlEZWNzMjMwMSwgX2FwcGx5RGVjczIzMDUgYXMgYXBwbHlEZWNzMjMwNSwgX2FzeW5jR2VuZXJhdG9yRGVsZWdhdGUgYXMgYXN5bmNHZW5lcmF0b3JEZWxlZ2F0ZSwgX2FzeW5jSXRlcmF0b3IgYXMgYXN5bmNJdGVyYXRvciwgX2F3YWl0QXN5bmNHZW5lcmF0b3IgYXMgYXdhaXRBc3luY0dlbmVyYXRvciwgX2NoZWNrSW5SSFMgYXMgY2hlY2tJblJIUywgX2RlZmluZUFjY2Vzc29yIGFzIGRlZmluZUFjY2Vzc29yLCBfZGlzcG9zZSBhcyBkaXNwb3NlLCBfaXRlcmFibGVUb0FycmF5TGltaXQgYXMgaXRlcmFibGVUb0FycmF5TGltaXQsIF9pdGVyYWJsZVRvQXJyYXlMaW1pdExvb3NlIGFzIGl0ZXJhYmxlVG9BcnJheUxpbWl0TG9vc2UsIF9qc3ggYXMganN4LCBfb2JqZWN0U3ByZWFkMiBhcyBvYmplY3RTcHJlYWQyLCBfcmVnZW5lcmF0b3JSdW50aW1lIGFzIHJlZ2VuZXJhdG9yUnVudGltZSwgX3R5cGVvZiBhcyB0eXBlb2YsIF91c2luZyBhcyB1c2luZywgX3dyYXBSZWdFeHAgYXMgd3JhcFJlZ0V4cCwgX0F3YWl0VmFsdWUgYXMgQXdhaXRWYWx1ZSwgX3dyYXBBc3luY0dlbmVyYXRvciBhcyB3cmFwQXN5bmNHZW5lcmF0b3IsIF9hc3luY1RvR2VuZXJhdG9yIGFzIGFzeW5jVG9HZW5lcmF0b3IsIF9jbGFzc0NhbGxDaGVjayBhcyBjbGFzc0NhbGxDaGVjaywgX2NyZWF0ZUNsYXNzIGFzIGNyZWF0ZUNsYXNzLCBfZGVmaW5lRW51bWVyYWJsZVByb3BlcnRpZXMgYXMgZGVmaW5lRW51bWVyYWJsZVByb3BlcnRpZXMsIF9kZWZhdWx0cyBhcyBkZWZhdWx0cywgX2RlZmluZVByb3BlcnR5IGFzIGRlZmluZVByb3BlcnR5LCBfZXh0ZW5kcyBhcyBleHRlbmRzLCBfb2JqZWN0U3ByZWFkIGFzIG9iamVjdFNwcmVhZCwgX2luaGVyaXRzIGFzIGluaGVyaXRzLCBfaW5oZXJpdHNMb29zZSBhcyBpbmhlcml0c0xvb3NlLCBfZ2V0UHJvdG90eXBlT2YgYXMgZ2V0UHJvdG90eXBlT2YsIF9zZXRQcm90b3R5cGVPZiBhcyBzZXRQcm90b3R5cGVPZiwgX2lzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCBhcyBpc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QsIF9jb25zdHJ1Y3QgYXMgY29uc3RydWN0LCBfaXNOYXRpdmVGdW5jdGlvbiBhcyBpc05hdGl2ZUZ1bmN0aW9uLCBfd3JhcE5hdGl2ZVN1cGVyIGFzIHdyYXBOYXRpdmVTdXBlciwgX2luc3RhbmNlb2YgYXMgaW5zdGFuY2VvZiwgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCBhcyBpbnRlcm9wUmVxdWlyZURlZmF1bHQsIF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkIGFzIGludGVyb3BSZXF1aXJlV2lsZGNhcmQsIF9uZXdBcnJvd0NoZWNrIGFzIG5ld0Fycm93Q2hlY2ssIF9vYmplY3REZXN0cnVjdHVyaW5nRW1wdHkgYXMgb2JqZWN0RGVzdHJ1Y3R1cmluZ0VtcHR5LCBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXNMb29zZSBhcyBvYmplY3RXaXRob3V0UHJvcGVydGllc0xvb3NlLCBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXMgYXMgb2JqZWN0V2l0aG91dFByb3BlcnRpZXMsIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQgYXMgYXNzZXJ0VGhpc0luaXRpYWxpemVkLCBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybiBhcyBwb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuLCBfY3JlYXRlU3VwZXIgYXMgY3JlYXRlU3VwZXIsIF9zdXBlclByb3BCYXNlIGFzIHN1cGVyUHJvcEJhc2UsIF9nZXQgYXMgZ2V0LCBfc2V0IGFzIHNldCwgX3RhZ2dlZFRlbXBsYXRlTGl0ZXJhbCBhcyB0YWdnZWRUZW1wbGF0ZUxpdGVyYWwsIF90YWdnZWRUZW1wbGF0ZUxpdGVyYWxMb29zZSBhcyB0YWdnZWRUZW1wbGF0ZUxpdGVyYWxMb29zZSwgX3JlYWRPbmx5RXJyb3IgYXMgcmVhZE9ubHlFcnJvciwgX3dyaXRlT25seUVycm9yIGFzIHdyaXRlT25seUVycm9yLCBfY2xhc3NOYW1lVERaRXJyb3IgYXMgY2xhc3NOYW1lVERaRXJyb3IsIF90ZW1wb3JhbFVuZGVmaW5lZCBhcyB0ZW1wb3JhbFVuZGVmaW5lZCwgX3RkeiBhcyB0ZHosIF90ZW1wb3JhbFJlZiBhcyB0ZW1wb3JhbFJlZiwgX3NsaWNlZFRvQXJyYXkgYXMgc2xpY2VkVG9BcnJheSwgX3NsaWNlZFRvQXJyYXlMb29zZSBhcyBzbGljZWRUb0FycmF5TG9vc2UsIF90b0FycmF5IGFzIHRvQXJyYXksIF90b0NvbnN1bWFibGVBcnJheSBhcyB0b0NvbnN1bWFibGVBcnJheSwgX2FycmF5V2l0aG91dEhvbGVzIGFzIGFycmF5V2l0aG91dEhvbGVzLCBfYXJyYXlXaXRoSG9sZXMgYXMgYXJyYXlXaXRoSG9sZXMsIF9tYXliZUFycmF5TGlrZSBhcyBtYXliZUFycmF5TGlrZSwgX2l0ZXJhYmxlVG9BcnJheSBhcyBpdGVyYWJsZVRvQXJyYXksIF91bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheSBhcyB1bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheSwgX2FycmF5TGlrZVRvQXJyYXkgYXMgYXJyYXlMaWtlVG9BcnJheSwgX25vbkl0ZXJhYmxlU3ByZWFkIGFzIG5vbkl0ZXJhYmxlU3ByZWFkLCBfbm9uSXRlcmFibGVSZXN0IGFzIG5vbkl0ZXJhYmxlUmVzdCwgX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIgYXMgY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlciwgX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXJMb29zZSBhcyBjcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyTG9vc2UsIF9za2lwRmlyc3RHZW5lcmF0b3JOZXh0IGFzIHNraXBGaXJzdEdlbmVyYXRvck5leHQsIF90b1ByaW1pdGl2ZSBhcyB0b1ByaW1pdGl2ZSwgX3RvUHJvcGVydHlLZXkgYXMgdG9Qcm9wZXJ0eUtleSwgX2luaXRpYWxpemVyV2FybmluZ0hlbHBlciBhcyBpbml0aWFsaXplcldhcm5pbmdIZWxwZXIsIF9pbml0aWFsaXplckRlZmluZVByb3BlcnR5IGFzIGluaXRpYWxpemVyRGVmaW5lUHJvcGVydHksIF9hcHBseURlY29yYXRlZERlc2NyaXB0b3IgYXMgYXBwbHlEZWNvcmF0ZWREZXNjcmlwdG9yLCBfY2xhc3NQcml2YXRlRmllbGRMb29zZUtleSBhcyBjbGFzc1ByaXZhdGVGaWVsZExvb3NlS2V5LCBfY2xhc3NQcml2YXRlRmllbGRMb29zZUJhc2UgYXMgY2xhc3NQcml2YXRlRmllbGRMb29zZUJhc2UsIF9jbGFzc1ByaXZhdGVGaWVsZEdldCBhcyBjbGFzc1ByaXZhdGVGaWVsZEdldCwgX2NsYXNzUHJpdmF0ZUZpZWxkU2V0IGFzIGNsYXNzUHJpdmF0ZUZpZWxkU2V0LCBfY2xhc3NQcml2YXRlRmllbGREZXN0cnVjdHVyZVNldCBhcyBjbGFzc1ByaXZhdGVGaWVsZERlc3RydWN0dXJlU2V0LCBfY2xhc3NFeHRyYWN0RmllbGREZXNjcmlwdG9yIGFzIGNsYXNzRXh0cmFjdEZpZWxkRGVzY3JpcHRvciwgX2NsYXNzU3RhdGljUHJpdmF0ZUZpZWxkU3BlY0dldCBhcyBjbGFzc1N0YXRpY1ByaXZhdGVGaWVsZFNwZWNHZXQsIF9jbGFzc1N0YXRpY1ByaXZhdGVGaWVsZFNwZWNTZXQgYXMgY2xhc3NTdGF0aWNQcml2YXRlRmllbGRTcGVjU2V0LCBfY2xhc3NTdGF0aWNQcml2YXRlTWV0aG9kR2V0IGFzIGNsYXNzU3RhdGljUHJpdmF0ZU1ldGhvZEdldCwgX2NsYXNzU3RhdGljUHJpdmF0ZU1ldGhvZFNldCBhcyBjbGFzc1N0YXRpY1ByaXZhdGVNZXRob2RTZXQsIF9jbGFzc0FwcGx5RGVzY3JpcHRvckdldCBhcyBjbGFzc0FwcGx5RGVzY3JpcHRvckdldCwgX2NsYXNzQXBwbHlEZXNjcmlwdG9yU2V0IGFzIGNsYXNzQXBwbHlEZXNjcmlwdG9yU2V0LCBfY2xhc3NBcHBseURlc2NyaXB0b3JEZXN0cnVjdHVyZVNldCBhcyBjbGFzc0FwcGx5RGVzY3JpcHRvckRlc3RydWN0dXJlU2V0LCBfY2xhc3NTdGF0aWNQcml2YXRlRmllbGREZXN0cnVjdHVyZVNldCBhcyBjbGFzc1N0YXRpY1ByaXZhdGVGaWVsZERlc3RydWN0dXJlU2V0LCBfY2xhc3NDaGVja1ByaXZhdGVTdGF0aWNBY2Nlc3MgYXMgY2xhc3NDaGVja1ByaXZhdGVTdGF0aWNBY2Nlc3MsIF9jbGFzc0NoZWNrUHJpdmF0ZVN0YXRpY0ZpZWxkRGVzY3JpcHRvciBhcyBjbGFzc0NoZWNrUHJpdmF0ZVN0YXRpY0ZpZWxkRGVzY3JpcHRvciwgX2RlY29yYXRlIGFzIGRlY29yYXRlLCBfY2xhc3NQcml2YXRlTWV0aG9kR2V0IGFzIGNsYXNzUHJpdmF0ZU1ldGhvZEdldCwgX2NoZWNrUHJpdmF0ZVJlZGVjbGFyYXRpb24gYXMgY2hlY2tQcml2YXRlUmVkZWNsYXJhdGlvbiwgX2NsYXNzUHJpdmF0ZUZpZWxkSW5pdFNwZWMgYXMgY2xhc3NQcml2YXRlRmllbGRJbml0U3BlYywgX2NsYXNzUHJpdmF0ZU1ldGhvZEluaXRTcGVjIGFzIGNsYXNzUHJpdmF0ZU1ldGhvZEluaXRTcGVjLCBfY2xhc3NQcml2YXRlTWV0aG9kU2V0IGFzIGNsYXNzUHJpdmF0ZU1ldGhvZFNldCwgX2lkZW50aXR5IGFzIGlkZW50aXR5IH07XG5mdW5jdGlvbiBfQXN5bmNHZW5lcmF0b3IoZSkge1xuICB2YXIgciwgdDtcbiAgZnVuY3Rpb24gcmVzdW1lKHIsIHQpIHtcbiAgICB0cnkge1xuICAgICAgdmFyIG4gPSBlW3JdKHQpLFxuICAgICAgICBvID0gbi52YWx1ZSxcbiAgICAgICAgdSA9IG8gaW5zdGFuY2VvZiBfT3ZlcmxvYWRZaWVsZDtcbiAgICAgIFByb21pc2UucmVzb2x2ZSh1ID8gby52IDogbykudGhlbihmdW5jdGlvbiAodCkge1xuICAgICAgICBpZiAodSkge1xuICAgICAgICAgIHZhciBpID0gXCJyZXR1cm5cIiA9PT0gciA/IFwicmV0dXJuXCIgOiBcIm5leHRcIjtcbiAgICAgICAgICBpZiAoIW8uayB8fCB0LmRvbmUpIHJldHVybiByZXN1bWUoaSwgdCk7XG4gICAgICAgICAgdCA9IGVbaV0odCkudmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgc2V0dGxlKG4uZG9uZSA/IFwicmV0dXJuXCIgOiBcIm5vcm1hbFwiLCB0KTtcbiAgICAgIH0sIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIHJlc3VtZShcInRocm93XCIsIGUpO1xuICAgICAgfSk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgc2V0dGxlKFwidGhyb3dcIiwgZSk7XG4gICAgfVxuICB9XG4gIGZ1bmN0aW9uIHNldHRsZShlLCBuKSB7XG4gICAgc3dpdGNoIChlKSB7XG4gICAgICBjYXNlIFwicmV0dXJuXCI6XG4gICAgICAgIHIucmVzb2x2ZSh7XG4gICAgICAgICAgdmFsdWU6IG4sXG4gICAgICAgICAgZG9uZTogITBcbiAgICAgICAgfSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBcInRocm93XCI6XG4gICAgICAgIHIucmVqZWN0KG4pO1xuICAgICAgICBicmVhaztcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHIucmVzb2x2ZSh7XG4gICAgICAgICAgdmFsdWU6IG4sXG4gICAgICAgICAgZG9uZTogITFcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIChyID0gci5uZXh0KSA/IHJlc3VtZShyLmtleSwgci5hcmcpIDogdCA9IG51bGw7XG4gIH1cbiAgdGhpcy5faW52b2tlID0gZnVuY3Rpb24gKGUsIG4pIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKG8sIHUpIHtcbiAgICAgIHZhciBpID0ge1xuICAgICAgICBrZXk6IGUsXG4gICAgICAgIGFyZzogbixcbiAgICAgICAgcmVzb2x2ZTogbyxcbiAgICAgICAgcmVqZWN0OiB1LFxuICAgICAgICBuZXh0OiBudWxsXG4gICAgICB9O1xuICAgICAgdCA/IHQgPSB0Lm5leHQgPSBpIDogKHIgPSB0ID0gaSwgcmVzdW1lKGUsIG4pKTtcbiAgICB9KTtcbiAgfSwgXCJmdW5jdGlvblwiICE9IHR5cGVvZiBlLnJldHVybiAmJiAodGhpcy5yZXR1cm4gPSB2b2lkIDApO1xufVxuX0FzeW5jR2VuZXJhdG9yLnByb3RvdHlwZVtcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIFN5bWJvbCAmJiBTeW1ib2wuYXN5bmNJdGVyYXRvciB8fCBcIkBAYXN5bmNJdGVyYXRvclwiXSA9IGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIHRoaXM7XG59LCBfQXN5bmNHZW5lcmF0b3IucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoZSkge1xuICByZXR1cm4gdGhpcy5faW52b2tlKFwibmV4dFwiLCBlKTtcbn0sIF9Bc3luY0dlbmVyYXRvci5wcm90b3R5cGUudGhyb3cgPSBmdW5jdGlvbiAoZSkge1xuICByZXR1cm4gdGhpcy5faW52b2tlKFwidGhyb3dcIiwgZSk7XG59LCBfQXN5bmNHZW5lcmF0b3IucHJvdG90eXBlLnJldHVybiA9IGZ1bmN0aW9uIChlKSB7XG4gIHJldHVybiB0aGlzLl9pbnZva2UoXCJyZXR1cm5cIiwgZSk7XG59O1xuZnVuY3Rpb24gX092ZXJsb2FkWWllbGQodCwgZSkge1xuICB0aGlzLnYgPSB0LCB0aGlzLmsgPSBlO1xufVxuZnVuY3Rpb24gb2xkX2NyZWF0ZU1ldGFkYXRhTWV0aG9kc0ZvclByb3BlcnR5KGUsIHQsIGEsIHIpIHtcbiAgcmV0dXJuIHtcbiAgICBnZXRNZXRhZGF0YTogZnVuY3Rpb24gKG8pIHtcbiAgICAgIG9sZF9hc3NlcnROb3RGaW5pc2hlZChyLCBcImdldE1ldGFkYXRhXCIpLCBvbGRfYXNzZXJ0TWV0YWRhdGFLZXkobyk7XG4gICAgICB2YXIgaSA9IGVbb107XG4gICAgICBpZiAodm9pZCAwICE9PSBpKSBpZiAoMSA9PT0gdCkge1xuICAgICAgICB2YXIgbiA9IGkucHVibGljO1xuICAgICAgICBpZiAodm9pZCAwICE9PSBuKSByZXR1cm4gblthXTtcbiAgICAgIH0gZWxzZSBpZiAoMiA9PT0gdCkge1xuICAgICAgICB2YXIgbCA9IGkucHJpdmF0ZTtcbiAgICAgICAgaWYgKHZvaWQgMCAhPT0gbCkgcmV0dXJuIGwuZ2V0KGEpO1xuICAgICAgfSBlbHNlIGlmIChPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbChpLCBcImNvbnN0cnVjdG9yXCIpKSByZXR1cm4gaS5jb25zdHJ1Y3RvcjtcbiAgICB9LFxuICAgIHNldE1ldGFkYXRhOiBmdW5jdGlvbiAobywgaSkge1xuICAgICAgb2xkX2Fzc2VydE5vdEZpbmlzaGVkKHIsIFwic2V0TWV0YWRhdGFcIiksIG9sZF9hc3NlcnRNZXRhZGF0YUtleShvKTtcbiAgICAgIHZhciBuID0gZVtvXTtcbiAgICAgIGlmICh2b2lkIDAgPT09IG4gJiYgKG4gPSBlW29dID0ge30pLCAxID09PSB0KSB7XG4gICAgICAgIHZhciBsID0gbi5wdWJsaWM7XG4gICAgICAgIHZvaWQgMCA9PT0gbCAmJiAobCA9IG4ucHVibGljID0ge30pLCBsW2FdID0gaTtcbiAgICAgIH0gZWxzZSBpZiAoMiA9PT0gdCkge1xuICAgICAgICB2YXIgcyA9IG4ucHJpdjtcbiAgICAgICAgdm9pZCAwID09PSBzICYmIChzID0gbi5wcml2YXRlID0gbmV3IE1hcCgpKSwgcy5zZXQoYSwgaSk7XG4gICAgICB9IGVsc2Ugbi5jb25zdHJ1Y3RvciA9IGk7XG4gICAgfVxuICB9O1xufVxuZnVuY3Rpb24gb2xkX2NvbnZlcnRNZXRhZGF0YU1hcFRvRmluYWwoZSwgdCkge1xuICB2YXIgYSA9IGVbU3ltYm9sLm1ldGFkYXRhIHx8IFN5bWJvbC5mb3IoXCJTeW1ib2wubWV0YWRhdGFcIildLFxuICAgIHIgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKHQpO1xuICBpZiAoMCAhPT0gci5sZW5ndGgpIHtcbiAgICBmb3IgKHZhciBvID0gMDsgbyA8IHIubGVuZ3RoOyBvKyspIHtcbiAgICAgIHZhciBpID0gcltvXSxcbiAgICAgICAgbiA9IHRbaV0sXG4gICAgICAgIGwgPSBhID8gYVtpXSA6IG51bGwsXG4gICAgICAgIHMgPSBuLnB1YmxpYyxcbiAgICAgICAgYyA9IGwgPyBsLnB1YmxpYyA6IG51bGw7XG4gICAgICBzICYmIGMgJiYgT2JqZWN0LnNldFByb3RvdHlwZU9mKHMsIGMpO1xuICAgICAgdmFyIGQgPSBuLnByaXZhdGU7XG4gICAgICBpZiAoZCkge1xuICAgICAgICB2YXIgdSA9IEFycmF5LmZyb20oZC52YWx1ZXMoKSksXG4gICAgICAgICAgZiA9IGwgPyBsLnByaXZhdGUgOiBudWxsO1xuICAgICAgICBmICYmICh1ID0gdS5jb25jYXQoZikpLCBuLnByaXZhdGUgPSB1O1xuICAgICAgfVxuICAgICAgbCAmJiBPYmplY3Quc2V0UHJvdG90eXBlT2YobiwgbCk7XG4gICAgfVxuICAgIGEgJiYgT2JqZWN0LnNldFByb3RvdHlwZU9mKHQsIGEpLCBlW1N5bWJvbC5tZXRhZGF0YSB8fCBTeW1ib2wuZm9yKFwiU3ltYm9sLm1ldGFkYXRhXCIpXSA9IHQ7XG4gIH1cbn1cbmZ1bmN0aW9uIG9sZF9jcmVhdGVBZGRJbml0aWFsaXplck1ldGhvZChlLCB0KSB7XG4gIHJldHVybiBmdW5jdGlvbiAoYSkge1xuICAgIG9sZF9hc3NlcnROb3RGaW5pc2hlZCh0LCBcImFkZEluaXRpYWxpemVyXCIpLCBvbGRfYXNzZXJ0Q2FsbGFibGUoYSwgXCJBbiBpbml0aWFsaXplclwiKSwgZS5wdXNoKGEpO1xuICB9O1xufVxuZnVuY3Rpb24gb2xkX21lbWJlckRlYyhlLCB0LCBhLCByLCBvLCBpLCBuLCBsLCBzKSB7XG4gIHZhciBjO1xuICBzd2l0Y2ggKGkpIHtcbiAgICBjYXNlIDE6XG4gICAgICBjID0gXCJhY2Nlc3NvclwiO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSAyOlxuICAgICAgYyA9IFwibWV0aG9kXCI7XG4gICAgICBicmVhaztcbiAgICBjYXNlIDM6XG4gICAgICBjID0gXCJnZXR0ZXJcIjtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgNDpcbiAgICAgIGMgPSBcInNldHRlclwiO1xuICAgICAgYnJlYWs7XG4gICAgZGVmYXVsdDpcbiAgICAgIGMgPSBcImZpZWxkXCI7XG4gIH1cbiAgdmFyIGQsXG4gICAgdSxcbiAgICBmID0ge1xuICAgICAga2luZDogYyxcbiAgICAgIG5hbWU6IGwgPyBcIiNcIiArIHQgOiB0LFxuICAgICAgaXNTdGF0aWM6IG4sXG4gICAgICBpc1ByaXZhdGU6IGxcbiAgICB9LFxuICAgIHAgPSB7XG4gICAgICB2OiAhMVxuICAgIH07XG4gIGlmICgwICE9PSBpICYmIChmLmFkZEluaXRpYWxpemVyID0gb2xkX2NyZWF0ZUFkZEluaXRpYWxpemVyTWV0aG9kKG8sIHApKSwgbCkge1xuICAgIGQgPSAyLCB1ID0gU3ltYm9sKHQpO1xuICAgIHZhciB2ID0ge307XG4gICAgMCA9PT0gaSA/ICh2LmdldCA9IGEuZ2V0LCB2LnNldCA9IGEuc2V0KSA6IDIgPT09IGkgPyB2LmdldCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBhLnZhbHVlO1xuICAgIH0gOiAoMSAhPT0gaSAmJiAzICE9PSBpIHx8ICh2LmdldCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBhLmdldC5jYWxsKHRoaXMpO1xuICAgIH0pLCAxICE9PSBpICYmIDQgIT09IGkgfHwgKHYuc2V0ID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgIGEuc2V0LmNhbGwodGhpcywgZSk7XG4gICAgfSkpLCBmLmFjY2VzcyA9IHY7XG4gIH0gZWxzZSBkID0gMSwgdSA9IHQ7XG4gIHRyeSB7XG4gICAgcmV0dXJuIGUocywgT2JqZWN0LmFzc2lnbihmLCBvbGRfY3JlYXRlTWV0YWRhdGFNZXRob2RzRm9yUHJvcGVydHkociwgZCwgdSwgcCkpKTtcbiAgfSBmaW5hbGx5IHtcbiAgICBwLnYgPSAhMDtcbiAgfVxufVxuZnVuY3Rpb24gb2xkX2Fzc2VydE5vdEZpbmlzaGVkKGUsIHQpIHtcbiAgaWYgKGUudikgdGhyb3cgbmV3IEVycm9yKFwiYXR0ZW1wdGVkIHRvIGNhbGwgXCIgKyB0ICsgXCIgYWZ0ZXIgZGVjb3JhdGlvbiB3YXMgZmluaXNoZWRcIik7XG59XG5mdW5jdGlvbiBvbGRfYXNzZXJ0TWV0YWRhdGFLZXkoZSkge1xuICBpZiAoXCJzeW1ib2xcIiAhPSB0eXBlb2YgZSkgdGhyb3cgbmV3IFR5cGVFcnJvcihcIk1ldGFkYXRhIGtleXMgbXVzdCBiZSBzeW1ib2xzLCByZWNlaXZlZDogXCIgKyBlKTtcbn1cbmZ1bmN0aW9uIG9sZF9hc3NlcnRDYWxsYWJsZShlLCB0KSB7XG4gIGlmIChcImZ1bmN0aW9uXCIgIT0gdHlwZW9mIGUpIHRocm93IG5ldyBUeXBlRXJyb3IodCArIFwiIG11c3QgYmUgYSBmdW5jdGlvblwiKTtcbn1cbmZ1bmN0aW9uIG9sZF9hc3NlcnRWYWxpZFJldHVyblZhbHVlKGUsIHQpIHtcbiAgdmFyIGEgPSB0eXBlb2YgdDtcbiAgaWYgKDEgPT09IGUpIHtcbiAgICBpZiAoXCJvYmplY3RcIiAhPT0gYSB8fCBudWxsID09PSB0KSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiYWNjZXNzb3IgZGVjb3JhdG9ycyBtdXN0IHJldHVybiBhbiBvYmplY3Qgd2l0aCBnZXQsIHNldCwgb3IgaW5pdCBwcm9wZXJ0aWVzIG9yIHZvaWQgMFwiKTtcbiAgICB2b2lkIDAgIT09IHQuZ2V0ICYmIG9sZF9hc3NlcnRDYWxsYWJsZSh0LmdldCwgXCJhY2Nlc3Nvci5nZXRcIiksIHZvaWQgMCAhPT0gdC5zZXQgJiYgb2xkX2Fzc2VydENhbGxhYmxlKHQuc2V0LCBcImFjY2Vzc29yLnNldFwiKSwgdm9pZCAwICE9PSB0LmluaXQgJiYgb2xkX2Fzc2VydENhbGxhYmxlKHQuaW5pdCwgXCJhY2Nlc3Nvci5pbml0XCIpLCB2b2lkIDAgIT09IHQuaW5pdGlhbGl6ZXIgJiYgb2xkX2Fzc2VydENhbGxhYmxlKHQuaW5pdGlhbGl6ZXIsIFwiYWNjZXNzb3IuaW5pdGlhbGl6ZXJcIik7XG4gIH0gZWxzZSBpZiAoXCJmdW5jdGlvblwiICE9PSBhKSB7XG4gICAgdmFyIHI7XG4gICAgdGhyb3cgciA9IDAgPT09IGUgPyBcImZpZWxkXCIgOiAxMCA9PT0gZSA/IFwiY2xhc3NcIiA6IFwibWV0aG9kXCIsIG5ldyBUeXBlRXJyb3IociArIFwiIGRlY29yYXRvcnMgbXVzdCByZXR1cm4gYSBmdW5jdGlvbiBvciB2b2lkIDBcIik7XG4gIH1cbn1cbmZ1bmN0aW9uIG9sZF9nZXRJbml0KGUpIHtcbiAgdmFyIHQ7XG4gIHJldHVybiBudWxsID09ICh0ID0gZS5pbml0KSAmJiAodCA9IGUuaW5pdGlhbGl6ZXIpICYmIFwidW5kZWZpbmVkXCIgIT0gdHlwZW9mIGNvbnNvbGUgJiYgY29uc29sZS53YXJuKFwiLmluaXRpYWxpemVyIGhhcyBiZWVuIHJlbmFtZWQgdG8gLmluaXQgYXMgb2YgTWFyY2ggMjAyMlwiKSwgdDtcbn1cbmZ1bmN0aW9uIG9sZF9hcHBseU1lbWJlckRlYyhlLCB0LCBhLCByLCBvLCBpLCBuLCBsLCBzKSB7XG4gIHZhciBjLFxuICAgIGQsXG4gICAgdSxcbiAgICBmLFxuICAgIHAsXG4gICAgdixcbiAgICBoID0gYVswXTtcbiAgaWYgKG4gPyBjID0gMCA9PT0gbyB8fCAxID09PSBvID8ge1xuICAgIGdldDogYVszXSxcbiAgICBzZXQ6IGFbNF1cbiAgfSA6IDMgPT09IG8gPyB7XG4gICAgZ2V0OiBhWzNdXG4gIH0gOiA0ID09PSBvID8ge1xuICAgIHNldDogYVszXVxuICB9IDoge1xuICAgIHZhbHVlOiBhWzNdXG4gIH0gOiAwICE9PSBvICYmIChjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0LCByKSksIDEgPT09IG8gPyB1ID0ge1xuICAgIGdldDogYy5nZXQsXG4gICAgc2V0OiBjLnNldFxuICB9IDogMiA9PT0gbyA/IHUgPSBjLnZhbHVlIDogMyA9PT0gbyA/IHUgPSBjLmdldCA6IDQgPT09IG8gJiYgKHUgPSBjLnNldCksIFwiZnVuY3Rpb25cIiA9PSB0eXBlb2YgaCkgdm9pZCAwICE9PSAoZiA9IG9sZF9tZW1iZXJEZWMoaCwgciwgYywgbCwgcywgbywgaSwgbiwgdSkpICYmIChvbGRfYXNzZXJ0VmFsaWRSZXR1cm5WYWx1ZShvLCBmKSwgMCA9PT0gbyA/IGQgPSBmIDogMSA9PT0gbyA/IChkID0gb2xkX2dldEluaXQoZiksIHAgPSBmLmdldCB8fCB1LmdldCwgdiA9IGYuc2V0IHx8IHUuc2V0LCB1ID0ge1xuICAgIGdldDogcCxcbiAgICBzZXQ6IHZcbiAgfSkgOiB1ID0gZik7ZWxzZSBmb3IgKHZhciB5ID0gaC5sZW5ndGggLSAxOyB5ID49IDA7IHktLSkge1xuICAgIHZhciBiO1xuICAgIGlmICh2b2lkIDAgIT09IChmID0gb2xkX21lbWJlckRlYyhoW3ldLCByLCBjLCBsLCBzLCBvLCBpLCBuLCB1KSkpIG9sZF9hc3NlcnRWYWxpZFJldHVyblZhbHVlKG8sIGYpLCAwID09PSBvID8gYiA9IGYgOiAxID09PSBvID8gKGIgPSBvbGRfZ2V0SW5pdChmKSwgcCA9IGYuZ2V0IHx8IHUuZ2V0LCB2ID0gZi5zZXQgfHwgdS5zZXQsIHUgPSB7XG4gICAgICBnZXQ6IHAsXG4gICAgICBzZXQ6IHZcbiAgICB9KSA6IHUgPSBmLCB2b2lkIDAgIT09IGIgJiYgKHZvaWQgMCA9PT0gZCA/IGQgPSBiIDogXCJmdW5jdGlvblwiID09IHR5cGVvZiBkID8gZCA9IFtkLCBiXSA6IGQucHVzaChiKSk7XG4gIH1cbiAgaWYgKDAgPT09IG8gfHwgMSA9PT0gbykge1xuICAgIGlmICh2b2lkIDAgPT09IGQpIGQgPSBmdW5jdGlvbiAoZSwgdCkge1xuICAgICAgcmV0dXJuIHQ7XG4gICAgfTtlbHNlIGlmIChcImZ1bmN0aW9uXCIgIT0gdHlwZW9mIGQpIHtcbiAgICAgIHZhciBnID0gZDtcbiAgICAgIGQgPSBmdW5jdGlvbiAoZSwgdCkge1xuICAgICAgICBmb3IgKHZhciBhID0gdCwgciA9IDA7IHIgPCBnLmxlbmd0aDsgcisrKSBhID0gZ1tyXS5jYWxsKGUsIGEpO1xuICAgICAgICByZXR1cm4gYTtcbiAgICAgIH07XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhciBtID0gZDtcbiAgICAgIGQgPSBmdW5jdGlvbiAoZSwgdCkge1xuICAgICAgICByZXR1cm4gbS5jYWxsKGUsIHQpO1xuICAgICAgfTtcbiAgICB9XG4gICAgZS5wdXNoKGQpO1xuICB9XG4gIDAgIT09IG8gJiYgKDEgPT09IG8gPyAoYy5nZXQgPSB1LmdldCwgYy5zZXQgPSB1LnNldCkgOiAyID09PSBvID8gYy52YWx1ZSA9IHUgOiAzID09PSBvID8gYy5nZXQgPSB1IDogNCA9PT0gbyAmJiAoYy5zZXQgPSB1KSwgbiA/IDEgPT09IG8gPyAoZS5wdXNoKGZ1bmN0aW9uIChlLCB0KSB7XG4gICAgcmV0dXJuIHUuZ2V0LmNhbGwoZSwgdCk7XG4gIH0pLCBlLnB1c2goZnVuY3Rpb24gKGUsIHQpIHtcbiAgICByZXR1cm4gdS5zZXQuY2FsbChlLCB0KTtcbiAgfSkpIDogMiA9PT0gbyA/IGUucHVzaCh1KSA6IGUucHVzaChmdW5jdGlvbiAoZSwgdCkge1xuICAgIHJldHVybiB1LmNhbGwoZSwgdCk7XG4gIH0pIDogT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsIHIsIGMpKTtcbn1cbmZ1bmN0aW9uIG9sZF9hcHBseU1lbWJlckRlY3MoZSwgdCwgYSwgciwgbykge1xuICBmb3IgKHZhciBpLCBuLCBsID0gbmV3IE1hcCgpLCBzID0gbmV3IE1hcCgpLCBjID0gMDsgYyA8IG8ubGVuZ3RoOyBjKyspIHtcbiAgICB2YXIgZCA9IG9bY107XG4gICAgaWYgKEFycmF5LmlzQXJyYXkoZCkpIHtcbiAgICAgIHZhciB1LFxuICAgICAgICBmLFxuICAgICAgICBwLFxuICAgICAgICB2ID0gZFsxXSxcbiAgICAgICAgaCA9IGRbMl0sXG4gICAgICAgIHkgPSBkLmxlbmd0aCA+IDMsXG4gICAgICAgIGIgPSB2ID49IDU7XG4gICAgICBpZiAoYiA/ICh1ID0gdCwgZiA9IHIsIDAgIT09ICh2IC09IDUpICYmIChwID0gbiA9IG4gfHwgW10pKSA6ICh1ID0gdC5wcm90b3R5cGUsIGYgPSBhLCAwICE9PSB2ICYmIChwID0gaSA9IGkgfHwgW10pKSwgMCAhPT0gdiAmJiAheSkge1xuICAgICAgICB2YXIgZyA9IGIgPyBzIDogbCxcbiAgICAgICAgICBtID0gZy5nZXQoaCkgfHwgMDtcbiAgICAgICAgaWYgKCEwID09PSBtIHx8IDMgPT09IG0gJiYgNCAhPT0gdiB8fCA0ID09PSBtICYmIDMgIT09IHYpIHRocm93IG5ldyBFcnJvcihcIkF0dGVtcHRlZCB0byBkZWNvcmF0ZSBhIHB1YmxpYyBtZXRob2QvYWNjZXNzb3IgdGhhdCBoYXMgdGhlIHNhbWUgbmFtZSBhcyBhIHByZXZpb3VzbHkgZGVjb3JhdGVkIHB1YmxpYyBtZXRob2QvYWNjZXNzb3IuIFRoaXMgaXMgbm90IGN1cnJlbnRseSBzdXBwb3J0ZWQgYnkgdGhlIGRlY29yYXRvcnMgcGx1Z2luLiBQcm9wZXJ0eSBuYW1lIHdhczogXCIgKyBoKTtcbiAgICAgICAgIW0gJiYgdiA+IDIgPyBnLnNldChoLCB2KSA6IGcuc2V0KGgsICEwKTtcbiAgICAgIH1cbiAgICAgIG9sZF9hcHBseU1lbWJlckRlYyhlLCB1LCBkLCBoLCB2LCBiLCB5LCBmLCBwKTtcbiAgICB9XG4gIH1cbiAgb2xkX3B1c2hJbml0aWFsaXplcnMoZSwgaSksIG9sZF9wdXNoSW5pdGlhbGl6ZXJzKGUsIG4pO1xufVxuZnVuY3Rpb24gb2xkX3B1c2hJbml0aWFsaXplcnMoZSwgdCkge1xuICB0ICYmIGUucHVzaChmdW5jdGlvbiAoZSkge1xuICAgIGZvciAodmFyIGEgPSAwOyBhIDwgdC5sZW5ndGg7IGErKykgdFthXS5jYWxsKGUpO1xuICAgIHJldHVybiBlO1xuICB9KTtcbn1cbmZ1bmN0aW9uIG9sZF9hcHBseUNsYXNzRGVjcyhlLCB0LCBhLCByKSB7XG4gIGlmIChyLmxlbmd0aCA+IDApIHtcbiAgICBmb3IgKHZhciBvID0gW10sIGkgPSB0LCBuID0gdC5uYW1lLCBsID0gci5sZW5ndGggLSAxOyBsID49IDA7IGwtLSkge1xuICAgICAgdmFyIHMgPSB7XG4gICAgICAgIHY6ICExXG4gICAgICB9O1xuICAgICAgdHJ5IHtcbiAgICAgICAgdmFyIGMgPSBPYmplY3QuYXNzaWduKHtcbiAgICAgICAgICAgIGtpbmQ6IFwiY2xhc3NcIixcbiAgICAgICAgICAgIG5hbWU6IG4sXG4gICAgICAgICAgICBhZGRJbml0aWFsaXplcjogb2xkX2NyZWF0ZUFkZEluaXRpYWxpemVyTWV0aG9kKG8sIHMpXG4gICAgICAgICAgfSwgb2xkX2NyZWF0ZU1ldGFkYXRhTWV0aG9kc0ZvclByb3BlcnR5KGEsIDAsIG4sIHMpKSxcbiAgICAgICAgICBkID0gcltsXShpLCBjKTtcbiAgICAgIH0gZmluYWxseSB7XG4gICAgICAgIHMudiA9ICEwO1xuICAgICAgfVxuICAgICAgdm9pZCAwICE9PSBkICYmIChvbGRfYXNzZXJ0VmFsaWRSZXR1cm5WYWx1ZSgxMCwgZCksIGkgPSBkKTtcbiAgICB9XG4gICAgZS5wdXNoKGksIGZ1bmN0aW9uICgpIHtcbiAgICAgIGZvciAodmFyIGUgPSAwOyBlIDwgby5sZW5ndGg7IGUrKykgb1tlXS5jYWxsKGkpO1xuICAgIH0pO1xuICB9XG59XG5mdW5jdGlvbiBfYXBwbHlEZWNzKGUsIHQsIGEpIHtcbiAgdmFyIHIgPSBbXSxcbiAgICBvID0ge30sXG4gICAgaSA9IHt9O1xuICByZXR1cm4gb2xkX2FwcGx5TWVtYmVyRGVjcyhyLCBlLCBpLCBvLCB0KSwgb2xkX2NvbnZlcnRNZXRhZGF0YU1hcFRvRmluYWwoZS5wcm90b3R5cGUsIGkpLCBvbGRfYXBwbHlDbGFzc0RlY3MociwgZSwgbywgYSksIG9sZF9jb252ZXJ0TWV0YWRhdGFNYXBUb0ZpbmFsKGUsIG8pLCByO1xufVxuZnVuY3Rpb24gYXBwbHlEZWNzMjIwM0ZhY3RvcnkoKSB7XG4gIGZ1bmN0aW9uIGNyZWF0ZUFkZEluaXRpYWxpemVyTWV0aG9kKGUsIHQpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHIpIHtcbiAgICAgICFmdW5jdGlvbiAoZSwgdCkge1xuICAgICAgICBpZiAoZS52KSB0aHJvdyBuZXcgRXJyb3IoXCJhdHRlbXB0ZWQgdG8gY2FsbCBcIiArIHQgKyBcIiBhZnRlciBkZWNvcmF0aW9uIHdhcyBmaW5pc2hlZFwiKTtcbiAgICAgIH0odCwgXCJhZGRJbml0aWFsaXplclwiKSwgYXNzZXJ0Q2FsbGFibGUociwgXCJBbiBpbml0aWFsaXplclwiKSwgZS5wdXNoKHIpO1xuICAgIH07XG4gIH1cbiAgZnVuY3Rpb24gbWVtYmVyRGVjKGUsIHQsIHIsIGEsIG4sIGksIHMsIG8pIHtcbiAgICB2YXIgYztcbiAgICBzd2l0Y2ggKG4pIHtcbiAgICAgIGNhc2UgMTpcbiAgICAgICAgYyA9IFwiYWNjZXNzb3JcIjtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIDI6XG4gICAgICAgIGMgPSBcIm1ldGhvZFwiO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgMzpcbiAgICAgICAgYyA9IFwiZ2V0dGVyXCI7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSA0OlxuICAgICAgICBjID0gXCJzZXR0ZXJcIjtcbiAgICAgICAgYnJlYWs7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICBjID0gXCJmaWVsZFwiO1xuICAgIH1cbiAgICB2YXIgbCxcbiAgICAgIHUsXG4gICAgICBmID0ge1xuICAgICAgICBraW5kOiBjLFxuICAgICAgICBuYW1lOiBzID8gXCIjXCIgKyB0IDogdCxcbiAgICAgICAgc3RhdGljOiBpLFxuICAgICAgICBwcml2YXRlOiBzXG4gICAgICB9LFxuICAgICAgcCA9IHtcbiAgICAgICAgdjogITFcbiAgICAgIH07XG4gICAgMCAhPT0gbiAmJiAoZi5hZGRJbml0aWFsaXplciA9IGNyZWF0ZUFkZEluaXRpYWxpemVyTWV0aG9kKGEsIHApKSwgMCA9PT0gbiA/IHMgPyAobCA9IHIuZ2V0LCB1ID0gci5zZXQpIDogKGwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpc1t0XTtcbiAgICB9LCB1ID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgIHRoaXNbdF0gPSBlO1xuICAgIH0pIDogMiA9PT0gbiA/IGwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gci52YWx1ZTtcbiAgICB9IDogKDEgIT09IG4gJiYgMyAhPT0gbiB8fCAobCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiByLmdldC5jYWxsKHRoaXMpO1xuICAgIH0pLCAxICE9PSBuICYmIDQgIT09IG4gfHwgKHUgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgci5zZXQuY2FsbCh0aGlzLCBlKTtcbiAgICB9KSksIGYuYWNjZXNzID0gbCAmJiB1ID8ge1xuICAgICAgZ2V0OiBsLFxuICAgICAgc2V0OiB1XG4gICAgfSA6IGwgPyB7XG4gICAgICBnZXQ6IGxcbiAgICB9IDoge1xuICAgICAgc2V0OiB1XG4gICAgfTtcbiAgICB0cnkge1xuICAgICAgcmV0dXJuIGUobywgZik7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHAudiA9ICEwO1xuICAgIH1cbiAgfVxuICBmdW5jdGlvbiBhc3NlcnRDYWxsYWJsZShlLCB0KSB7XG4gICAgaWYgKFwiZnVuY3Rpb25cIiAhPSB0eXBlb2YgZSkgdGhyb3cgbmV3IFR5cGVFcnJvcih0ICsgXCIgbXVzdCBiZSBhIGZ1bmN0aW9uXCIpO1xuICB9XG4gIGZ1bmN0aW9uIGFzc2VydFZhbGlkUmV0dXJuVmFsdWUoZSwgdCkge1xuICAgIHZhciByID0gdHlwZW9mIHQ7XG4gICAgaWYgKDEgPT09IGUpIHtcbiAgICAgIGlmIChcIm9iamVjdFwiICE9PSByIHx8IG51bGwgPT09IHQpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJhY2Nlc3NvciBkZWNvcmF0b3JzIG11c3QgcmV0dXJuIGFuIG9iamVjdCB3aXRoIGdldCwgc2V0LCBvciBpbml0IHByb3BlcnRpZXMgb3Igdm9pZCAwXCIpO1xuICAgICAgdm9pZCAwICE9PSB0LmdldCAmJiBhc3NlcnRDYWxsYWJsZSh0LmdldCwgXCJhY2Nlc3Nvci5nZXRcIiksIHZvaWQgMCAhPT0gdC5zZXQgJiYgYXNzZXJ0Q2FsbGFibGUodC5zZXQsIFwiYWNjZXNzb3Iuc2V0XCIpLCB2b2lkIDAgIT09IHQuaW5pdCAmJiBhc3NlcnRDYWxsYWJsZSh0LmluaXQsIFwiYWNjZXNzb3IuaW5pdFwiKTtcbiAgICB9IGVsc2UgaWYgKFwiZnVuY3Rpb25cIiAhPT0gcikge1xuICAgICAgdmFyIGE7XG4gICAgICB0aHJvdyBhID0gMCA9PT0gZSA/IFwiZmllbGRcIiA6IDEwID09PSBlID8gXCJjbGFzc1wiIDogXCJtZXRob2RcIiwgbmV3IFR5cGVFcnJvcihhICsgXCIgZGVjb3JhdG9ycyBtdXN0IHJldHVybiBhIGZ1bmN0aW9uIG9yIHZvaWQgMFwiKTtcbiAgICB9XG4gIH1cbiAgZnVuY3Rpb24gYXBwbHlNZW1iZXJEZWMoZSwgdCwgciwgYSwgbiwgaSwgcywgbykge1xuICAgIHZhciBjLFxuICAgICAgbCxcbiAgICAgIHUsXG4gICAgICBmLFxuICAgICAgcCxcbiAgICAgIGQsXG4gICAgICBoID0gclswXTtcbiAgICBpZiAocyA/IGMgPSAwID09PSBuIHx8IDEgPT09IG4gPyB7XG4gICAgICBnZXQ6IHJbM10sXG4gICAgICBzZXQ6IHJbNF1cbiAgICB9IDogMyA9PT0gbiA/IHtcbiAgICAgIGdldDogclszXVxuICAgIH0gOiA0ID09PSBuID8ge1xuICAgICAgc2V0OiByWzNdXG4gICAgfSA6IHtcbiAgICAgIHZhbHVlOiByWzNdXG4gICAgfSA6IDAgIT09IG4gJiYgKGMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHQsIGEpKSwgMSA9PT0gbiA/IHUgPSB7XG4gICAgICBnZXQ6IGMuZ2V0LFxuICAgICAgc2V0OiBjLnNldFxuICAgIH0gOiAyID09PSBuID8gdSA9IGMudmFsdWUgOiAzID09PSBuID8gdSA9IGMuZ2V0IDogNCA9PT0gbiAmJiAodSA9IGMuc2V0KSwgXCJmdW5jdGlvblwiID09IHR5cGVvZiBoKSB2b2lkIDAgIT09IChmID0gbWVtYmVyRGVjKGgsIGEsIGMsIG8sIG4sIGksIHMsIHUpKSAmJiAoYXNzZXJ0VmFsaWRSZXR1cm5WYWx1ZShuLCBmKSwgMCA9PT0gbiA/IGwgPSBmIDogMSA9PT0gbiA/IChsID0gZi5pbml0LCBwID0gZi5nZXQgfHwgdS5nZXQsIGQgPSBmLnNldCB8fCB1LnNldCwgdSA9IHtcbiAgICAgIGdldDogcCxcbiAgICAgIHNldDogZFxuICAgIH0pIDogdSA9IGYpO2Vsc2UgZm9yICh2YXIgdiA9IGgubGVuZ3RoIC0gMTsgdiA+PSAwOyB2LS0pIHtcbiAgICAgIHZhciBnO1xuICAgICAgaWYgKHZvaWQgMCAhPT0gKGYgPSBtZW1iZXJEZWMoaFt2XSwgYSwgYywgbywgbiwgaSwgcywgdSkpKSBhc3NlcnRWYWxpZFJldHVyblZhbHVlKG4sIGYpLCAwID09PSBuID8gZyA9IGYgOiAxID09PSBuID8gKGcgPSBmLmluaXQsIHAgPSBmLmdldCB8fCB1LmdldCwgZCA9IGYuc2V0IHx8IHUuc2V0LCB1ID0ge1xuICAgICAgICBnZXQ6IHAsXG4gICAgICAgIHNldDogZFxuICAgICAgfSkgOiB1ID0gZiwgdm9pZCAwICE9PSBnICYmICh2b2lkIDAgPT09IGwgPyBsID0gZyA6IFwiZnVuY3Rpb25cIiA9PSB0eXBlb2YgbCA/IGwgPSBbbCwgZ10gOiBsLnB1c2goZykpO1xuICAgIH1cbiAgICBpZiAoMCA9PT0gbiB8fCAxID09PSBuKSB7XG4gICAgICBpZiAodm9pZCAwID09PSBsKSBsID0gZnVuY3Rpb24gKGUsIHQpIHtcbiAgICAgICAgcmV0dXJuIHQ7XG4gICAgICB9O2Vsc2UgaWYgKFwiZnVuY3Rpb25cIiAhPSB0eXBlb2YgbCkge1xuICAgICAgICB2YXIgeSA9IGw7XG4gICAgICAgIGwgPSBmdW5jdGlvbiAoZSwgdCkge1xuICAgICAgICAgIGZvciAodmFyIHIgPSB0LCBhID0gMDsgYSA8IHkubGVuZ3RoOyBhKyspIHIgPSB5W2FdLmNhbGwoZSwgcik7XG4gICAgICAgICAgcmV0dXJuIHI7XG4gICAgICAgIH07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgbSA9IGw7XG4gICAgICAgIGwgPSBmdW5jdGlvbiAoZSwgdCkge1xuICAgICAgICAgIHJldHVybiBtLmNhbGwoZSwgdCk7XG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICBlLnB1c2gobCk7XG4gICAgfVxuICAgIDAgIT09IG4gJiYgKDEgPT09IG4gPyAoYy5nZXQgPSB1LmdldCwgYy5zZXQgPSB1LnNldCkgOiAyID09PSBuID8gYy52YWx1ZSA9IHUgOiAzID09PSBuID8gYy5nZXQgPSB1IDogNCA9PT0gbiAmJiAoYy5zZXQgPSB1KSwgcyA/IDEgPT09IG4gPyAoZS5wdXNoKGZ1bmN0aW9uIChlLCB0KSB7XG4gICAgICByZXR1cm4gdS5nZXQuY2FsbChlLCB0KTtcbiAgICB9KSwgZS5wdXNoKGZ1bmN0aW9uIChlLCB0KSB7XG4gICAgICByZXR1cm4gdS5zZXQuY2FsbChlLCB0KTtcbiAgICB9KSkgOiAyID09PSBuID8gZS5wdXNoKHUpIDogZS5wdXNoKGZ1bmN0aW9uIChlLCB0KSB7XG4gICAgICByZXR1cm4gdS5jYWxsKGUsIHQpO1xuICAgIH0pIDogT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsIGEsIGMpKTtcbiAgfVxuICBmdW5jdGlvbiBwdXNoSW5pdGlhbGl6ZXJzKGUsIHQpIHtcbiAgICB0ICYmIGUucHVzaChmdW5jdGlvbiAoZSkge1xuICAgICAgZm9yICh2YXIgciA9IDA7IHIgPCB0Lmxlbmd0aDsgcisrKSB0W3JdLmNhbGwoZSk7XG4gICAgICByZXR1cm4gZTtcbiAgICB9KTtcbiAgfVxuICByZXR1cm4gZnVuY3Rpb24gKGUsIHQsIHIpIHtcbiAgICB2YXIgYSA9IFtdO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZSwgdCwgcikge1xuICAgICAgZm9yICh2YXIgYSwgbiwgaSA9IG5ldyBNYXAoKSwgcyA9IG5ldyBNYXAoKSwgbyA9IDA7IG8gPCByLmxlbmd0aDsgbysrKSB7XG4gICAgICAgIHZhciBjID0gcltvXTtcbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoYykpIHtcbiAgICAgICAgICB2YXIgbCxcbiAgICAgICAgICAgIHUsXG4gICAgICAgICAgICBmID0gY1sxXSxcbiAgICAgICAgICAgIHAgPSBjWzJdLFxuICAgICAgICAgICAgZCA9IGMubGVuZ3RoID4gMyxcbiAgICAgICAgICAgIGggPSBmID49IDU7XG4gICAgICAgICAgaWYgKGggPyAobCA9IHQsIDAgIT0gKGYgLT0gNSkgJiYgKHUgPSBuID0gbiB8fCBbXSkpIDogKGwgPSB0LnByb3RvdHlwZSwgMCAhPT0gZiAmJiAodSA9IGEgPSBhIHx8IFtdKSksIDAgIT09IGYgJiYgIWQpIHtcbiAgICAgICAgICAgIHZhciB2ID0gaCA/IHMgOiBpLFxuICAgICAgICAgICAgICBnID0gdi5nZXQocCkgfHwgMDtcbiAgICAgICAgICAgIGlmICghMCA9PT0gZyB8fCAzID09PSBnICYmIDQgIT09IGYgfHwgNCA9PT0gZyAmJiAzICE9PSBmKSB0aHJvdyBuZXcgRXJyb3IoXCJBdHRlbXB0ZWQgdG8gZGVjb3JhdGUgYSBwdWJsaWMgbWV0aG9kL2FjY2Vzc29yIHRoYXQgaGFzIHRoZSBzYW1lIG5hbWUgYXMgYSBwcmV2aW91c2x5IGRlY29yYXRlZCBwdWJsaWMgbWV0aG9kL2FjY2Vzc29yLiBUaGlzIGlzIG5vdCBjdXJyZW50bHkgc3VwcG9ydGVkIGJ5IHRoZSBkZWNvcmF0b3JzIHBsdWdpbi4gUHJvcGVydHkgbmFtZSB3YXM6IFwiICsgcCk7XG4gICAgICAgICAgICAhZyAmJiBmID4gMiA/IHYuc2V0KHAsIGYpIDogdi5zZXQocCwgITApO1xuICAgICAgICAgIH1cbiAgICAgICAgICBhcHBseU1lbWJlckRlYyhlLCBsLCBjLCBwLCBmLCBoLCBkLCB1KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcHVzaEluaXRpYWxpemVycyhlLCBhKSwgcHVzaEluaXRpYWxpemVycyhlLCBuKTtcbiAgICB9KGEsIGUsIHQpLCBmdW5jdGlvbiAoZSwgdCwgcikge1xuICAgICAgaWYgKHIubGVuZ3RoID4gMCkge1xuICAgICAgICBmb3IgKHZhciBhID0gW10sIG4gPSB0LCBpID0gdC5uYW1lLCBzID0gci5sZW5ndGggLSAxOyBzID49IDA7IHMtLSkge1xuICAgICAgICAgIHZhciBvID0ge1xuICAgICAgICAgICAgdjogITFcbiAgICAgICAgICB9O1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICB2YXIgYyA9IHJbc10obiwge1xuICAgICAgICAgICAgICBraW5kOiBcImNsYXNzXCIsXG4gICAgICAgICAgICAgIG5hbWU6IGksXG4gICAgICAgICAgICAgIGFkZEluaXRpYWxpemVyOiBjcmVhdGVBZGRJbml0aWFsaXplck1ldGhvZChhLCBvKVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgIG8udiA9ICEwO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2b2lkIDAgIT09IGMgJiYgKGFzc2VydFZhbGlkUmV0dXJuVmFsdWUoMTAsIGMpLCBuID0gYyk7XG4gICAgICAgIH1cbiAgICAgICAgZS5wdXNoKG4sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBmb3IgKHZhciBlID0gMDsgZSA8IGEubGVuZ3RoOyBlKyspIGFbZV0uY2FsbChuKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfShhLCBlLCByKSwgYTtcbiAgfTtcbn1cbnZhciBhcHBseURlY3MyMjAzSW1wbDtcbmZ1bmN0aW9uIF9hcHBseURlY3MyMjAzKGUsIHQsIHIpIHtcbiAgcmV0dXJuIChhcHBseURlY3MyMjAzSW1wbCA9IGFwcGx5RGVjczIyMDNJbXBsIHx8IGFwcGx5RGVjczIyMDNGYWN0b3J5KCkpKGUsIHQsIHIpO1xufVxuZnVuY3Rpb24gYXBwbHlEZWNzMjIwM1JGYWN0b3J5KCkge1xuICBmdW5jdGlvbiBjcmVhdGVBZGRJbml0aWFsaXplck1ldGhvZChlLCB0KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChyKSB7XG4gICAgICAhZnVuY3Rpb24gKGUsIHQpIHtcbiAgICAgICAgaWYgKGUudikgdGhyb3cgbmV3IEVycm9yKFwiYXR0ZW1wdGVkIHRvIGNhbGwgXCIgKyB0ICsgXCIgYWZ0ZXIgZGVjb3JhdGlvbiB3YXMgZmluaXNoZWRcIik7XG4gICAgICB9KHQsIFwiYWRkSW5pdGlhbGl6ZXJcIiksIGFzc2VydENhbGxhYmxlKHIsIFwiQW4gaW5pdGlhbGl6ZXJcIiksIGUucHVzaChyKTtcbiAgICB9O1xuICB9XG4gIGZ1bmN0aW9uIG1lbWJlckRlYyhlLCB0LCByLCBuLCBhLCBpLCBzLCBvKSB7XG4gICAgdmFyIGM7XG4gICAgc3dpdGNoIChhKSB7XG4gICAgICBjYXNlIDE6XG4gICAgICAgIGMgPSBcImFjY2Vzc29yXCI7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAyOlxuICAgICAgICBjID0gXCJtZXRob2RcIjtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIDM6XG4gICAgICAgIGMgPSBcImdldHRlclwiO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgNDpcbiAgICAgICAgYyA9IFwic2V0dGVyXCI7XG4gICAgICAgIGJyZWFrO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgYyA9IFwiZmllbGRcIjtcbiAgICB9XG4gICAgdmFyIGwsXG4gICAgICB1LFxuICAgICAgZiA9IHtcbiAgICAgICAga2luZDogYyxcbiAgICAgICAgbmFtZTogcyA/IFwiI1wiICsgdCA6IHQsXG4gICAgICAgIHN0YXRpYzogaSxcbiAgICAgICAgcHJpdmF0ZTogc1xuICAgICAgfSxcbiAgICAgIHAgPSB7XG4gICAgICAgIHY6ICExXG4gICAgICB9O1xuICAgIDAgIT09IGEgJiYgKGYuYWRkSW5pdGlhbGl6ZXIgPSBjcmVhdGVBZGRJbml0aWFsaXplck1ldGhvZChuLCBwKSksIDAgPT09IGEgPyBzID8gKGwgPSByLmdldCwgdSA9IHIuc2V0KSA6IChsID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXNbdF07XG4gICAgfSwgdSA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICB0aGlzW3RdID0gZTtcbiAgICB9KSA6IDIgPT09IGEgPyBsID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHIudmFsdWU7XG4gICAgfSA6ICgxICE9PSBhICYmIDMgIT09IGEgfHwgKGwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gci5nZXQuY2FsbCh0aGlzKTtcbiAgICB9KSwgMSAhPT0gYSAmJiA0ICE9PSBhIHx8ICh1ID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgIHIuc2V0LmNhbGwodGhpcywgZSk7XG4gICAgfSkpLCBmLmFjY2VzcyA9IGwgJiYgdSA/IHtcbiAgICAgIGdldDogbCxcbiAgICAgIHNldDogdVxuICAgIH0gOiBsID8ge1xuICAgICAgZ2V0OiBsXG4gICAgfSA6IHtcbiAgICAgIHNldDogdVxuICAgIH07XG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiBlKG8sIGYpO1xuICAgIH0gZmluYWxseSB7XG4gICAgICBwLnYgPSAhMDtcbiAgICB9XG4gIH1cbiAgZnVuY3Rpb24gYXNzZXJ0Q2FsbGFibGUoZSwgdCkge1xuICAgIGlmIChcImZ1bmN0aW9uXCIgIT0gdHlwZW9mIGUpIHRocm93IG5ldyBUeXBlRXJyb3IodCArIFwiIG11c3QgYmUgYSBmdW5jdGlvblwiKTtcbiAgfVxuICBmdW5jdGlvbiBhc3NlcnRWYWxpZFJldHVyblZhbHVlKGUsIHQpIHtcbiAgICB2YXIgciA9IHR5cGVvZiB0O1xuICAgIGlmICgxID09PSBlKSB7XG4gICAgICBpZiAoXCJvYmplY3RcIiAhPT0gciB8fCBudWxsID09PSB0KSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiYWNjZXNzb3IgZGVjb3JhdG9ycyBtdXN0IHJldHVybiBhbiBvYmplY3Qgd2l0aCBnZXQsIHNldCwgb3IgaW5pdCBwcm9wZXJ0aWVzIG9yIHZvaWQgMFwiKTtcbiAgICAgIHZvaWQgMCAhPT0gdC5nZXQgJiYgYXNzZXJ0Q2FsbGFibGUodC5nZXQsIFwiYWNjZXNzb3IuZ2V0XCIpLCB2b2lkIDAgIT09IHQuc2V0ICYmIGFzc2VydENhbGxhYmxlKHQuc2V0LCBcImFjY2Vzc29yLnNldFwiKSwgdm9pZCAwICE9PSB0LmluaXQgJiYgYXNzZXJ0Q2FsbGFibGUodC5pbml0LCBcImFjY2Vzc29yLmluaXRcIik7XG4gICAgfSBlbHNlIGlmIChcImZ1bmN0aW9uXCIgIT09IHIpIHtcbiAgICAgIHZhciBuO1xuICAgICAgdGhyb3cgbiA9IDAgPT09IGUgPyBcImZpZWxkXCIgOiAxMCA9PT0gZSA/IFwiY2xhc3NcIiA6IFwibWV0aG9kXCIsIG5ldyBUeXBlRXJyb3IobiArIFwiIGRlY29yYXRvcnMgbXVzdCByZXR1cm4gYSBmdW5jdGlvbiBvciB2b2lkIDBcIik7XG4gICAgfVxuICB9XG4gIGZ1bmN0aW9uIGFwcGx5TWVtYmVyRGVjKGUsIHQsIHIsIG4sIGEsIGksIHMsIG8pIHtcbiAgICB2YXIgYyxcbiAgICAgIGwsXG4gICAgICB1LFxuICAgICAgZixcbiAgICAgIHAsXG4gICAgICBkLFxuICAgICAgaCA9IHJbMF07XG4gICAgaWYgKHMgPyBjID0gMCA9PT0gYSB8fCAxID09PSBhID8ge1xuICAgICAgZ2V0OiByWzNdLFxuICAgICAgc2V0OiByWzRdXG4gICAgfSA6IDMgPT09IGEgPyB7XG4gICAgICBnZXQ6IHJbM11cbiAgICB9IDogNCA9PT0gYSA/IHtcbiAgICAgIHNldDogclszXVxuICAgIH0gOiB7XG4gICAgICB2YWx1ZTogclszXVxuICAgIH0gOiAwICE9PSBhICYmIChjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0LCBuKSksIDEgPT09IGEgPyB1ID0ge1xuICAgICAgZ2V0OiBjLmdldCxcbiAgICAgIHNldDogYy5zZXRcbiAgICB9IDogMiA9PT0gYSA/IHUgPSBjLnZhbHVlIDogMyA9PT0gYSA/IHUgPSBjLmdldCA6IDQgPT09IGEgJiYgKHUgPSBjLnNldCksIFwiZnVuY3Rpb25cIiA9PSB0eXBlb2YgaCkgdm9pZCAwICE9PSAoZiA9IG1lbWJlckRlYyhoLCBuLCBjLCBvLCBhLCBpLCBzLCB1KSkgJiYgKGFzc2VydFZhbGlkUmV0dXJuVmFsdWUoYSwgZiksIDAgPT09IGEgPyBsID0gZiA6IDEgPT09IGEgPyAobCA9IGYuaW5pdCwgcCA9IGYuZ2V0IHx8IHUuZ2V0LCBkID0gZi5zZXQgfHwgdS5zZXQsIHUgPSB7XG4gICAgICBnZXQ6IHAsXG4gICAgICBzZXQ6IGRcbiAgICB9KSA6IHUgPSBmKTtlbHNlIGZvciAodmFyIHYgPSBoLmxlbmd0aCAtIDE7IHYgPj0gMDsgdi0tKSB7XG4gICAgICB2YXIgZztcbiAgICAgIGlmICh2b2lkIDAgIT09IChmID0gbWVtYmVyRGVjKGhbdl0sIG4sIGMsIG8sIGEsIGksIHMsIHUpKSkgYXNzZXJ0VmFsaWRSZXR1cm5WYWx1ZShhLCBmKSwgMCA9PT0gYSA/IGcgPSBmIDogMSA9PT0gYSA/IChnID0gZi5pbml0LCBwID0gZi5nZXQgfHwgdS5nZXQsIGQgPSBmLnNldCB8fCB1LnNldCwgdSA9IHtcbiAgICAgICAgZ2V0OiBwLFxuICAgICAgICBzZXQ6IGRcbiAgICAgIH0pIDogdSA9IGYsIHZvaWQgMCAhPT0gZyAmJiAodm9pZCAwID09PSBsID8gbCA9IGcgOiBcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIGwgPyBsID0gW2wsIGddIDogbC5wdXNoKGcpKTtcbiAgICB9XG4gICAgaWYgKDAgPT09IGEgfHwgMSA9PT0gYSkge1xuICAgICAgaWYgKHZvaWQgMCA9PT0gbCkgbCA9IGZ1bmN0aW9uIChlLCB0KSB7XG4gICAgICAgIHJldHVybiB0O1xuICAgICAgfTtlbHNlIGlmIChcImZ1bmN0aW9uXCIgIT0gdHlwZW9mIGwpIHtcbiAgICAgICAgdmFyIHkgPSBsO1xuICAgICAgICBsID0gZnVuY3Rpb24gKGUsIHQpIHtcbiAgICAgICAgICBmb3IgKHZhciByID0gdCwgbiA9IDA7IG4gPCB5Lmxlbmd0aDsgbisrKSByID0geVtuXS5jYWxsKGUsIHIpO1xuICAgICAgICAgIHJldHVybiByO1xuICAgICAgICB9O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIG0gPSBsO1xuICAgICAgICBsID0gZnVuY3Rpb24gKGUsIHQpIHtcbiAgICAgICAgICByZXR1cm4gbS5jYWxsKGUsIHQpO1xuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgZS5wdXNoKGwpO1xuICAgIH1cbiAgICAwICE9PSBhICYmICgxID09PSBhID8gKGMuZ2V0ID0gdS5nZXQsIGMuc2V0ID0gdS5zZXQpIDogMiA9PT0gYSA/IGMudmFsdWUgPSB1IDogMyA9PT0gYSA/IGMuZ2V0ID0gdSA6IDQgPT09IGEgJiYgKGMuc2V0ID0gdSksIHMgPyAxID09PSBhID8gKGUucHVzaChmdW5jdGlvbiAoZSwgdCkge1xuICAgICAgcmV0dXJuIHUuZ2V0LmNhbGwoZSwgdCk7XG4gICAgfSksIGUucHVzaChmdW5jdGlvbiAoZSwgdCkge1xuICAgICAgcmV0dXJuIHUuc2V0LmNhbGwoZSwgdCk7XG4gICAgfSkpIDogMiA9PT0gYSA/IGUucHVzaCh1KSA6IGUucHVzaChmdW5jdGlvbiAoZSwgdCkge1xuICAgICAgcmV0dXJuIHUuY2FsbChlLCB0KTtcbiAgICB9KSA6IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCBuLCBjKSk7XG4gIH1cbiAgZnVuY3Rpb24gYXBwbHlNZW1iZXJEZWNzKGUsIHQpIHtcbiAgICBmb3IgKHZhciByLCBuLCBhID0gW10sIGkgPSBuZXcgTWFwKCksIHMgPSBuZXcgTWFwKCksIG8gPSAwOyBvIDwgdC5sZW5ndGg7IG8rKykge1xuICAgICAgdmFyIGMgPSB0W29dO1xuICAgICAgaWYgKEFycmF5LmlzQXJyYXkoYykpIHtcbiAgICAgICAgdmFyIGwsXG4gICAgICAgICAgdSxcbiAgICAgICAgICBmID0gY1sxXSxcbiAgICAgICAgICBwID0gY1syXSxcbiAgICAgICAgICBkID0gYy5sZW5ndGggPiAzLFxuICAgICAgICAgIGggPSBmID49IDU7XG4gICAgICAgIGlmIChoID8gKGwgPSBlLCAwICE9PSAoZiAtPSA1KSAmJiAodSA9IG4gPSBuIHx8IFtdKSkgOiAobCA9IGUucHJvdG90eXBlLCAwICE9PSBmICYmICh1ID0gciA9IHIgfHwgW10pKSwgMCAhPT0gZiAmJiAhZCkge1xuICAgICAgICAgIHZhciB2ID0gaCA/IHMgOiBpLFxuICAgICAgICAgICAgZyA9IHYuZ2V0KHApIHx8IDA7XG4gICAgICAgICAgaWYgKCEwID09PSBnIHx8IDMgPT09IGcgJiYgNCAhPT0gZiB8fCA0ID09PSBnICYmIDMgIT09IGYpIHRocm93IG5ldyBFcnJvcihcIkF0dGVtcHRlZCB0byBkZWNvcmF0ZSBhIHB1YmxpYyBtZXRob2QvYWNjZXNzb3IgdGhhdCBoYXMgdGhlIHNhbWUgbmFtZSBhcyBhIHByZXZpb3VzbHkgZGVjb3JhdGVkIHB1YmxpYyBtZXRob2QvYWNjZXNzb3IuIFRoaXMgaXMgbm90IGN1cnJlbnRseSBzdXBwb3J0ZWQgYnkgdGhlIGRlY29yYXRvcnMgcGx1Z2luLiBQcm9wZXJ0eSBuYW1lIHdhczogXCIgKyBwKTtcbiAgICAgICAgICAhZyAmJiBmID4gMiA/IHYuc2V0KHAsIGYpIDogdi5zZXQocCwgITApO1xuICAgICAgICB9XG4gICAgICAgIGFwcGx5TWVtYmVyRGVjKGEsIGwsIGMsIHAsIGYsIGgsIGQsIHUpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcHVzaEluaXRpYWxpemVycyhhLCByKSwgcHVzaEluaXRpYWxpemVycyhhLCBuKSwgYTtcbiAgfVxuICBmdW5jdGlvbiBwdXNoSW5pdGlhbGl6ZXJzKGUsIHQpIHtcbiAgICB0ICYmIGUucHVzaChmdW5jdGlvbiAoZSkge1xuICAgICAgZm9yICh2YXIgciA9IDA7IHIgPCB0Lmxlbmd0aDsgcisrKSB0W3JdLmNhbGwoZSk7XG4gICAgICByZXR1cm4gZTtcbiAgICB9KTtcbiAgfVxuICByZXR1cm4gZnVuY3Rpb24gKGUsIHQsIHIpIHtcbiAgICByZXR1cm4ge1xuICAgICAgZTogYXBwbHlNZW1iZXJEZWNzKGUsIHQpLFxuICAgICAgZ2V0IGMoKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoZSwgdCkge1xuICAgICAgICAgIGlmICh0Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGZvciAodmFyIHIgPSBbXSwgbiA9IGUsIGEgPSBlLm5hbWUsIGkgPSB0Lmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICAgIHZhciBzID0ge1xuICAgICAgICAgICAgICAgIHY6ICExXG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdmFyIG8gPSB0W2ldKG4sIHtcbiAgICAgICAgICAgICAgICAgIGtpbmQ6IFwiY2xhc3NcIixcbiAgICAgICAgICAgICAgICAgIG5hbWU6IGEsXG4gICAgICAgICAgICAgICAgICBhZGRJbml0aWFsaXplcjogY3JlYXRlQWRkSW5pdGlhbGl6ZXJNZXRob2QociwgcylcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgICAgICBzLnYgPSAhMDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB2b2lkIDAgIT09IG8gJiYgKGFzc2VydFZhbGlkUmV0dXJuVmFsdWUoMTAsIG8pLCBuID0gbyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gW24sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgZm9yICh2YXIgZSA9IDA7IGUgPCByLmxlbmd0aDsgZSsrKSByW2VdLmNhbGwobik7XG4gICAgICAgICAgICB9XTtcbiAgICAgICAgICB9XG4gICAgICAgIH0oZSwgcik7XG4gICAgICB9XG4gICAgfTtcbiAgfTtcbn1cbmZ1bmN0aW9uIF9hcHBseURlY3MyMjAzUihlLCB0LCByKSB7XG4gIHJldHVybiAoX2FwcGx5RGVjczIyMDNSID0gYXBwbHlEZWNzMjIwM1JGYWN0b3J5KCkpKGUsIHQsIHIpO1xufVxuZnVuY3Rpb24gYXBwbHlEZWNzMjMwMUZhY3RvcnkoKSB7XG4gIGZ1bmN0aW9uIGNyZWF0ZUFkZEluaXRpYWxpemVyTWV0aG9kKGUsIHQpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHIpIHtcbiAgICAgICFmdW5jdGlvbiAoZSwgdCkge1xuICAgICAgICBpZiAoZS52KSB0aHJvdyBuZXcgRXJyb3IoXCJhdHRlbXB0ZWQgdG8gY2FsbCBcIiArIHQgKyBcIiBhZnRlciBkZWNvcmF0aW9uIHdhcyBmaW5pc2hlZFwiKTtcbiAgICAgIH0odCwgXCJhZGRJbml0aWFsaXplclwiKSwgYXNzZXJ0Q2FsbGFibGUociwgXCJBbiBpbml0aWFsaXplclwiKSwgZS5wdXNoKHIpO1xuICAgIH07XG4gIH1cbiAgZnVuY3Rpb24gYXNzZXJ0SW5zdGFuY2VJZlByaXZhdGUoZSwgdCkge1xuICAgIGlmICghZSh0KSkgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkF0dGVtcHRlZCB0byBhY2Nlc3MgcHJpdmF0ZSBlbGVtZW50IG9uIG5vbi1pbnN0YW5jZVwiKTtcbiAgfVxuICBmdW5jdGlvbiBtZW1iZXJEZWMoZSwgdCwgciwgbiwgYSwgaSwgcywgbywgYykge1xuICAgIHZhciB1O1xuICAgIHN3aXRjaCAoYSkge1xuICAgICAgY2FzZSAxOlxuICAgICAgICB1ID0gXCJhY2Nlc3NvclwiO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgMjpcbiAgICAgICAgdSA9IFwibWV0aG9kXCI7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAzOlxuICAgICAgICB1ID0gXCJnZXR0ZXJcIjtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIDQ6XG4gICAgICAgIHUgPSBcInNldHRlclwiO1xuICAgICAgICBicmVhaztcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHUgPSBcImZpZWxkXCI7XG4gICAgfVxuICAgIHZhciBsLFxuICAgICAgZixcbiAgICAgIHAgPSB7XG4gICAgICAgIGtpbmQ6IHUsXG4gICAgICAgIG5hbWU6IHMgPyBcIiNcIiArIHQgOiB0LFxuICAgICAgICBzdGF0aWM6IGksXG4gICAgICAgIHByaXZhdGU6IHNcbiAgICAgIH0sXG4gICAgICBkID0ge1xuICAgICAgICB2OiAhMVxuICAgICAgfTtcbiAgICBpZiAoMCAhPT0gYSAmJiAocC5hZGRJbml0aWFsaXplciA9IGNyZWF0ZUFkZEluaXRpYWxpemVyTWV0aG9kKG4sIGQpKSwgcyB8fCAwICE9PSBhICYmIDIgIT09IGEpIHtcbiAgICAgIGlmICgyID09PSBhKSBsID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgcmV0dXJuIGFzc2VydEluc3RhbmNlSWZQcml2YXRlKGMsIGUpLCByLnZhbHVlO1xuICAgICAgfTtlbHNlIHtcbiAgICAgICAgdmFyIGggPSAwID09PSBhIHx8IDEgPT09IGE7XG4gICAgICAgIChoIHx8IDMgPT09IGEpICYmIChsID0gcyA/IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgcmV0dXJuIGFzc2VydEluc3RhbmNlSWZQcml2YXRlKGMsIGUpLCByLmdldC5jYWxsKGUpO1xuICAgICAgICB9IDogZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICByZXR1cm4gci5nZXQuY2FsbChlKTtcbiAgICAgICAgfSksIChoIHx8IDQgPT09IGEpICYmIChmID0gcyA/IGZ1bmN0aW9uIChlLCB0KSB7XG4gICAgICAgICAgYXNzZXJ0SW5zdGFuY2VJZlByaXZhdGUoYywgZSksIHIuc2V0LmNhbGwoZSwgdCk7XG4gICAgICAgIH0gOiBmdW5jdGlvbiAoZSwgdCkge1xuICAgICAgICAgIHIuc2V0LmNhbGwoZSwgdCk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0gZWxzZSBsID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgIHJldHVybiBlW3RdO1xuICAgIH0sIDAgPT09IGEgJiYgKGYgPSBmdW5jdGlvbiAoZSwgcikge1xuICAgICAgZVt0XSA9IHI7XG4gICAgfSk7XG4gICAgdmFyIHYgPSBzID8gYy5iaW5kKCkgOiBmdW5jdGlvbiAoZSkge1xuICAgICAgcmV0dXJuIHQgaW4gZTtcbiAgICB9O1xuICAgIHAuYWNjZXNzID0gbCAmJiBmID8ge1xuICAgICAgZ2V0OiBsLFxuICAgICAgc2V0OiBmLFxuICAgICAgaGFzOiB2XG4gICAgfSA6IGwgPyB7XG4gICAgICBnZXQ6IGwsXG4gICAgICBoYXM6IHZcbiAgICB9IDoge1xuICAgICAgc2V0OiBmLFxuICAgICAgaGFzOiB2XG4gICAgfTtcbiAgICB0cnkge1xuICAgICAgcmV0dXJuIGUobywgcCk7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIGQudiA9ICEwO1xuICAgIH1cbiAgfVxuICBmdW5jdGlvbiBhc3NlcnRDYWxsYWJsZShlLCB0KSB7XG4gICAgaWYgKFwiZnVuY3Rpb25cIiAhPSB0eXBlb2YgZSkgdGhyb3cgbmV3IFR5cGVFcnJvcih0ICsgXCIgbXVzdCBiZSBhIGZ1bmN0aW9uXCIpO1xuICB9XG4gIGZ1bmN0aW9uIGFzc2VydFZhbGlkUmV0dXJuVmFsdWUoZSwgdCkge1xuICAgIHZhciByID0gdHlwZW9mIHQ7XG4gICAgaWYgKDEgPT09IGUpIHtcbiAgICAgIGlmIChcIm9iamVjdFwiICE9PSByIHx8IG51bGwgPT09IHQpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJhY2Nlc3NvciBkZWNvcmF0b3JzIG11c3QgcmV0dXJuIGFuIG9iamVjdCB3aXRoIGdldCwgc2V0LCBvciBpbml0IHByb3BlcnRpZXMgb3Igdm9pZCAwXCIpO1xuICAgICAgdm9pZCAwICE9PSB0LmdldCAmJiBhc3NlcnRDYWxsYWJsZSh0LmdldCwgXCJhY2Nlc3Nvci5nZXRcIiksIHZvaWQgMCAhPT0gdC5zZXQgJiYgYXNzZXJ0Q2FsbGFibGUodC5zZXQsIFwiYWNjZXNzb3Iuc2V0XCIpLCB2b2lkIDAgIT09IHQuaW5pdCAmJiBhc3NlcnRDYWxsYWJsZSh0LmluaXQsIFwiYWNjZXNzb3IuaW5pdFwiKTtcbiAgICB9IGVsc2UgaWYgKFwiZnVuY3Rpb25cIiAhPT0gcikge1xuICAgICAgdmFyIG47XG4gICAgICB0aHJvdyBuID0gMCA9PT0gZSA/IFwiZmllbGRcIiA6IDEwID09PSBlID8gXCJjbGFzc1wiIDogXCJtZXRob2RcIiwgbmV3IFR5cGVFcnJvcihuICsgXCIgZGVjb3JhdG9ycyBtdXN0IHJldHVybiBhIGZ1bmN0aW9uIG9yIHZvaWQgMFwiKTtcbiAgICB9XG4gIH1cbiAgZnVuY3Rpb24gY3VycnlUaGlzMihlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0KSB7XG4gICAgICBlKHRoaXMsIHQpO1xuICAgIH07XG4gIH1cbiAgZnVuY3Rpb24gYXBwbHlNZW1iZXJEZWMoZSwgdCwgciwgbiwgYSwgaSwgcywgbywgYykge1xuICAgIHZhciB1LFxuICAgICAgbCxcbiAgICAgIGYsXG4gICAgICBwLFxuICAgICAgZCxcbiAgICAgIGgsXG4gICAgICB2LFxuICAgICAgZyA9IHJbMF07XG4gICAgaWYgKHMgPyB1ID0gMCA9PT0gYSB8fCAxID09PSBhID8ge1xuICAgICAgZ2V0OiAocCA9IHJbM10sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHAodGhpcyk7XG4gICAgICB9KSxcbiAgICAgIHNldDogY3VycnlUaGlzMihyWzRdKVxuICAgIH0gOiAzID09PSBhID8ge1xuICAgICAgZ2V0OiByWzNdXG4gICAgfSA6IDQgPT09IGEgPyB7XG4gICAgICBzZXQ6IHJbM11cbiAgICB9IDoge1xuICAgICAgdmFsdWU6IHJbM11cbiAgICB9IDogMCAhPT0gYSAmJiAodSA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodCwgbikpLCAxID09PSBhID8gZiA9IHtcbiAgICAgIGdldDogdS5nZXQsXG4gICAgICBzZXQ6IHUuc2V0XG4gICAgfSA6IDIgPT09IGEgPyBmID0gdS52YWx1ZSA6IDMgPT09IGEgPyBmID0gdS5nZXQgOiA0ID09PSBhICYmIChmID0gdS5zZXQpLCBcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIGcpIHZvaWQgMCAhPT0gKGQgPSBtZW1iZXJEZWMoZywgbiwgdSwgbywgYSwgaSwgcywgZiwgYykpICYmIChhc3NlcnRWYWxpZFJldHVyblZhbHVlKGEsIGQpLCAwID09PSBhID8gbCA9IGQgOiAxID09PSBhID8gKGwgPSBkLmluaXQsIGggPSBkLmdldCB8fCBmLmdldCwgdiA9IGQuc2V0IHx8IGYuc2V0LCBmID0ge1xuICAgICAgZ2V0OiBoLFxuICAgICAgc2V0OiB2XG4gICAgfSkgOiBmID0gZCk7ZWxzZSBmb3IgKHZhciB5ID0gZy5sZW5ndGggLSAxOyB5ID49IDA7IHktLSkge1xuICAgICAgdmFyIG07XG4gICAgICBpZiAodm9pZCAwICE9PSAoZCA9IG1lbWJlckRlYyhnW3ldLCBuLCB1LCBvLCBhLCBpLCBzLCBmLCBjKSkpIGFzc2VydFZhbGlkUmV0dXJuVmFsdWUoYSwgZCksIDAgPT09IGEgPyBtID0gZCA6IDEgPT09IGEgPyAobSA9IGQuaW5pdCwgaCA9IGQuZ2V0IHx8IGYuZ2V0LCB2ID0gZC5zZXQgfHwgZi5zZXQsIGYgPSB7XG4gICAgICAgIGdldDogaCxcbiAgICAgICAgc2V0OiB2XG4gICAgICB9KSA6IGYgPSBkLCB2b2lkIDAgIT09IG0gJiYgKHZvaWQgMCA9PT0gbCA/IGwgPSBtIDogXCJmdW5jdGlvblwiID09IHR5cGVvZiBsID8gbCA9IFtsLCBtXSA6IGwucHVzaChtKSk7XG4gICAgfVxuICAgIGlmICgwID09PSBhIHx8IDEgPT09IGEpIHtcbiAgICAgIGlmICh2b2lkIDAgPT09IGwpIGwgPSBmdW5jdGlvbiAoZSwgdCkge1xuICAgICAgICByZXR1cm4gdDtcbiAgICAgIH07ZWxzZSBpZiAoXCJmdW5jdGlvblwiICE9IHR5cGVvZiBsKSB7XG4gICAgICAgIHZhciBiID0gbDtcbiAgICAgICAgbCA9IGZ1bmN0aW9uIChlLCB0KSB7XG4gICAgICAgICAgZm9yICh2YXIgciA9IHQsIG4gPSAwOyBuIDwgYi5sZW5ndGg7IG4rKykgciA9IGJbbl0uY2FsbChlLCByKTtcbiAgICAgICAgICByZXR1cm4gcjtcbiAgICAgICAgfTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBJID0gbDtcbiAgICAgICAgbCA9IGZ1bmN0aW9uIChlLCB0KSB7XG4gICAgICAgICAgcmV0dXJuIEkuY2FsbChlLCB0KTtcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIGUucHVzaChsKTtcbiAgICB9XG4gICAgMCAhPT0gYSAmJiAoMSA9PT0gYSA/ICh1LmdldCA9IGYuZ2V0LCB1LnNldCA9IGYuc2V0KSA6IDIgPT09IGEgPyB1LnZhbHVlID0gZiA6IDMgPT09IGEgPyB1LmdldCA9IGYgOiA0ID09PSBhICYmICh1LnNldCA9IGYpLCBzID8gMSA9PT0gYSA/IChlLnB1c2goZnVuY3Rpb24gKGUsIHQpIHtcbiAgICAgIHJldHVybiBmLmdldC5jYWxsKGUsIHQpO1xuICAgIH0pLCBlLnB1c2goZnVuY3Rpb24gKGUsIHQpIHtcbiAgICAgIHJldHVybiBmLnNldC5jYWxsKGUsIHQpO1xuICAgIH0pKSA6IDIgPT09IGEgPyBlLnB1c2goZikgOiBlLnB1c2goZnVuY3Rpb24gKGUsIHQpIHtcbiAgICAgIHJldHVybiBmLmNhbGwoZSwgdCk7XG4gICAgfSkgOiBPYmplY3QuZGVmaW5lUHJvcGVydHkodCwgbiwgdSkpO1xuICB9XG4gIGZ1bmN0aW9uIGFwcGx5TWVtYmVyRGVjcyhlLCB0LCByKSB7XG4gICAgZm9yICh2YXIgbiwgYSwgaSwgcyA9IFtdLCBvID0gbmV3IE1hcCgpLCBjID0gbmV3IE1hcCgpLCB1ID0gMDsgdSA8IHQubGVuZ3RoOyB1KyspIHtcbiAgICAgIHZhciBsID0gdFt1XTtcbiAgICAgIGlmIChBcnJheS5pc0FycmF5KGwpKSB7XG4gICAgICAgIHZhciBmLFxuICAgICAgICAgIHAsXG4gICAgICAgICAgZCA9IGxbMV0sXG4gICAgICAgICAgaCA9IGxbMl0sXG4gICAgICAgICAgdiA9IGwubGVuZ3RoID4gMyxcbiAgICAgICAgICBnID0gZCA+PSA1LFxuICAgICAgICAgIHkgPSByO1xuICAgICAgICBpZiAoZyA/IChmID0gZSwgMCAhPT0gKGQgLT0gNSkgJiYgKHAgPSBhID0gYSB8fCBbXSksIHYgJiYgIWkgJiYgKGkgPSBmdW5jdGlvbiAodCkge1xuICAgICAgICAgIHJldHVybiBfY2hlY2tJblJIUyh0KSA9PT0gZTtcbiAgICAgICAgfSksIHkgPSBpKSA6IChmID0gZS5wcm90b3R5cGUsIDAgIT09IGQgJiYgKHAgPSBuID0gbiB8fCBbXSkpLCAwICE9PSBkICYmICF2KSB7XG4gICAgICAgICAgdmFyIG0gPSBnID8gYyA6IG8sXG4gICAgICAgICAgICBiID0gbS5nZXQoaCkgfHwgMDtcbiAgICAgICAgICBpZiAoITAgPT09IGIgfHwgMyA9PT0gYiAmJiA0ICE9PSBkIHx8IDQgPT09IGIgJiYgMyAhPT0gZCkgdGhyb3cgbmV3IEVycm9yKFwiQXR0ZW1wdGVkIHRvIGRlY29yYXRlIGEgcHVibGljIG1ldGhvZC9hY2Nlc3NvciB0aGF0IGhhcyB0aGUgc2FtZSBuYW1lIGFzIGEgcHJldmlvdXNseSBkZWNvcmF0ZWQgcHVibGljIG1ldGhvZC9hY2Nlc3Nvci4gVGhpcyBpcyBub3QgY3VycmVudGx5IHN1cHBvcnRlZCBieSB0aGUgZGVjb3JhdG9ycyBwbHVnaW4uIFByb3BlcnR5IG5hbWUgd2FzOiBcIiArIGgpO1xuICAgICAgICAgICFiICYmIGQgPiAyID8gbS5zZXQoaCwgZCkgOiBtLnNldChoLCAhMCk7XG4gICAgICAgIH1cbiAgICAgICAgYXBwbHlNZW1iZXJEZWMocywgZiwgbCwgaCwgZCwgZywgdiwgcCwgeSk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBwdXNoSW5pdGlhbGl6ZXJzKHMsIG4pLCBwdXNoSW5pdGlhbGl6ZXJzKHMsIGEpLCBzO1xuICB9XG4gIGZ1bmN0aW9uIHB1c2hJbml0aWFsaXplcnMoZSwgdCkge1xuICAgIHQgJiYgZS5wdXNoKGZ1bmN0aW9uIChlKSB7XG4gICAgICBmb3IgKHZhciByID0gMDsgciA8IHQubGVuZ3RoOyByKyspIHRbcl0uY2FsbChlKTtcbiAgICAgIHJldHVybiBlO1xuICAgIH0pO1xuICB9XG4gIHJldHVybiBmdW5jdGlvbiAoZSwgdCwgciwgbikge1xuICAgIHJldHVybiB7XG4gICAgICBlOiBhcHBseU1lbWJlckRlY3MoZSwgdCwgbiksXG4gICAgICBnZXQgYygpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChlLCB0KSB7XG4gICAgICAgICAgaWYgKHQubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgZm9yICh2YXIgciA9IFtdLCBuID0gZSwgYSA9IGUubmFtZSwgaSA9IHQubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgICAgdmFyIHMgPSB7XG4gICAgICAgICAgICAgICAgdjogITFcbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB2YXIgbyA9IHRbaV0obiwge1xuICAgICAgICAgICAgICAgICAga2luZDogXCJjbGFzc1wiLFxuICAgICAgICAgICAgICAgICAgbmFtZTogYSxcbiAgICAgICAgICAgICAgICAgIGFkZEluaXRpYWxpemVyOiBjcmVhdGVBZGRJbml0aWFsaXplck1ldGhvZChyLCBzKVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgICAgICAgIHMudiA9ICEwO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHZvaWQgMCAhPT0gbyAmJiAoYXNzZXJ0VmFsaWRSZXR1cm5WYWx1ZSgxMCwgbyksIG4gPSBvKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBbbiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICBmb3IgKHZhciBlID0gMDsgZSA8IHIubGVuZ3RoOyBlKyspIHJbZV0uY2FsbChuKTtcbiAgICAgICAgICAgIH1dO1xuICAgICAgICAgIH1cbiAgICAgICAgfShlLCByKTtcbiAgICAgIH1cbiAgICB9O1xuICB9O1xufVxuZnVuY3Rpb24gX2FwcGx5RGVjczIzMDEoZSwgdCwgciwgbikge1xuICByZXR1cm4gKF9hcHBseURlY3MyMzAxID0gYXBwbHlEZWNzMjMwMUZhY3RvcnkoKSkoZSwgdCwgciwgbik7XG59XG5mdW5jdGlvbiBjcmVhdGVBZGRJbml0aWFsaXplck1ldGhvZChlLCB0KSB7XG4gIHJldHVybiBmdW5jdGlvbiAocikge1xuICAgIGFzc2VydE5vdEZpbmlzaGVkKHQsIFwiYWRkSW5pdGlhbGl6ZXJcIiksIGFzc2VydENhbGxhYmxlKHIsIFwiQW4gaW5pdGlhbGl6ZXJcIiksIGUucHVzaChyKTtcbiAgfTtcbn1cbmZ1bmN0aW9uIGFzc2VydEluc3RhbmNlSWZQcml2YXRlKGUsIHQpIHtcbiAgaWYgKCFlKHQpKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQXR0ZW1wdGVkIHRvIGFjY2VzcyBwcml2YXRlIGVsZW1lbnQgb24gbm9uLWluc3RhbmNlXCIpO1xufVxuZnVuY3Rpb24gbWVtYmVyRGVjKGUsIHQsIHIsIG4sIGEsIGksIHMsIG8sIGMsIGwpIHtcbiAgdmFyIHU7XG4gIHN3aXRjaCAoaSkge1xuICAgIGNhc2UgMTpcbiAgICAgIHUgPSBcImFjY2Vzc29yXCI7XG4gICAgICBicmVhaztcbiAgICBjYXNlIDI6XG4gICAgICB1ID0gXCJtZXRob2RcIjtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgMzpcbiAgICAgIHUgPSBcImdldHRlclwiO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSA0OlxuICAgICAgdSA9IFwic2V0dGVyXCI7XG4gICAgICBicmVhaztcbiAgICBkZWZhdWx0OlxuICAgICAgdSA9IFwiZmllbGRcIjtcbiAgfVxuICB2YXIgZixcbiAgICBkLFxuICAgIHAgPSB7XG4gICAgICBraW5kOiB1LFxuICAgICAgbmFtZTogbyA/IFwiI1wiICsgciA6IHIsXG4gICAgICBzdGF0aWM6IHMsXG4gICAgICBwcml2YXRlOiBvXG4gICAgfSxcbiAgICBoID0ge1xuICAgICAgdjogITFcbiAgICB9O1xuICBpZiAoMCAhPT0gaSAmJiAocC5hZGRJbml0aWFsaXplciA9IGNyZWF0ZUFkZEluaXRpYWxpemVyTWV0aG9kKGEsIGgpKSwgbyB8fCAwICE9PSBpICYmIDIgIT09IGkpIHtcbiAgICBpZiAoMiA9PT0gaSkgZiA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICByZXR1cm4gYXNzZXJ0SW5zdGFuY2VJZlByaXZhdGUobCwgZSksIG4udmFsdWU7XG4gICAgfTtlbHNlIHtcbiAgICAgIHZhciB2ID0gMCA9PT0gaSB8fCAxID09PSBpO1xuICAgICAgKHYgfHwgMyA9PT0gaSkgJiYgKGYgPSBvID8gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgcmV0dXJuIGFzc2VydEluc3RhbmNlSWZQcml2YXRlKGwsIGUpLCBuLmdldC5jYWxsKGUpO1xuICAgICAgfSA6IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIHJldHVybiBuLmdldC5jYWxsKGUpO1xuICAgICAgfSksICh2IHx8IDQgPT09IGkpICYmIChkID0gbyA/IGZ1bmN0aW9uIChlLCB0KSB7XG4gICAgICAgIGFzc2VydEluc3RhbmNlSWZQcml2YXRlKGwsIGUpLCBuLnNldC5jYWxsKGUsIHQpO1xuICAgICAgfSA6IGZ1bmN0aW9uIChlLCB0KSB7XG4gICAgICAgIG4uc2V0LmNhbGwoZSwgdCk7XG4gICAgICB9KTtcbiAgICB9XG4gIH0gZWxzZSBmID0gZnVuY3Rpb24gKGUpIHtcbiAgICByZXR1cm4gZVtyXTtcbiAgfSwgMCA9PT0gaSAmJiAoZCA9IGZ1bmN0aW9uIChlLCB0KSB7XG4gICAgZVtyXSA9IHQ7XG4gIH0pO1xuICB2YXIgeSA9IG8gPyBsLmJpbmQoKSA6IGZ1bmN0aW9uIChlKSB7XG4gICAgcmV0dXJuIHIgaW4gZTtcbiAgfTtcbiAgcC5hY2Nlc3MgPSBmICYmIGQgPyB7XG4gICAgZ2V0OiBmLFxuICAgIHNldDogZCxcbiAgICBoYXM6IHlcbiAgfSA6IGYgPyB7XG4gICAgZ2V0OiBmLFxuICAgIGhhczogeVxuICB9IDoge1xuICAgIHNldDogZCxcbiAgICBoYXM6IHlcbiAgfTtcbiAgdHJ5IHtcbiAgICByZXR1cm4gZS5jYWxsKHQsIGMsIHApO1xuICB9IGZpbmFsbHkge1xuICAgIGgudiA9ICEwO1xuICB9XG59XG5mdW5jdGlvbiBhc3NlcnROb3RGaW5pc2hlZChlLCB0KSB7XG4gIGlmIChlLnYpIHRocm93IG5ldyBFcnJvcihcImF0dGVtcHRlZCB0byBjYWxsIFwiICsgdCArIFwiIGFmdGVyIGRlY29yYXRpb24gd2FzIGZpbmlzaGVkXCIpO1xufVxuZnVuY3Rpb24gYXNzZXJ0Q2FsbGFibGUoZSwgdCkge1xuICBpZiAoXCJmdW5jdGlvblwiICE9IHR5cGVvZiBlKSB0aHJvdyBuZXcgVHlwZUVycm9yKHQgKyBcIiBtdXN0IGJlIGEgZnVuY3Rpb25cIik7XG59XG5mdW5jdGlvbiBhc3NlcnRWYWxpZFJldHVyblZhbHVlKGUsIHQpIHtcbiAgdmFyIHIgPSB0eXBlb2YgdDtcbiAgaWYgKDEgPT09IGUpIHtcbiAgICBpZiAoXCJvYmplY3RcIiAhPT0gciB8fCBudWxsID09PSB0KSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiYWNjZXNzb3IgZGVjb3JhdG9ycyBtdXN0IHJldHVybiBhbiBvYmplY3Qgd2l0aCBnZXQsIHNldCwgb3IgaW5pdCBwcm9wZXJ0aWVzIG9yIHZvaWQgMFwiKTtcbiAgICB2b2lkIDAgIT09IHQuZ2V0ICYmIGFzc2VydENhbGxhYmxlKHQuZ2V0LCBcImFjY2Vzc29yLmdldFwiKSwgdm9pZCAwICE9PSB0LnNldCAmJiBhc3NlcnRDYWxsYWJsZSh0LnNldCwgXCJhY2Nlc3Nvci5zZXRcIiksIHZvaWQgMCAhPT0gdC5pbml0ICYmIGFzc2VydENhbGxhYmxlKHQuaW5pdCwgXCJhY2Nlc3Nvci5pbml0XCIpO1xuICB9IGVsc2UgaWYgKFwiZnVuY3Rpb25cIiAhPT0gcikge1xuICAgIHZhciBuO1xuICAgIHRocm93IG4gPSAwID09PSBlID8gXCJmaWVsZFwiIDogNSA9PT0gZSA/IFwiY2xhc3NcIiA6IFwibWV0aG9kXCIsIG5ldyBUeXBlRXJyb3IobiArIFwiIGRlY29yYXRvcnMgbXVzdCByZXR1cm4gYSBmdW5jdGlvbiBvciB2b2lkIDBcIik7XG4gIH1cbn1cbmZ1bmN0aW9uIGN1cnJ5VGhpczEoZSkge1xuICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBlKHRoaXMpO1xuICB9O1xufVxuZnVuY3Rpb24gY3VycnlUaGlzMihlKSB7XG4gIHJldHVybiBmdW5jdGlvbiAodCkge1xuICAgIGUodGhpcywgdCk7XG4gIH07XG59XG5mdW5jdGlvbiBhcHBseU1lbWJlckRlYyhlLCB0LCByLCBuLCBhLCBpLCBzLCBvLCBjLCBsKSB7XG4gIHZhciB1LFxuICAgIGYsXG4gICAgZCxcbiAgICBwLFxuICAgIGgsXG4gICAgdixcbiAgICB5ID0gclswXTtcbiAgbiB8fCBBcnJheS5pc0FycmF5KHkpIHx8ICh5ID0gW3ldKSwgbyA/IHUgPSAwID09PSBpIHx8IDEgPT09IGkgPyB7XG4gICAgZ2V0OiBjdXJyeVRoaXMxKHJbM10pLFxuICAgIHNldDogY3VycnlUaGlzMihyWzRdKVxuICB9IDogMyA9PT0gaSA/IHtcbiAgICBnZXQ6IHJbM11cbiAgfSA6IDQgPT09IGkgPyB7XG4gICAgc2V0OiByWzNdXG4gIH0gOiB7XG4gICAgdmFsdWU6IHJbM11cbiAgfSA6IDAgIT09IGkgJiYgKHUgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHQsIGEpKSwgMSA9PT0gaSA/IGQgPSB7XG4gICAgZ2V0OiB1LmdldCxcbiAgICBzZXQ6IHUuc2V0XG4gIH0gOiAyID09PSBpID8gZCA9IHUudmFsdWUgOiAzID09PSBpID8gZCA9IHUuZ2V0IDogNCA9PT0gaSAmJiAoZCA9IHUuc2V0KTtcbiAgZm9yICh2YXIgZyA9IG4gPyAyIDogMSwgbSA9IHkubGVuZ3RoIC0gMTsgbSA+PSAwOyBtIC09IGcpIHtcbiAgICB2YXIgYjtcbiAgICBpZiAodm9pZCAwICE9PSAocCA9IG1lbWJlckRlYyh5W21dLCBuID8geVttIC0gMV0gOiB2b2lkIDAsIGEsIHUsIGMsIGksIHMsIG8sIGQsIGwpKSkgYXNzZXJ0VmFsaWRSZXR1cm5WYWx1ZShpLCBwKSwgMCA9PT0gaSA/IGIgPSBwIDogMSA9PT0gaSA/IChiID0gcC5pbml0LCBoID0gcC5nZXQgfHwgZC5nZXQsIHYgPSBwLnNldCB8fCBkLnNldCwgZCA9IHtcbiAgICAgIGdldDogaCxcbiAgICAgIHNldDogdlxuICAgIH0pIDogZCA9IHAsIHZvaWQgMCAhPT0gYiAmJiAodm9pZCAwID09PSBmID8gZiA9IGIgOiBcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIGYgPyBmID0gW2YsIGJdIDogZi5wdXNoKGIpKTtcbiAgfVxuICBpZiAoMCA9PT0gaSB8fCAxID09PSBpKSB7XG4gICAgaWYgKHZvaWQgMCA9PT0gZikgZiA9IGZ1bmN0aW9uIChlLCB0KSB7XG4gICAgICByZXR1cm4gdDtcbiAgICB9O2Vsc2UgaWYgKFwiZnVuY3Rpb25cIiAhPSB0eXBlb2YgZikge1xuICAgICAgdmFyIEkgPSBmO1xuICAgICAgZiA9IGZ1bmN0aW9uIChlLCB0KSB7XG4gICAgICAgIGZvciAodmFyIHIgPSB0LCBuID0gSS5sZW5ndGggLSAxOyBuID49IDA7IG4tLSkgciA9IElbbl0uY2FsbChlLCByKTtcbiAgICAgICAgcmV0dXJuIHI7XG4gICAgICB9O1xuICAgIH0gZWxzZSB7XG4gICAgICB2YXIgdyA9IGY7XG4gICAgICBmID0gZnVuY3Rpb24gKGUsIHQpIHtcbiAgICAgICAgcmV0dXJuIHcuY2FsbChlLCB0KTtcbiAgICAgIH07XG4gICAgfVxuICAgIGUucHVzaChmKTtcbiAgfVxuICAwICE9PSBpICYmICgxID09PSBpID8gKHUuZ2V0ID0gZC5nZXQsIHUuc2V0ID0gZC5zZXQpIDogMiA9PT0gaSA/IHUudmFsdWUgPSBkIDogMyA9PT0gaSA/IHUuZ2V0ID0gZCA6IDQgPT09IGkgJiYgKHUuc2V0ID0gZCksIG8gPyAxID09PSBpID8gKGUucHVzaChmdW5jdGlvbiAoZSwgdCkge1xuICAgIHJldHVybiBkLmdldC5jYWxsKGUsIHQpO1xuICB9KSwgZS5wdXNoKGZ1bmN0aW9uIChlLCB0KSB7XG4gICAgcmV0dXJuIGQuc2V0LmNhbGwoZSwgdCk7XG4gIH0pKSA6IDIgPT09IGkgPyBlLnB1c2goZCkgOiBlLnB1c2goZnVuY3Rpb24gKGUsIHQpIHtcbiAgICByZXR1cm4gZC5jYWxsKGUsIHQpO1xuICB9KSA6IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCBhLCB1KSk7XG59XG5mdW5jdGlvbiBhcHBseU1lbWJlckRlY3MoZSwgdCwgcikge1xuICBmb3IgKHZhciBuLCBhLCBpLCBzID0gW10sIG8gPSBuZXcgTWFwKCksIGMgPSBuZXcgTWFwKCksIGwgPSAwOyBsIDwgdC5sZW5ndGg7IGwrKykge1xuICAgIHZhciB1ID0gdFtsXTtcbiAgICBpZiAoQXJyYXkuaXNBcnJheSh1KSkge1xuICAgICAgdmFyIGYsXG4gICAgICAgIGQsXG4gICAgICAgIHAgPSB1WzFdLFxuICAgICAgICBoID0gdVsyXSxcbiAgICAgICAgdiA9IHUubGVuZ3RoID4gMyxcbiAgICAgICAgeSA9IDE2ICYgcCxcbiAgICAgICAgZyA9ICEhKDggJiBwKSxcbiAgICAgICAgbSA9IHI7XG4gICAgICBpZiAocCAmPSA3LCBnID8gKGYgPSBlLCAwICE9PSBwICYmIChkID0gYSA9IGEgfHwgW10pLCB2ICYmICFpICYmIChpID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgcmV0dXJuIF9jaGVja0luUkhTKHQpID09PSBlO1xuICAgICAgfSksIG0gPSBpKSA6IChmID0gZS5wcm90b3R5cGUsIDAgIT09IHAgJiYgKGQgPSBuID0gbiB8fCBbXSkpLCAwICE9PSBwICYmICF2KSB7XG4gICAgICAgIHZhciBiID0gZyA/IGMgOiBvLFxuICAgICAgICAgIEkgPSBiLmdldChoKSB8fCAwO1xuICAgICAgICBpZiAoITAgPT09IEkgfHwgMyA9PT0gSSAmJiA0ICE9PSBwIHx8IDQgPT09IEkgJiYgMyAhPT0gcCkgdGhyb3cgbmV3IEVycm9yKFwiQXR0ZW1wdGVkIHRvIGRlY29yYXRlIGEgcHVibGljIG1ldGhvZC9hY2Nlc3NvciB0aGF0IGhhcyB0aGUgc2FtZSBuYW1lIGFzIGEgcHJldmlvdXNseSBkZWNvcmF0ZWQgcHVibGljIG1ldGhvZC9hY2Nlc3Nvci4gVGhpcyBpcyBub3QgY3VycmVudGx5IHN1cHBvcnRlZCBieSB0aGUgZGVjb3JhdG9ycyBwbHVnaW4uIFByb3BlcnR5IG5hbWUgd2FzOiBcIiArIGgpO1xuICAgICAgICBiLnNldChoLCAhKCFJICYmIHAgPiAyKSB8fCBwKTtcbiAgICAgIH1cbiAgICAgIGFwcGx5TWVtYmVyRGVjKHMsIGYsIHUsIHksIGgsIHAsIGcsIHYsIGQsIG0pO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcHVzaEluaXRpYWxpemVycyhzLCBuKSwgcHVzaEluaXRpYWxpemVycyhzLCBhKSwgcztcbn1cbmZ1bmN0aW9uIHB1c2hJbml0aWFsaXplcnMoZSwgdCkge1xuICB0ICYmIGUucHVzaChmdW5jdGlvbiAoZSkge1xuICAgIGZvciAodmFyIHIgPSAwOyByIDwgdC5sZW5ndGg7IHIrKykgdFtyXS5jYWxsKGUpO1xuICAgIHJldHVybiBlO1xuICB9KTtcbn1cbmZ1bmN0aW9uIGFwcGx5Q2xhc3NEZWNzKGUsIHQsIHIpIHtcbiAgaWYgKHQubGVuZ3RoKSB7XG4gICAgZm9yICh2YXIgbiA9IFtdLCBhID0gZSwgaSA9IGUubmFtZSwgcyA9IHIgPyAyIDogMSwgbyA9IHQubGVuZ3RoIC0gMTsgbyA+PSAwOyBvIC09IHMpIHtcbiAgICAgIHZhciBjID0ge1xuICAgICAgICB2OiAhMVxuICAgICAgfTtcbiAgICAgIHRyeSB7XG4gICAgICAgIHZhciBsID0gdFtvXS5jYWxsKHIgPyB0W28gLSAxXSA6IHZvaWQgMCwgYSwge1xuICAgICAgICAgIGtpbmQ6IFwiY2xhc3NcIixcbiAgICAgICAgICBuYW1lOiBpLFxuICAgICAgICAgIGFkZEluaXRpYWxpemVyOiBjcmVhdGVBZGRJbml0aWFsaXplck1ldGhvZChuLCBjKVxuICAgICAgICB9KTtcbiAgICAgIH0gZmluYWxseSB7XG4gICAgICAgIGMudiA9ICEwO1xuICAgICAgfVxuICAgICAgdm9pZCAwICE9PSBsICYmIChhc3NlcnRWYWxpZFJldHVyblZhbHVlKDUsIGwpLCBhID0gbCk7XG4gICAgfVxuICAgIHJldHVybiBbYSwgZnVuY3Rpb24gKCkge1xuICAgICAgZm9yICh2YXIgZSA9IDA7IGUgPCBuLmxlbmd0aDsgZSsrKSBuW2VdLmNhbGwoYSk7XG4gICAgfV07XG4gIH1cbn1cbmZ1bmN0aW9uIF9hcHBseURlY3MyMzA1KGUsIHQsIHIsIG4sIGEpIHtcbiAgcmV0dXJuIHtcbiAgICBlOiBhcHBseU1lbWJlckRlY3MoZSwgdCwgYSksXG4gICAgZ2V0IGMoKSB7XG4gICAgICByZXR1cm4gYXBwbHlDbGFzc0RlY3MoZSwgciwgbik7XG4gICAgfVxuICB9O1xufVxuZnVuY3Rpb24gX2FzeW5jR2VuZXJhdG9yRGVsZWdhdGUodCkge1xuICB2YXIgZSA9IHt9LFxuICAgIG4gPSAhMTtcbiAgZnVuY3Rpb24gcHVtcChlLCByKSB7XG4gICAgcmV0dXJuIG4gPSAhMCwgciA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uIChuKSB7XG4gICAgICBuKHRbZV0ocikpO1xuICAgIH0pLCB7XG4gICAgICBkb25lOiAhMSxcbiAgICAgIHZhbHVlOiBuZXcgX092ZXJsb2FkWWllbGQociwgMSlcbiAgICB9O1xuICB9XG4gIHJldHVybiBlW1widW5kZWZpbmVkXCIgIT0gdHlwZW9mIFN5bWJvbCAmJiBTeW1ib2wuaXRlcmF0b3IgfHwgXCJAQGl0ZXJhdG9yXCJdID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB0aGlzO1xuICB9LCBlLm5leHQgPSBmdW5jdGlvbiAodCkge1xuICAgIHJldHVybiBuID8gKG4gPSAhMSwgdCkgOiBwdW1wKFwibmV4dFwiLCB0KTtcbiAgfSwgXCJmdW5jdGlvblwiID09IHR5cGVvZiB0LnRocm93ICYmIChlLnRocm93ID0gZnVuY3Rpb24gKHQpIHtcbiAgICBpZiAobikgdGhyb3cgbiA9ICExLCB0O1xuICAgIHJldHVybiBwdW1wKFwidGhyb3dcIiwgdCk7XG4gIH0pLCBcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIHQucmV0dXJuICYmIChlLnJldHVybiA9IGZ1bmN0aW9uICh0KSB7XG4gICAgcmV0dXJuIG4gPyAobiA9ICExLCB0KSA6IHB1bXAoXCJyZXR1cm5cIiwgdCk7XG4gIH0pLCBlO1xufVxuZnVuY3Rpb24gX2FzeW5jSXRlcmF0b3Iocikge1xuICB2YXIgbixcbiAgICB0LFxuICAgIG8sXG4gICAgZSA9IDI7XG4gIGZvciAoXCJ1bmRlZmluZWRcIiAhPSB0eXBlb2YgU3ltYm9sICYmICh0ID0gU3ltYm9sLmFzeW5jSXRlcmF0b3IsIG8gPSBTeW1ib2wuaXRlcmF0b3IpOyBlLS07KSB7XG4gICAgaWYgKHQgJiYgbnVsbCAhPSAobiA9IHJbdF0pKSByZXR1cm4gbi5jYWxsKHIpO1xuICAgIGlmIChvICYmIG51bGwgIT0gKG4gPSByW29dKSkgcmV0dXJuIG5ldyBBc3luY0Zyb21TeW5jSXRlcmF0b3Iobi5jYWxsKHIpKTtcbiAgICB0ID0gXCJAQGFzeW5jSXRlcmF0b3JcIiwgbyA9IFwiQEBpdGVyYXRvclwiO1xuICB9XG4gIHRocm93IG5ldyBUeXBlRXJyb3IoXCJPYmplY3QgaXMgbm90IGFzeW5jIGl0ZXJhYmxlXCIpO1xufVxuZnVuY3Rpb24gQXN5bmNGcm9tU3luY0l0ZXJhdG9yKHIpIHtcbiAgZnVuY3Rpb24gQXN5bmNGcm9tU3luY0l0ZXJhdG9yQ29udGludWF0aW9uKHIpIHtcbiAgICBpZiAoT2JqZWN0KHIpICE9PSByKSByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IFR5cGVFcnJvcihyICsgXCIgaXMgbm90IGFuIG9iamVjdC5cIikpO1xuICAgIHZhciBuID0gci5kb25lO1xuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoci52YWx1ZSkudGhlbihmdW5jdGlvbiAocikge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdmFsdWU6IHIsXG4gICAgICAgIGRvbmU6IG5cbiAgICAgIH07XG4gICAgfSk7XG4gIH1cbiAgcmV0dXJuIEFzeW5jRnJvbVN5bmNJdGVyYXRvciA9IGZ1bmN0aW9uIChyKSB7XG4gICAgdGhpcy5zID0gciwgdGhpcy5uID0gci5uZXh0O1xuICB9LCBBc3luY0Zyb21TeW5jSXRlcmF0b3IucHJvdG90eXBlID0ge1xuICAgIHM6IG51bGwsXG4gICAgbjogbnVsbCxcbiAgICBuZXh0OiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gQXN5bmNGcm9tU3luY0l0ZXJhdG9yQ29udGludWF0aW9uKHRoaXMubi5hcHBseSh0aGlzLnMsIGFyZ3VtZW50cykpO1xuICAgIH0sXG4gICAgcmV0dXJuOiBmdW5jdGlvbiAocikge1xuICAgICAgdmFyIG4gPSB0aGlzLnMucmV0dXJuO1xuICAgICAgcmV0dXJuIHZvaWQgMCA9PT0gbiA/IFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgIHZhbHVlOiByLFxuICAgICAgICBkb25lOiAhMFxuICAgICAgfSkgOiBBc3luY0Zyb21TeW5jSXRlcmF0b3JDb250aW51YXRpb24obi5hcHBseSh0aGlzLnMsIGFyZ3VtZW50cykpO1xuICAgIH0sXG4gICAgdGhyb3c6IGZ1bmN0aW9uIChyKSB7XG4gICAgICB2YXIgbiA9IHRoaXMucy5yZXR1cm47XG4gICAgICByZXR1cm4gdm9pZCAwID09PSBuID8gUHJvbWlzZS5yZWplY3QocikgOiBBc3luY0Zyb21TeW5jSXRlcmF0b3JDb250aW51YXRpb24obi5hcHBseSh0aGlzLnMsIGFyZ3VtZW50cykpO1xuICAgIH1cbiAgfSwgbmV3IEFzeW5jRnJvbVN5bmNJdGVyYXRvcihyKTtcbn1cbmZ1bmN0aW9uIF9hd2FpdEFzeW5jR2VuZXJhdG9yKGUpIHtcbiAgcmV0dXJuIG5ldyBfT3ZlcmxvYWRZaWVsZChlLCAwKTtcbn1cbmZ1bmN0aW9uIF9jaGVja0luUkhTKGUpIHtcbiAgaWYgKE9iamVjdChlKSAhPT0gZSkgdGhyb3cgVHlwZUVycm9yKFwicmlnaHQtaGFuZCBzaWRlIG9mICdpbicgc2hvdWxkIGJlIGFuIG9iamVjdCwgZ290IFwiICsgKG51bGwgIT09IGUgPyB0eXBlb2YgZSA6IFwibnVsbFwiKSk7XG4gIHJldHVybiBlO1xufVxuZnVuY3Rpb24gX2RlZmluZUFjY2Vzc29yKGUsIHIsIG4sIHQpIHtcbiAgdmFyIGMgPSB7XG4gICAgY29uZmlndXJhYmxlOiAhMCxcbiAgICBlbnVtZXJhYmxlOiAhMFxuICB9O1xuICByZXR1cm4gY1tlXSA9IHQsIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShyLCBuLCBjKTtcbn1cbmZ1bmN0aW9uIGRpc3Bvc2VfU3VwcHJlc3NlZEVycm9yKHIsIGUpIHtcbiAgcmV0dXJuIFwidW5kZWZpbmVkXCIgIT0gdHlwZW9mIFN1cHByZXNzZWRFcnJvciA/IGRpc3Bvc2VfU3VwcHJlc3NlZEVycm9yID0gU3VwcHJlc3NlZEVycm9yIDogKGRpc3Bvc2VfU3VwcHJlc3NlZEVycm9yID0gZnVuY3Rpb24gKHIsIGUpIHtcbiAgICB0aGlzLnN1cHByZXNzZWQgPSByLCB0aGlzLmVycm9yID0gZSwgdGhpcy5zdGFjayA9IG5ldyBFcnJvcigpLnN0YWNrO1xuICB9LCBkaXNwb3NlX1N1cHByZXNzZWRFcnJvci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEVycm9yLnByb3RvdHlwZSwge1xuICAgIGNvbnN0cnVjdG9yOiB7XG4gICAgICB2YWx1ZTogZGlzcG9zZV9TdXBwcmVzc2VkRXJyb3IsXG4gICAgICB3cml0YWJsZTogITAsXG4gICAgICBjb25maWd1cmFibGU6ICEwXG4gICAgfVxuICB9KSksIG5ldyBkaXNwb3NlX1N1cHByZXNzZWRFcnJvcihyLCBlKTtcbn1cbmZ1bmN0aW9uIF9kaXNwb3NlKHIsIGUsIHMpIHtcbiAgZnVuY3Rpb24gbmV4dCgpIHtcbiAgICBmb3IgKDsgci5sZW5ndGggPiAwOykgdHJ5IHtcbiAgICAgIHZhciBvID0gci5wb3AoKSxcbiAgICAgICAgcCA9IG8uZC5jYWxsKG8udik7XG4gICAgICBpZiAoby5hKSByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHApLnRoZW4obmV4dCwgZXJyKTtcbiAgICB9IGNhdGNoIChyKSB7XG4gICAgICByZXR1cm4gZXJyKHIpO1xuICAgIH1cbiAgICBpZiAocykgdGhyb3cgZTtcbiAgfVxuICBmdW5jdGlvbiBlcnIocikge1xuICAgIHJldHVybiBlID0gcyA/IG5ldyBkaXNwb3NlX1N1cHByZXNzZWRFcnJvcihyLCBlKSA6IHIsIHMgPSAhMCwgbmV4dCgpO1xuICB9XG4gIHJldHVybiBuZXh0KCk7XG59XG5mdW5jdGlvbiBfaXRlcmFibGVUb0FycmF5TGltaXQociwgbCkge1xuICB2YXIgdCA9IG51bGwgPT0gciA/IG51bGwgOiBcInVuZGVmaW5lZFwiICE9IHR5cGVvZiBTeW1ib2wgJiYgcltTeW1ib2wuaXRlcmF0b3JdIHx8IHJbXCJAQGl0ZXJhdG9yXCJdO1xuICBpZiAobnVsbCAhPSB0KSB7XG4gICAgdmFyIGUsXG4gICAgICBuLFxuICAgICAgaSxcbiAgICAgIHUsXG4gICAgICBhID0gW10sXG4gICAgICBmID0gITAsXG4gICAgICBvID0gITE7XG4gICAgdHJ5IHtcbiAgICAgIGlmIChpID0gKHQgPSB0LmNhbGwocikpLm5leHQsIDAgPT09IGwpIHtcbiAgICAgICAgaWYgKE9iamVjdCh0KSAhPT0gdCkgcmV0dXJuO1xuICAgICAgICBmID0gITE7XG4gICAgICB9IGVsc2UgZm9yICg7ICEoZiA9IChlID0gaS5jYWxsKHQpKS5kb25lKSAmJiAoYS5wdXNoKGUudmFsdWUpLCBhLmxlbmd0aCAhPT0gbCk7IGYgPSAhMCk7XG4gICAgfSBjYXRjaCAocikge1xuICAgICAgbyA9ICEwLCBuID0gcjtcbiAgICB9IGZpbmFsbHkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgaWYgKCFmICYmIG51bGwgIT0gdC5yZXR1cm4gJiYgKHUgPSB0LnJldHVybigpLCBPYmplY3QodSkgIT09IHUpKSByZXR1cm47XG4gICAgICB9IGZpbmFsbHkge1xuICAgICAgICBpZiAobykgdGhyb3cgbjtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGE7XG4gIH1cbn1cbmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXlMaW1pdExvb3NlKGUsIHIpIHtcbiAgdmFyIHQgPSBlICYmIChcInVuZGVmaW5lZFwiICE9IHR5cGVvZiBTeW1ib2wgJiYgZVtTeW1ib2wuaXRlcmF0b3JdIHx8IGVbXCJAQGl0ZXJhdG9yXCJdKTtcbiAgaWYgKG51bGwgIT0gdCkge1xuICAgIHZhciBvLFxuICAgICAgbCA9IFtdO1xuICAgIGZvciAodCA9IHQuY2FsbChlKTsgZS5sZW5ndGggPCByICYmICEobyA9IHQubmV4dCgpKS5kb25lOykgbC5wdXNoKG8udmFsdWUpO1xuICAgIHJldHVybiBsO1xuICB9XG59XG52YXIgUkVBQ1RfRUxFTUVOVF9UWVBFO1xuZnVuY3Rpb24gX2pzeChlLCByLCBFLCBsKSB7XG4gIFJFQUNUX0VMRU1FTlRfVFlQRSB8fCAoUkVBQ1RfRUxFTUVOVF9UWVBFID0gXCJmdW5jdGlvblwiID09IHR5cGVvZiBTeW1ib2wgJiYgU3ltYm9sLmZvciAmJiBTeW1ib2wuZm9yKFwicmVhY3QuZWxlbWVudFwiKSB8fCA2MDEwMyk7XG4gIHZhciBvID0gZSAmJiBlLmRlZmF1bHRQcm9wcyxcbiAgICBuID0gYXJndW1lbnRzLmxlbmd0aCAtIDM7XG4gIGlmIChyIHx8IDAgPT09IG4gfHwgKHIgPSB7XG4gICAgY2hpbGRyZW46IHZvaWQgMFxuICB9KSwgMSA9PT0gbikgci5jaGlsZHJlbiA9IGw7ZWxzZSBpZiAobiA+IDEpIHtcbiAgICBmb3IgKHZhciB0ID0gbmV3IEFycmF5KG4pLCBmID0gMDsgZiA8IG47IGYrKykgdFtmXSA9IGFyZ3VtZW50c1tmICsgM107XG4gICAgci5jaGlsZHJlbiA9IHQ7XG4gIH1cbiAgaWYgKHIgJiYgbykgZm9yICh2YXIgaSBpbiBvKSB2b2lkIDAgPT09IHJbaV0gJiYgKHJbaV0gPSBvW2ldKTtlbHNlIHIgfHwgKHIgPSBvIHx8IHt9KTtcbiAgcmV0dXJuIHtcbiAgICAkJHR5cGVvZjogUkVBQ1RfRUxFTUVOVF9UWVBFLFxuICAgIHR5cGU6IGUsXG4gICAga2V5OiB2b2lkIDAgPT09IEUgPyBudWxsIDogXCJcIiArIEUsXG4gICAgcmVmOiBudWxsLFxuICAgIHByb3BzOiByLFxuICAgIF9vd25lcjogbnVsbFxuICB9O1xufVxuZnVuY3Rpb24gb3duS2V5cyhlLCByKSB7XG4gIHZhciB0ID0gT2JqZWN0LmtleXMoZSk7XG4gIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7XG4gICAgdmFyIG8gPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKGUpO1xuICAgIHIgJiYgKG8gPSBvLmZpbHRlcihmdW5jdGlvbiAocikge1xuICAgICAgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoZSwgcikuZW51bWVyYWJsZTtcbiAgICB9KSksIHQucHVzaC5hcHBseSh0LCBvKTtcbiAgfVxuICByZXR1cm4gdDtcbn1cbmZ1bmN0aW9uIF9vYmplY3RTcHJlYWQyKGUpIHtcbiAgZm9yICh2YXIgciA9IDE7IHIgPCBhcmd1bWVudHMubGVuZ3RoOyByKyspIHtcbiAgICB2YXIgdCA9IG51bGwgIT0gYXJndW1lbnRzW3JdID8gYXJndW1lbnRzW3JdIDoge307XG4gICAgciAlIDIgPyBvd25LZXlzKE9iamVjdCh0KSwgITApLmZvckVhY2goZnVuY3Rpb24gKHIpIHtcbiAgICAgIF9kZWZpbmVQcm9wZXJ0eShlLCByLCB0W3JdKTtcbiAgICB9KSA6IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzID8gT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnModCkpIDogb3duS2V5cyhPYmplY3QodCkpLmZvckVhY2goZnVuY3Rpb24gKHIpIHtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLCByLCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHQsIHIpKTtcbiAgICB9KTtcbiAgfVxuICByZXR1cm4gZTtcbn1cbmZ1bmN0aW9uIF9yZWdlbmVyYXRvclJ1bnRpbWUoKSB7XG4gIFwidXNlIHN0cmljdFwiOyAvKiEgcmVnZW5lcmF0b3ItcnVudGltZSAtLSBDb3B5cmlnaHQgKGMpIDIwMTQtcHJlc2VudCwgRmFjZWJvb2ssIEluYy4gLS0gbGljZW5zZSAoTUlUKTogaHR0cHM6Ly9naXRodWIuY29tL2ZhY2Vib29rL3JlZ2VuZXJhdG9yL2Jsb2IvbWFpbi9MSUNFTlNFICovXG4gIF9yZWdlbmVyYXRvclJ1bnRpbWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIGU7XG4gIH07XG4gIHZhciB0LFxuICAgIGUgPSB7fSxcbiAgICByID0gT2JqZWN0LnByb3RvdHlwZSxcbiAgICBuID0gci5oYXNPd25Qcm9wZXJ0eSxcbiAgICBvID0gT2JqZWN0LmRlZmluZVByb3BlcnR5IHx8IGZ1bmN0aW9uICh0LCBlLCByKSB7XG4gICAgICB0W2VdID0gci52YWx1ZTtcbiAgICB9LFxuICAgIGkgPSBcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIFN5bWJvbCA/IFN5bWJvbCA6IHt9LFxuICAgIGEgPSBpLml0ZXJhdG9yIHx8IFwiQEBpdGVyYXRvclwiLFxuICAgIGMgPSBpLmFzeW5jSXRlcmF0b3IgfHwgXCJAQGFzeW5jSXRlcmF0b3JcIixcbiAgICB1ID0gaS50b1N0cmluZ1RhZyB8fCBcIkBAdG9TdHJpbmdUYWdcIjtcbiAgZnVuY3Rpb24gZGVmaW5lKHQsIGUsIHIpIHtcbiAgICByZXR1cm4gT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsIGUsIHtcbiAgICAgIHZhbHVlOiByLFxuICAgICAgZW51bWVyYWJsZTogITAsXG4gICAgICBjb25maWd1cmFibGU6ICEwLFxuICAgICAgd3JpdGFibGU6ICEwXG4gICAgfSksIHRbZV07XG4gIH1cbiAgdHJ5IHtcbiAgICBkZWZpbmUoe30sIFwiXCIpO1xuICB9IGNhdGNoICh0KSB7XG4gICAgZGVmaW5lID0gZnVuY3Rpb24gKHQsIGUsIHIpIHtcbiAgICAgIHJldHVybiB0W2VdID0gcjtcbiAgICB9O1xuICB9XG4gIGZ1bmN0aW9uIHdyYXAodCwgZSwgciwgbikge1xuICAgIHZhciBpID0gZSAmJiBlLnByb3RvdHlwZSBpbnN0YW5jZW9mIEdlbmVyYXRvciA/IGUgOiBHZW5lcmF0b3IsXG4gICAgICBhID0gT2JqZWN0LmNyZWF0ZShpLnByb3RvdHlwZSksXG4gICAgICBjID0gbmV3IENvbnRleHQobiB8fCBbXSk7XG4gICAgcmV0dXJuIG8oYSwgXCJfaW52b2tlXCIsIHtcbiAgICAgIHZhbHVlOiBtYWtlSW52b2tlTWV0aG9kKHQsIHIsIGMpXG4gICAgfSksIGE7XG4gIH1cbiAgZnVuY3Rpb24gdHJ5Q2F0Y2godCwgZSwgcikge1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB0eXBlOiBcIm5vcm1hbFwiLFxuICAgICAgICBhcmc6IHQuY2FsbChlLCByKVxuICAgICAgfTtcbiAgICB9IGNhdGNoICh0KSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB0eXBlOiBcInRocm93XCIsXG4gICAgICAgIGFyZzogdFxuICAgICAgfTtcbiAgICB9XG4gIH1cbiAgZS53cmFwID0gd3JhcDtcbiAgdmFyIGggPSBcInN1c3BlbmRlZFN0YXJ0XCIsXG4gICAgbCA9IFwic3VzcGVuZGVkWWllbGRcIixcbiAgICBmID0gXCJleGVjdXRpbmdcIixcbiAgICBzID0gXCJjb21wbGV0ZWRcIixcbiAgICB5ID0ge307XG4gIGZ1bmN0aW9uIEdlbmVyYXRvcigpIHt9XG4gIGZ1bmN0aW9uIEdlbmVyYXRvckZ1bmN0aW9uKCkge31cbiAgZnVuY3Rpb24gR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGUoKSB7fVxuICB2YXIgcCA9IHt9O1xuICBkZWZpbmUocCwgYSwgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB0aGlzO1xuICB9KTtcbiAgdmFyIGQgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YsXG4gICAgdiA9IGQgJiYgZChkKHZhbHVlcyhbXSkpKTtcbiAgdiAmJiB2ICE9PSByICYmIG4uY2FsbCh2LCBhKSAmJiAocCA9IHYpO1xuICB2YXIgZyA9IEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlLnByb3RvdHlwZSA9IEdlbmVyYXRvci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHApO1xuICBmdW5jdGlvbiBkZWZpbmVJdGVyYXRvck1ldGhvZHModCkge1xuICAgIFtcIm5leHRcIiwgXCJ0aHJvd1wiLCBcInJldHVyblwiXS5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7XG4gICAgICBkZWZpbmUodCwgZSwgZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2ludm9rZShlLCB0KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG4gIGZ1bmN0aW9uIEFzeW5jSXRlcmF0b3IodCwgZSkge1xuICAgIGZ1bmN0aW9uIGludm9rZShyLCBvLCBpLCBhKSB7XG4gICAgICB2YXIgYyA9IHRyeUNhdGNoKHRbcl0sIHQsIG8pO1xuICAgICAgaWYgKFwidGhyb3dcIiAhPT0gYy50eXBlKSB7XG4gICAgICAgIHZhciB1ID0gYy5hcmcsXG4gICAgICAgICAgaCA9IHUudmFsdWU7XG4gICAgICAgIHJldHVybiBoICYmIFwib2JqZWN0XCIgPT0gdHlwZW9mIGggJiYgbi5jYWxsKGgsIFwiX19hd2FpdFwiKSA/IGUucmVzb2x2ZShoLl9fYXdhaXQpLnRoZW4oZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgICBpbnZva2UoXCJuZXh0XCIsIHQsIGksIGEpO1xuICAgICAgICB9LCBmdW5jdGlvbiAodCkge1xuICAgICAgICAgIGludm9rZShcInRocm93XCIsIHQsIGksIGEpO1xuICAgICAgICB9KSA6IGUucmVzb2x2ZShoKS50aGVuKGZ1bmN0aW9uICh0KSB7XG4gICAgICAgICAgdS52YWx1ZSA9IHQsIGkodSk7XG4gICAgICAgIH0sIGZ1bmN0aW9uICh0KSB7XG4gICAgICAgICAgcmV0dXJuIGludm9rZShcInRocm93XCIsIHQsIGksIGEpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGEoYy5hcmcpO1xuICAgIH1cbiAgICB2YXIgcjtcbiAgICBvKHRoaXMsIFwiX2ludm9rZVwiLCB7XG4gICAgICB2YWx1ZTogZnVuY3Rpb24gKHQsIG4pIHtcbiAgICAgICAgZnVuY3Rpb24gY2FsbEludm9rZVdpdGhNZXRob2RBbmRBcmcoKSB7XG4gICAgICAgICAgcmV0dXJuIG5ldyBlKGZ1bmN0aW9uIChlLCByKSB7XG4gICAgICAgICAgICBpbnZva2UodCwgbiwgZSwgcik7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHIgPSByID8gci50aGVuKGNhbGxJbnZva2VXaXRoTWV0aG9kQW5kQXJnLCBjYWxsSW52b2tlV2l0aE1ldGhvZEFuZEFyZykgOiBjYWxsSW52b2tlV2l0aE1ldGhvZEFuZEFyZygpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG4gIGZ1bmN0aW9uIG1ha2VJbnZva2VNZXRob2QoZSwgciwgbikge1xuICAgIHZhciBvID0gaDtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGksIGEpIHtcbiAgICAgIGlmIChvID09PSBmKSB0aHJvdyBuZXcgRXJyb3IoXCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBydW5uaW5nXCIpO1xuICAgICAgaWYgKG8gPT09IHMpIHtcbiAgICAgICAgaWYgKFwidGhyb3dcIiA9PT0gaSkgdGhyb3cgYTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB2YWx1ZTogdCxcbiAgICAgICAgICBkb25lOiAhMFxuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgZm9yIChuLm1ldGhvZCA9IGksIG4uYXJnID0gYTs7KSB7XG4gICAgICAgIHZhciBjID0gbi5kZWxlZ2F0ZTtcbiAgICAgICAgaWYgKGMpIHtcbiAgICAgICAgICB2YXIgdSA9IG1heWJlSW52b2tlRGVsZWdhdGUoYywgbik7XG4gICAgICAgICAgaWYgKHUpIHtcbiAgICAgICAgICAgIGlmICh1ID09PSB5KSBjb250aW51ZTtcbiAgICAgICAgICAgIHJldHVybiB1O1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoXCJuZXh0XCIgPT09IG4ubWV0aG9kKSBuLnNlbnQgPSBuLl9zZW50ID0gbi5hcmc7ZWxzZSBpZiAoXCJ0aHJvd1wiID09PSBuLm1ldGhvZCkge1xuICAgICAgICAgIGlmIChvID09PSBoKSB0aHJvdyBvID0gcywgbi5hcmc7XG4gICAgICAgICAgbi5kaXNwYXRjaEV4Y2VwdGlvbihuLmFyZyk7XG4gICAgICAgIH0gZWxzZSBcInJldHVyblwiID09PSBuLm1ldGhvZCAmJiBuLmFicnVwdChcInJldHVyblwiLCBuLmFyZyk7XG4gICAgICAgIG8gPSBmO1xuICAgICAgICB2YXIgcCA9IHRyeUNhdGNoKGUsIHIsIG4pO1xuICAgICAgICBpZiAoXCJub3JtYWxcIiA9PT0gcC50eXBlKSB7XG4gICAgICAgICAgaWYgKG8gPSBuLmRvbmUgPyBzIDogbCwgcC5hcmcgPT09IHkpIGNvbnRpbnVlO1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB2YWx1ZTogcC5hcmcsXG4gICAgICAgICAgICBkb25lOiBuLmRvbmVcbiAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIFwidGhyb3dcIiA9PT0gcC50eXBlICYmIChvID0gcywgbi5tZXRob2QgPSBcInRocm93XCIsIG4uYXJnID0gcC5hcmcpO1xuICAgICAgfVxuICAgIH07XG4gIH1cbiAgZnVuY3Rpb24gbWF5YmVJbnZva2VEZWxlZ2F0ZShlLCByKSB7XG4gICAgdmFyIG4gPSByLm1ldGhvZCxcbiAgICAgIG8gPSBlLml0ZXJhdG9yW25dO1xuICAgIGlmIChvID09PSB0KSByZXR1cm4gci5kZWxlZ2F0ZSA9IG51bGwsIFwidGhyb3dcIiA9PT0gbiAmJiBlLml0ZXJhdG9yLnJldHVybiAmJiAoci5tZXRob2QgPSBcInJldHVyblwiLCByLmFyZyA9IHQsIG1heWJlSW52b2tlRGVsZWdhdGUoZSwgciksIFwidGhyb3dcIiA9PT0gci5tZXRob2QpIHx8IFwicmV0dXJuXCIgIT09IG4gJiYgKHIubWV0aG9kID0gXCJ0aHJvd1wiLCByLmFyZyA9IG5ldyBUeXBlRXJyb3IoXCJUaGUgaXRlcmF0b3IgZG9lcyBub3QgcHJvdmlkZSBhICdcIiArIG4gKyBcIicgbWV0aG9kXCIpKSwgeTtcbiAgICB2YXIgaSA9IHRyeUNhdGNoKG8sIGUuaXRlcmF0b3IsIHIuYXJnKTtcbiAgICBpZiAoXCJ0aHJvd1wiID09PSBpLnR5cGUpIHJldHVybiByLm1ldGhvZCA9IFwidGhyb3dcIiwgci5hcmcgPSBpLmFyZywgci5kZWxlZ2F0ZSA9IG51bGwsIHk7XG4gICAgdmFyIGEgPSBpLmFyZztcbiAgICByZXR1cm4gYSA/IGEuZG9uZSA/IChyW2UucmVzdWx0TmFtZV0gPSBhLnZhbHVlLCByLm5leHQgPSBlLm5leHRMb2MsIFwicmV0dXJuXCIgIT09IHIubWV0aG9kICYmIChyLm1ldGhvZCA9IFwibmV4dFwiLCByLmFyZyA9IHQpLCByLmRlbGVnYXRlID0gbnVsbCwgeSkgOiBhIDogKHIubWV0aG9kID0gXCJ0aHJvd1wiLCByLmFyZyA9IG5ldyBUeXBlRXJyb3IoXCJpdGVyYXRvciByZXN1bHQgaXMgbm90IGFuIG9iamVjdFwiKSwgci5kZWxlZ2F0ZSA9IG51bGwsIHkpO1xuICB9XG4gIGZ1bmN0aW9uIHB1c2hUcnlFbnRyeSh0KSB7XG4gICAgdmFyIGUgPSB7XG4gICAgICB0cnlMb2M6IHRbMF1cbiAgICB9O1xuICAgIDEgaW4gdCAmJiAoZS5jYXRjaExvYyA9IHRbMV0pLCAyIGluIHQgJiYgKGUuZmluYWxseUxvYyA9IHRbMl0sIGUuYWZ0ZXJMb2MgPSB0WzNdKSwgdGhpcy50cnlFbnRyaWVzLnB1c2goZSk7XG4gIH1cbiAgZnVuY3Rpb24gcmVzZXRUcnlFbnRyeSh0KSB7XG4gICAgdmFyIGUgPSB0LmNvbXBsZXRpb24gfHwge307XG4gICAgZS50eXBlID0gXCJub3JtYWxcIiwgZGVsZXRlIGUuYXJnLCB0LmNvbXBsZXRpb24gPSBlO1xuICB9XG4gIGZ1bmN0aW9uIENvbnRleHQodCkge1xuICAgIHRoaXMudHJ5RW50cmllcyA9IFt7XG4gICAgICB0cnlMb2M6IFwicm9vdFwiXG4gICAgfV0sIHQuZm9yRWFjaChwdXNoVHJ5RW50cnksIHRoaXMpLCB0aGlzLnJlc2V0KCEwKTtcbiAgfVxuICBmdW5jdGlvbiB2YWx1ZXMoZSkge1xuICAgIGlmIChlIHx8IFwiXCIgPT09IGUpIHtcbiAgICAgIHZhciByID0gZVthXTtcbiAgICAgIGlmIChyKSByZXR1cm4gci5jYWxsKGUpO1xuICAgICAgaWYgKFwiZnVuY3Rpb25cIiA9PSB0eXBlb2YgZS5uZXh0KSByZXR1cm4gZTtcbiAgICAgIGlmICghaXNOYU4oZS5sZW5ndGgpKSB7XG4gICAgICAgIHZhciBvID0gLTEsXG4gICAgICAgICAgaSA9IGZ1bmN0aW9uIG5leHQoKSB7XG4gICAgICAgICAgICBmb3IgKDsgKytvIDwgZS5sZW5ndGg7KSBpZiAobi5jYWxsKGUsIG8pKSByZXR1cm4gbmV4dC52YWx1ZSA9IGVbb10sIG5leHQuZG9uZSA9ICExLCBuZXh0O1xuICAgICAgICAgICAgcmV0dXJuIG5leHQudmFsdWUgPSB0LCBuZXh0LmRvbmUgPSAhMCwgbmV4dDtcbiAgICAgICAgICB9O1xuICAgICAgICByZXR1cm4gaS5uZXh0ID0gaTtcbiAgICAgIH1cbiAgICB9XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcih0eXBlb2YgZSArIFwiIGlzIG5vdCBpdGVyYWJsZVwiKTtcbiAgfVxuICByZXR1cm4gR2VuZXJhdG9yRnVuY3Rpb24ucHJvdG90eXBlID0gR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGUsIG8oZywgXCJjb25zdHJ1Y3RvclwiLCB7XG4gICAgdmFsdWU6IEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlLFxuICAgIGNvbmZpZ3VyYWJsZTogITBcbiAgfSksIG8oR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGUsIFwiY29uc3RydWN0b3JcIiwge1xuICAgIHZhbHVlOiBHZW5lcmF0b3JGdW5jdGlvbixcbiAgICBjb25maWd1cmFibGU6ICEwXG4gIH0pLCBHZW5lcmF0b3JGdW5jdGlvbi5kaXNwbGF5TmFtZSA9IGRlZmluZShHZW5lcmF0b3JGdW5jdGlvblByb3RvdHlwZSwgdSwgXCJHZW5lcmF0b3JGdW5jdGlvblwiKSwgZS5pc0dlbmVyYXRvckZ1bmN0aW9uID0gZnVuY3Rpb24gKHQpIHtcbiAgICB2YXIgZSA9IFwiZnVuY3Rpb25cIiA9PSB0eXBlb2YgdCAmJiB0LmNvbnN0cnVjdG9yO1xuICAgIHJldHVybiAhIWUgJiYgKGUgPT09IEdlbmVyYXRvckZ1bmN0aW9uIHx8IFwiR2VuZXJhdG9yRnVuY3Rpb25cIiA9PT0gKGUuZGlzcGxheU5hbWUgfHwgZS5uYW1lKSk7XG4gIH0sIGUubWFyayA9IGZ1bmN0aW9uICh0KSB7XG4gICAgcmV0dXJuIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZih0LCBHZW5lcmF0b3JGdW5jdGlvblByb3RvdHlwZSkgOiAodC5fX3Byb3RvX18gPSBHZW5lcmF0b3JGdW5jdGlvblByb3RvdHlwZSwgZGVmaW5lKHQsIHUsIFwiR2VuZXJhdG9yRnVuY3Rpb25cIikpLCB0LnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoZyksIHQ7XG4gIH0sIGUuYXdyYXAgPSBmdW5jdGlvbiAodCkge1xuICAgIHJldHVybiB7XG4gICAgICBfX2F3YWl0OiB0XG4gICAgfTtcbiAgfSwgZGVmaW5lSXRlcmF0b3JNZXRob2RzKEFzeW5jSXRlcmF0b3IucHJvdG90eXBlKSwgZGVmaW5lKEFzeW5jSXRlcmF0b3IucHJvdG90eXBlLCBjLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH0pLCBlLkFzeW5jSXRlcmF0b3IgPSBBc3luY0l0ZXJhdG9yLCBlLmFzeW5jID0gZnVuY3Rpb24gKHQsIHIsIG4sIG8sIGkpIHtcbiAgICB2b2lkIDAgPT09IGkgJiYgKGkgPSBQcm9taXNlKTtcbiAgICB2YXIgYSA9IG5ldyBBc3luY0l0ZXJhdG9yKHdyYXAodCwgciwgbiwgbyksIGkpO1xuICAgIHJldHVybiBlLmlzR2VuZXJhdG9yRnVuY3Rpb24ocikgPyBhIDogYS5uZXh0KCkudGhlbihmdW5jdGlvbiAodCkge1xuICAgICAgcmV0dXJuIHQuZG9uZSA/IHQudmFsdWUgOiBhLm5leHQoKTtcbiAgICB9KTtcbiAgfSwgZGVmaW5lSXRlcmF0b3JNZXRob2RzKGcpLCBkZWZpbmUoZywgdSwgXCJHZW5lcmF0b3JcIiksIGRlZmluZShnLCBhLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH0pLCBkZWZpbmUoZywgXCJ0b1N0cmluZ1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIFwiW29iamVjdCBHZW5lcmF0b3JdXCI7XG4gIH0pLCBlLmtleXMgPSBmdW5jdGlvbiAodCkge1xuICAgIHZhciBlID0gT2JqZWN0KHQpLFxuICAgICAgciA9IFtdO1xuICAgIGZvciAodmFyIG4gaW4gZSkgci5wdXNoKG4pO1xuICAgIHJldHVybiByLnJldmVyc2UoKSwgZnVuY3Rpb24gbmV4dCgpIHtcbiAgICAgIGZvciAoOyByLmxlbmd0aDspIHtcbiAgICAgICAgdmFyIHQgPSByLnBvcCgpO1xuICAgICAgICBpZiAodCBpbiBlKSByZXR1cm4gbmV4dC52YWx1ZSA9IHQsIG5leHQuZG9uZSA9ICExLCBuZXh0O1xuICAgICAgfVxuICAgICAgcmV0dXJuIG5leHQuZG9uZSA9ICEwLCBuZXh0O1xuICAgIH07XG4gIH0sIGUudmFsdWVzID0gdmFsdWVzLCBDb250ZXh0LnByb3RvdHlwZSA9IHtcbiAgICBjb25zdHJ1Y3RvcjogQ29udGV4dCxcbiAgICByZXNldDogZnVuY3Rpb24gKGUpIHtcbiAgICAgIGlmICh0aGlzLnByZXYgPSAwLCB0aGlzLm5leHQgPSAwLCB0aGlzLnNlbnQgPSB0aGlzLl9zZW50ID0gdCwgdGhpcy5kb25lID0gITEsIHRoaXMuZGVsZWdhdGUgPSBudWxsLCB0aGlzLm1ldGhvZCA9IFwibmV4dFwiLCB0aGlzLmFyZyA9IHQsIHRoaXMudHJ5RW50cmllcy5mb3JFYWNoKHJlc2V0VHJ5RW50cnkpLCAhZSkgZm9yICh2YXIgciBpbiB0aGlzKSBcInRcIiA9PT0gci5jaGFyQXQoMCkgJiYgbi5jYWxsKHRoaXMsIHIpICYmICFpc05hTigrci5zbGljZSgxKSkgJiYgKHRoaXNbcl0gPSB0KTtcbiAgICB9LFxuICAgIHN0b3A6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuZG9uZSA9ICEwO1xuICAgICAgdmFyIHQgPSB0aGlzLnRyeUVudHJpZXNbMF0uY29tcGxldGlvbjtcbiAgICAgIGlmIChcInRocm93XCIgPT09IHQudHlwZSkgdGhyb3cgdC5hcmc7XG4gICAgICByZXR1cm4gdGhpcy5ydmFsO1xuICAgIH0sXG4gICAgZGlzcGF0Y2hFeGNlcHRpb246IGZ1bmN0aW9uIChlKSB7XG4gICAgICBpZiAodGhpcy5kb25lKSB0aHJvdyBlO1xuICAgICAgdmFyIHIgPSB0aGlzO1xuICAgICAgZnVuY3Rpb24gaGFuZGxlKG4sIG8pIHtcbiAgICAgICAgcmV0dXJuIGEudHlwZSA9IFwidGhyb3dcIiwgYS5hcmcgPSBlLCByLm5leHQgPSBuLCBvICYmIChyLm1ldGhvZCA9IFwibmV4dFwiLCByLmFyZyA9IHQpLCAhIW87XG4gICAgICB9XG4gICAgICBmb3IgKHZhciBvID0gdGhpcy50cnlFbnRyaWVzLmxlbmd0aCAtIDE7IG8gPj0gMDsgLS1vKSB7XG4gICAgICAgIHZhciBpID0gdGhpcy50cnlFbnRyaWVzW29dLFxuICAgICAgICAgIGEgPSBpLmNvbXBsZXRpb247XG4gICAgICAgIGlmIChcInJvb3RcIiA9PT0gaS50cnlMb2MpIHJldHVybiBoYW5kbGUoXCJlbmRcIik7XG4gICAgICAgIGlmIChpLnRyeUxvYyA8PSB0aGlzLnByZXYpIHtcbiAgICAgICAgICB2YXIgYyA9IG4uY2FsbChpLCBcImNhdGNoTG9jXCIpLFxuICAgICAgICAgICAgdSA9IG4uY2FsbChpLCBcImZpbmFsbHlMb2NcIik7XG4gICAgICAgICAgaWYgKGMgJiYgdSkge1xuICAgICAgICAgICAgaWYgKHRoaXMucHJldiA8IGkuY2F0Y2hMb2MpIHJldHVybiBoYW5kbGUoaS5jYXRjaExvYywgITApO1xuICAgICAgICAgICAgaWYgKHRoaXMucHJldiA8IGkuZmluYWxseUxvYykgcmV0dXJuIGhhbmRsZShpLmZpbmFsbHlMb2MpO1xuICAgICAgICAgIH0gZWxzZSBpZiAoYykge1xuICAgICAgICAgICAgaWYgKHRoaXMucHJldiA8IGkuY2F0Y2hMb2MpIHJldHVybiBoYW5kbGUoaS5jYXRjaExvYywgITApO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAoIXUpIHRocm93IG5ldyBFcnJvcihcInRyeSBzdGF0ZW1lbnQgd2l0aG91dCBjYXRjaCBvciBmaW5hbGx5XCIpO1xuICAgICAgICAgICAgaWYgKHRoaXMucHJldiA8IGkuZmluYWxseUxvYykgcmV0dXJuIGhhbmRsZShpLmZpbmFsbHlMb2MpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sXG4gICAgYWJydXB0OiBmdW5jdGlvbiAodCwgZSkge1xuICAgICAgZm9yICh2YXIgciA9IHRoaXMudHJ5RW50cmllcy5sZW5ndGggLSAxOyByID49IDA7IC0tcikge1xuICAgICAgICB2YXIgbyA9IHRoaXMudHJ5RW50cmllc1tyXTtcbiAgICAgICAgaWYgKG8udHJ5TG9jIDw9IHRoaXMucHJldiAmJiBuLmNhbGwobywgXCJmaW5hbGx5TG9jXCIpICYmIHRoaXMucHJldiA8IG8uZmluYWxseUxvYykge1xuICAgICAgICAgIHZhciBpID0gbztcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaSAmJiAoXCJicmVha1wiID09PSB0IHx8IFwiY29udGludWVcIiA9PT0gdCkgJiYgaS50cnlMb2MgPD0gZSAmJiBlIDw9IGkuZmluYWxseUxvYyAmJiAoaSA9IG51bGwpO1xuICAgICAgdmFyIGEgPSBpID8gaS5jb21wbGV0aW9uIDoge307XG4gICAgICByZXR1cm4gYS50eXBlID0gdCwgYS5hcmcgPSBlLCBpID8gKHRoaXMubWV0aG9kID0gXCJuZXh0XCIsIHRoaXMubmV4dCA9IGkuZmluYWxseUxvYywgeSkgOiB0aGlzLmNvbXBsZXRlKGEpO1xuICAgIH0sXG4gICAgY29tcGxldGU6IGZ1bmN0aW9uICh0LCBlKSB7XG4gICAgICBpZiAoXCJ0aHJvd1wiID09PSB0LnR5cGUpIHRocm93IHQuYXJnO1xuICAgICAgcmV0dXJuIFwiYnJlYWtcIiA9PT0gdC50eXBlIHx8IFwiY29udGludWVcIiA9PT0gdC50eXBlID8gdGhpcy5uZXh0ID0gdC5hcmcgOiBcInJldHVyblwiID09PSB0LnR5cGUgPyAodGhpcy5ydmFsID0gdGhpcy5hcmcgPSB0LmFyZywgdGhpcy5tZXRob2QgPSBcInJldHVyblwiLCB0aGlzLm5leHQgPSBcImVuZFwiKSA6IFwibm9ybWFsXCIgPT09IHQudHlwZSAmJiBlICYmICh0aGlzLm5leHQgPSBlKSwgeTtcbiAgICB9LFxuICAgIGZpbmlzaDogZnVuY3Rpb24gKHQpIHtcbiAgICAgIGZvciAodmFyIGUgPSB0aGlzLnRyeUVudHJpZXMubGVuZ3RoIC0gMTsgZSA+PSAwOyAtLWUpIHtcbiAgICAgICAgdmFyIHIgPSB0aGlzLnRyeUVudHJpZXNbZV07XG4gICAgICAgIGlmIChyLmZpbmFsbHlMb2MgPT09IHQpIHJldHVybiB0aGlzLmNvbXBsZXRlKHIuY29tcGxldGlvbiwgci5hZnRlckxvYyksIHJlc2V0VHJ5RW50cnkociksIHk7XG4gICAgICB9XG4gICAgfSxcbiAgICBjYXRjaDogZnVuY3Rpb24gKHQpIHtcbiAgICAgIGZvciAodmFyIGUgPSB0aGlzLnRyeUVudHJpZXMubGVuZ3RoIC0gMTsgZSA+PSAwOyAtLWUpIHtcbiAgICAgICAgdmFyIHIgPSB0aGlzLnRyeUVudHJpZXNbZV07XG4gICAgICAgIGlmIChyLnRyeUxvYyA9PT0gdCkge1xuICAgICAgICAgIHZhciBuID0gci5jb21wbGV0aW9uO1xuICAgICAgICAgIGlmIChcInRocm93XCIgPT09IG4udHlwZSkge1xuICAgICAgICAgICAgdmFyIG8gPSBuLmFyZztcbiAgICAgICAgICAgIHJlc2V0VHJ5RW50cnkocik7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBvO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJpbGxlZ2FsIGNhdGNoIGF0dGVtcHRcIik7XG4gICAgfSxcbiAgICBkZWxlZ2F0ZVlpZWxkOiBmdW5jdGlvbiAoZSwgciwgbikge1xuICAgICAgcmV0dXJuIHRoaXMuZGVsZWdhdGUgPSB7XG4gICAgICAgIGl0ZXJhdG9yOiB2YWx1ZXMoZSksXG4gICAgICAgIHJlc3VsdE5hbWU6IHIsXG4gICAgICAgIG5leHRMb2M6IG5cbiAgICAgIH0sIFwibmV4dFwiID09PSB0aGlzLm1ldGhvZCAmJiAodGhpcy5hcmcgPSB0KSwgeTtcbiAgICB9XG4gIH0sIGU7XG59XG5mdW5jdGlvbiBfdHlwZW9mKG8pIHtcbiAgXCJAYmFiZWwvaGVscGVycyAtIHR5cGVvZlwiO1xuXG4gIHJldHVybiBfdHlwZW9mID0gXCJmdW5jdGlvblwiID09IHR5cGVvZiBTeW1ib2wgJiYgXCJzeW1ib2xcIiA9PSB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID8gZnVuY3Rpb24gKG8pIHtcbiAgICByZXR1cm4gdHlwZW9mIG87XG4gIH0gOiBmdW5jdGlvbiAobykge1xuICAgIHJldHVybiBvICYmIFwiZnVuY3Rpb25cIiA9PSB0eXBlb2YgU3ltYm9sICYmIG8uY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiBvICE9PSBTeW1ib2wucHJvdG90eXBlID8gXCJzeW1ib2xcIiA6IHR5cGVvZiBvO1xuICB9LCBfdHlwZW9mKG8pO1xufVxuZnVuY3Rpb24gX3VzaW5nKG8sIGUsIG4pIHtcbiAgaWYgKG51bGwgPT0gZSkgcmV0dXJuIGU7XG4gIGlmIChcIm9iamVjdFwiICE9IHR5cGVvZiBlKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwidXNpbmcgZGVjbGFyYXRpb25zIGNhbiBvbmx5IGJlIHVzZWQgd2l0aCBvYmplY3RzLCBudWxsLCBvciB1bmRlZmluZWQuXCIpO1xuICBpZiAobikgdmFyIHIgPSBlW1N5bWJvbC5hc3luY0Rpc3Bvc2UgfHwgU3ltYm9sLmZvcihcIlN5bWJvbC5hc3luY0Rpc3Bvc2VcIildO1xuICBpZiAobnVsbCA9PSByICYmIChyID0gZVtTeW1ib2wuZGlzcG9zZSB8fCBTeW1ib2wuZm9yKFwiU3ltYm9sLmRpc3Bvc2VcIildKSwgXCJmdW5jdGlvblwiICE9IHR5cGVvZiByKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiUHJvcGVydHkgW1N5bWJvbC5kaXNwb3NlXSBpcyBub3QgYSBmdW5jdGlvbi5cIik7XG4gIHJldHVybiBvLnB1c2goe1xuICAgIHY6IGUsXG4gICAgZDogcixcbiAgICBhOiBuXG4gIH0pLCBlO1xufVxuZnVuY3Rpb24gX3dyYXBSZWdFeHAoKSB7XG4gIF93cmFwUmVnRXhwID0gZnVuY3Rpb24gKGUsIHIpIHtcbiAgICByZXR1cm4gbmV3IEJhYmVsUmVnRXhwKGUsIHZvaWQgMCwgcik7XG4gIH07XG4gIHZhciBlID0gUmVnRXhwLnByb3RvdHlwZSxcbiAgICByID0gbmV3IFdlYWtNYXAoKTtcbiAgZnVuY3Rpb24gQmFiZWxSZWdFeHAoZSwgdCwgcCkge1xuICAgIHZhciBvID0gbmV3IFJlZ0V4cChlLCB0KTtcbiAgICByZXR1cm4gci5zZXQobywgcCB8fCByLmdldChlKSksIF9zZXRQcm90b3R5cGVPZihvLCBCYWJlbFJlZ0V4cC5wcm90b3R5cGUpO1xuICB9XG4gIGZ1bmN0aW9uIGJ1aWxkR3JvdXBzKGUsIHQpIHtcbiAgICB2YXIgcCA9IHIuZ2V0KHQpO1xuICAgIHJldHVybiBPYmplY3Qua2V5cyhwKS5yZWR1Y2UoZnVuY3Rpb24gKHIsIHQpIHtcbiAgICAgIHZhciBvID0gcFt0XTtcbiAgICAgIGlmIChcIm51bWJlclwiID09IHR5cGVvZiBvKSByW3RdID0gZVtvXTtlbHNlIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IHZvaWQgMCA9PT0gZVtvW2ldXSAmJiBpICsgMSA8IG8ubGVuZ3RoOykgaSsrO1xuICAgICAgICByW3RdID0gZVtvW2ldXTtcbiAgICAgIH1cbiAgICAgIHJldHVybiByO1xuICAgIH0sIE9iamVjdC5jcmVhdGUobnVsbCkpO1xuICB9XG4gIHJldHVybiBfaW5oZXJpdHMoQmFiZWxSZWdFeHAsIFJlZ0V4cCksIEJhYmVsUmVnRXhwLnByb3RvdHlwZS5leGVjID0gZnVuY3Rpb24gKHIpIHtcbiAgICB2YXIgdCA9IGUuZXhlYy5jYWxsKHRoaXMsIHIpO1xuICAgIGlmICh0KSB7XG4gICAgICB0Lmdyb3VwcyA9IGJ1aWxkR3JvdXBzKHQsIHRoaXMpO1xuICAgICAgdmFyIHAgPSB0LmluZGljZXM7XG4gICAgICBwICYmIChwLmdyb3VwcyA9IGJ1aWxkR3JvdXBzKHAsIHRoaXMpKTtcbiAgICB9XG4gICAgcmV0dXJuIHQ7XG4gIH0sIEJhYmVsUmVnRXhwLnByb3RvdHlwZVtTeW1ib2wucmVwbGFjZV0gPSBmdW5jdGlvbiAodCwgcCkge1xuICAgIGlmIChcInN0cmluZ1wiID09IHR5cGVvZiBwKSB7XG4gICAgICB2YXIgbyA9IHIuZ2V0KHRoaXMpO1xuICAgICAgcmV0dXJuIGVbU3ltYm9sLnJlcGxhY2VdLmNhbGwodGhpcywgdCwgcC5yZXBsYWNlKC9cXCQ8KFtePl0rKT4vZywgZnVuY3Rpb24gKGUsIHIpIHtcbiAgICAgICAgdmFyIHQgPSBvW3JdO1xuICAgICAgICByZXR1cm4gXCIkXCIgKyAoQXJyYXkuaXNBcnJheSh0KSA/IHQuam9pbihcIiRcIikgOiB0KTtcbiAgICAgIH0pKTtcbiAgICB9XG4gICAgaWYgKFwiZnVuY3Rpb25cIiA9PSB0eXBlb2YgcCkge1xuICAgICAgdmFyIGkgPSB0aGlzO1xuICAgICAgcmV0dXJuIGVbU3ltYm9sLnJlcGxhY2VdLmNhbGwodGhpcywgdCwgZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZSA9IGFyZ3VtZW50cztcbiAgICAgICAgcmV0dXJuIFwib2JqZWN0XCIgIT0gdHlwZW9mIGVbZS5sZW5ndGggLSAxXSAmJiAoZSA9IFtdLnNsaWNlLmNhbGwoZSkpLnB1c2goYnVpbGRHcm91cHMoZSwgaSkpLCBwLmFwcGx5KHRoaXMsIGUpO1xuICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiBlW1N5bWJvbC5yZXBsYWNlXS5jYWxsKHRoaXMsIHQsIHApO1xuICB9LCBfd3JhcFJlZ0V4cC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufVxuZnVuY3Rpb24gX0F3YWl0VmFsdWUodmFsdWUpIHtcbiAgdGhpcy53cmFwcGVkID0gdmFsdWU7XG59XG5mdW5jdGlvbiBfd3JhcEFzeW5jR2VuZXJhdG9yKGZuKSB7XG4gIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIG5ldyBfQXN5bmNHZW5lcmF0b3IoZm4uYXBwbHkodGhpcywgYXJndW1lbnRzKSk7XG4gIH07XG59XG5mdW5jdGlvbiBhc3luY0dlbmVyYXRvclN0ZXAoZ2VuLCByZXNvbHZlLCByZWplY3QsIF9uZXh0LCBfdGhyb3csIGtleSwgYXJnKSB7XG4gIHRyeSB7XG4gICAgdmFyIGluZm8gPSBnZW5ba2V5XShhcmcpO1xuICAgIHZhciB2YWx1ZSA9IGluZm8udmFsdWU7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmVqZWN0KGVycm9yKTtcbiAgICByZXR1cm47XG4gIH1cbiAgaWYgKGluZm8uZG9uZSkge1xuICAgIHJlc29sdmUodmFsdWUpO1xuICB9IGVsc2Uge1xuICAgIFByb21pc2UucmVzb2x2ZSh2YWx1ZSkudGhlbihfbmV4dCwgX3Rocm93KTtcbiAgfVxufVxuZnVuY3Rpb24gX2FzeW5jVG9HZW5lcmF0b3IoZm4pIHtcbiAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXMsXG4gICAgICBhcmdzID0gYXJndW1lbnRzO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICB2YXIgZ2VuID0gZm4uYXBwbHkoc2VsZiwgYXJncyk7XG4gICAgICBmdW5jdGlvbiBfbmV4dCh2YWx1ZSkge1xuICAgICAgICBhc3luY0dlbmVyYXRvclN0ZXAoZ2VuLCByZXNvbHZlLCByZWplY3QsIF9uZXh0LCBfdGhyb3csIFwibmV4dFwiLCB2YWx1ZSk7XG4gICAgICB9XG4gICAgICBmdW5jdGlvbiBfdGhyb3coZXJyKSB7XG4gICAgICAgIGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywgXCJ0aHJvd1wiLCBlcnIpO1xuICAgICAgfVxuICAgICAgX25leHQodW5kZWZpbmVkKTtcbiAgICB9KTtcbiAgfTtcbn1cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHtcbiAgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpO1xuICB9XG59XG5mdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldO1xuICAgIGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTtcbiAgICBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7XG4gICAgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBfdG9Qcm9wZXJ0eUtleShkZXNjcmlwdG9yLmtleSksIGRlc2NyaXB0b3IpO1xuICB9XG59XG5mdW5jdGlvbiBfY3JlYXRlQ2xhc3MoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7XG4gIGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpO1xuICBpZiAoc3RhdGljUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7XG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShDb25zdHJ1Y3RvciwgXCJwcm90b3R5cGVcIiwge1xuICAgIHdyaXRhYmxlOiBmYWxzZVxuICB9KTtcbiAgcmV0dXJuIENvbnN0cnVjdG9yO1xufVxuZnVuY3Rpb24gX2RlZmluZUVudW1lcmFibGVQcm9wZXJ0aWVzKG9iaiwgZGVzY3MpIHtcbiAgZm9yICh2YXIga2V5IGluIGRlc2NzKSB7XG4gICAgdmFyIGRlc2MgPSBkZXNjc1trZXldO1xuICAgIGRlc2MuY29uZmlndXJhYmxlID0gZGVzYy5lbnVtZXJhYmxlID0gdHJ1ZTtcbiAgICBpZiAoXCJ2YWx1ZVwiIGluIGRlc2MpIGRlc2Mud3JpdGFibGUgPSB0cnVlO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgZGVzYyk7XG4gIH1cbiAgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHtcbiAgICB2YXIgb2JqZWN0U3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoZGVzY3MpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgb2JqZWN0U3ltYm9scy5sZW5ndGg7IGkrKykge1xuICAgICAgdmFyIHN5bSA9IG9iamVjdFN5bWJvbHNbaV07XG4gICAgICB2YXIgZGVzYyA9IGRlc2NzW3N5bV07XG4gICAgICBkZXNjLmNvbmZpZ3VyYWJsZSA9IGRlc2MuZW51bWVyYWJsZSA9IHRydWU7XG4gICAgICBpZiAoXCJ2YWx1ZVwiIGluIGRlc2MpIGRlc2Mud3JpdGFibGUgPSB0cnVlO1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwgc3ltLCBkZXNjKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIG9iajtcbn1cbmZ1bmN0aW9uIF9kZWZhdWx0cyhvYmosIGRlZmF1bHRzKSB7XG4gIHZhciBrZXlzID0gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMoZGVmYXVsdHMpO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGtleXMubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIga2V5ID0ga2V5c1tpXTtcbiAgICB2YXIgdmFsdWUgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGRlZmF1bHRzLCBrZXkpO1xuICAgIGlmICh2YWx1ZSAmJiB2YWx1ZS5jb25maWd1cmFibGUgJiYgb2JqW2tleV0gPT09IHVuZGVmaW5lZCkge1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB2YWx1ZSk7XG4gICAgfVxuICB9XG4gIHJldHVybiBvYmo7XG59XG5mdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7XG4gIGtleSA9IF90b1Byb3BlcnR5S2V5KGtleSk7XG4gIGlmIChrZXkgaW4gb2JqKSB7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7XG4gICAgICB2YWx1ZTogdmFsdWUsXG4gICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgd3JpdGFibGU6IHRydWVcbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICBvYmpba2V5XSA9IHZhbHVlO1xuICB9XG4gIHJldHVybiBvYmo7XG59XG5mdW5jdGlvbiBfZXh0ZW5kcygpIHtcbiAgX2V4dGVuZHMgPSBPYmplY3QuYXNzaWduID8gT2JqZWN0LmFzc2lnbi5iaW5kKCkgOiBmdW5jdGlvbiAodGFyZ2V0KSB7XG4gICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV07XG4gICAgICBmb3IgKHZhciBrZXkgaW4gc291cmNlKSB7XG4gICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoc291cmNlLCBrZXkpKSB7XG4gICAgICAgICAgdGFyZ2V0W2tleV0gPSBzb3VyY2Vba2V5XTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdGFyZ2V0O1xuICB9O1xuICByZXR1cm4gX2V4dGVuZHMuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn1cbmZ1bmN0aW9uIF9vYmplY3RTcHJlYWQodGFyZ2V0KSB7XG4gIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXSAhPSBudWxsID8gT2JqZWN0KGFyZ3VtZW50c1tpXSkgOiB7fTtcbiAgICB2YXIgb3duS2V5cyA9IE9iamVjdC5rZXlzKHNvdXJjZSk7XG4gICAgaWYgKHR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICBvd25LZXlzLnB1c2guYXBwbHkob3duS2V5cywgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhzb3VyY2UpLmZpbHRlcihmdW5jdGlvbiAoc3ltKSB7XG4gICAgICAgIHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHNvdXJjZSwgc3ltKS5lbnVtZXJhYmxlO1xuICAgICAgfSkpO1xuICAgIH1cbiAgICBvd25LZXlzLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuICAgICAgX2RlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBzb3VyY2Vba2V5XSk7XG4gICAgfSk7XG4gIH1cbiAgcmV0dXJuIHRhcmdldDtcbn1cbmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykge1xuICBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uXCIpO1xuICB9XG4gIHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwge1xuICAgIGNvbnN0cnVjdG9yOiB7XG4gICAgICB2YWx1ZTogc3ViQ2xhc3MsXG4gICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH1cbiAgfSk7XG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzdWJDbGFzcywgXCJwcm90b3R5cGVcIiwge1xuICAgIHdyaXRhYmxlOiBmYWxzZVxuICB9KTtcbiAgaWYgKHN1cGVyQ2xhc3MpIF9zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcyk7XG59XG5mdW5jdGlvbiBfaW5oZXJpdHNMb29zZShzdWJDbGFzcywgc3VwZXJDbGFzcykge1xuICBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MucHJvdG90eXBlKTtcbiAgc3ViQ2xhc3MucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gc3ViQ2xhc3M7XG4gIF9zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcyk7XG59XG5mdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2Yobykge1xuICBfZ2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3QuZ2V0UHJvdG90eXBlT2YuYmluZCgpIDogZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHtcbiAgICByZXR1cm4gby5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKG8pO1xuICB9O1xuICByZXR1cm4gX2dldFByb3RvdHlwZU9mKG8pO1xufVxuZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHtcbiAgX3NldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mLmJpbmQoKSA6IGZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7XG4gICAgby5fX3Byb3RvX18gPSBwO1xuICAgIHJldHVybiBvO1xuICB9O1xuICByZXR1cm4gX3NldFByb3RvdHlwZU9mKG8sIHApO1xufVxuZnVuY3Rpb24gX2lzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCgpIHtcbiAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcInVuZGVmaW5lZFwiIHx8ICFSZWZsZWN0LmNvbnN0cnVjdCkgcmV0dXJuIGZhbHNlO1xuICBpZiAoUmVmbGVjdC5jb25zdHJ1Y3Quc2hhbSkgcmV0dXJuIGZhbHNlO1xuICBpZiAodHlwZW9mIFByb3h5ID09PSBcImZ1bmN0aW9uXCIpIHJldHVybiB0cnVlO1xuICB0cnkge1xuICAgIEJvb2xlYW4ucHJvdG90eXBlLnZhbHVlT2YuY2FsbChSZWZsZWN0LmNvbnN0cnVjdChCb29sZWFuLCBbXSwgZnVuY3Rpb24gKCkge30pKTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufVxuZnVuY3Rpb24gX2NvbnN0cnVjdChQYXJlbnQsIGFyZ3MsIENsYXNzKSB7XG4gIGlmIChfaXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0KCkpIHtcbiAgICBfY29uc3RydWN0ID0gUmVmbGVjdC5jb25zdHJ1Y3QuYmluZCgpO1xuICB9IGVsc2Uge1xuICAgIF9jb25zdHJ1Y3QgPSBmdW5jdGlvbiBfY29uc3RydWN0KFBhcmVudCwgYXJncywgQ2xhc3MpIHtcbiAgICAgIHZhciBhID0gW251bGxdO1xuICAgICAgYS5wdXNoLmFwcGx5KGEsIGFyZ3MpO1xuICAgICAgdmFyIENvbnN0cnVjdG9yID0gRnVuY3Rpb24uYmluZC5hcHBseShQYXJlbnQsIGEpO1xuICAgICAgdmFyIGluc3RhbmNlID0gbmV3IENvbnN0cnVjdG9yKCk7XG4gICAgICBpZiAoQ2xhc3MpIF9zZXRQcm90b3R5cGVPZihpbnN0YW5jZSwgQ2xhc3MucHJvdG90eXBlKTtcbiAgICAgIHJldHVybiBpbnN0YW5jZTtcbiAgICB9O1xuICB9XG4gIHJldHVybiBfY29uc3RydWN0LmFwcGx5KG51bGwsIGFyZ3VtZW50cyk7XG59XG5mdW5jdGlvbiBfaXNOYXRpdmVGdW5jdGlvbihmbikge1xuICByZXR1cm4gRnVuY3Rpb24udG9TdHJpbmcuY2FsbChmbikuaW5kZXhPZihcIltuYXRpdmUgY29kZV1cIikgIT09IC0xO1xufVxuZnVuY3Rpb24gX3dyYXBOYXRpdmVTdXBlcihDbGFzcykge1xuICB2YXIgX2NhY2hlID0gdHlwZW9mIE1hcCA9PT0gXCJmdW5jdGlvblwiID8gbmV3IE1hcCgpIDogdW5kZWZpbmVkO1xuICBfd3JhcE5hdGl2ZVN1cGVyID0gZnVuY3Rpb24gX3dyYXBOYXRpdmVTdXBlcihDbGFzcykge1xuICAgIGlmIChDbGFzcyA9PT0gbnVsbCB8fCAhX2lzTmF0aXZlRnVuY3Rpb24oQ2xhc3MpKSByZXR1cm4gQ2xhc3M7XG4gICAgaWYgKHR5cGVvZiBDbGFzcyAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb25cIik7XG4gICAgfVxuICAgIGlmICh0eXBlb2YgX2NhY2hlICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICBpZiAoX2NhY2hlLmhhcyhDbGFzcykpIHJldHVybiBfY2FjaGUuZ2V0KENsYXNzKTtcbiAgICAgIF9jYWNoZS5zZXQoQ2xhc3MsIFdyYXBwZXIpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBXcmFwcGVyKCkge1xuICAgICAgcmV0dXJuIF9jb25zdHJ1Y3QoQ2xhc3MsIGFyZ3VtZW50cywgX2dldFByb3RvdHlwZU9mKHRoaXMpLmNvbnN0cnVjdG9yKTtcbiAgICB9XG4gICAgV3JhcHBlci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKENsYXNzLnByb3RvdHlwZSwge1xuICAgICAgY29uc3RydWN0b3I6IHtcbiAgICAgICAgdmFsdWU6IFdyYXBwZXIsXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIF9zZXRQcm90b3R5cGVPZihXcmFwcGVyLCBDbGFzcyk7XG4gIH07XG4gIHJldHVybiBfd3JhcE5hdGl2ZVN1cGVyKENsYXNzKTtcbn1cbmZ1bmN0aW9uIF9pbnN0YW5jZW9mKGxlZnQsIHJpZ2h0KSB7XG4gIGlmIChyaWdodCAhPSBudWxsICYmIHR5cGVvZiBTeW1ib2wgIT09IFwidW5kZWZpbmVkXCIgJiYgcmlnaHRbU3ltYm9sLmhhc0luc3RhbmNlXSkge1xuICAgIHJldHVybiAhIXJpZ2h0W1N5bWJvbC5oYXNJbnN0YW5jZV0obGVmdCk7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIGxlZnQgaW5zdGFuY2VvZiByaWdodDtcbiAgfVxufVxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHtcbiAgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHtcbiAgICBkZWZhdWx0OiBvYmpcbiAgfTtcbn1cbmZ1bmN0aW9uIF9nZXRSZXF1aXJlV2lsZGNhcmRDYWNoZShub2RlSW50ZXJvcCkge1xuICBpZiAodHlwZW9mIFdlYWtNYXAgIT09IFwiZnVuY3Rpb25cIikgcmV0dXJuIG51bGw7XG4gIHZhciBjYWNoZUJhYmVsSW50ZXJvcCA9IG5ldyBXZWFrTWFwKCk7XG4gIHZhciBjYWNoZU5vZGVJbnRlcm9wID0gbmV3IFdlYWtNYXAoKTtcbiAgcmV0dXJuIChfZ2V0UmVxdWlyZVdpbGRjYXJkQ2FjaGUgPSBmdW5jdGlvbiAobm9kZUludGVyb3ApIHtcbiAgICByZXR1cm4gbm9kZUludGVyb3AgPyBjYWNoZU5vZGVJbnRlcm9wIDogY2FjaGVCYWJlbEludGVyb3A7XG4gIH0pKG5vZGVJbnRlcm9wKTtcbn1cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKG9iaiwgbm9kZUludGVyb3ApIHtcbiAgaWYgKCFub2RlSW50ZXJvcCAmJiBvYmogJiYgb2JqLl9fZXNNb2R1bGUpIHtcbiAgICByZXR1cm4gb2JqO1xuICB9XG4gIGlmIChvYmogPT09IG51bGwgfHwgdHlwZW9mIG9iaiAhPT0gXCJvYmplY3RcIiAmJiB0eXBlb2Ygb2JqICE9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICByZXR1cm4ge1xuICAgICAgZGVmYXVsdDogb2JqXG4gICAgfTtcbiAgfVxuICB2YXIgY2FjaGUgPSBfZ2V0UmVxdWlyZVdpbGRjYXJkQ2FjaGUobm9kZUludGVyb3ApO1xuICBpZiAoY2FjaGUgJiYgY2FjaGUuaGFzKG9iaikpIHtcbiAgICByZXR1cm4gY2FjaGUuZ2V0KG9iaik7XG4gIH1cbiAgdmFyIG5ld09iaiA9IHt9O1xuICB2YXIgaGFzUHJvcGVydHlEZXNjcmlwdG9yID0gT2JqZWN0LmRlZmluZVByb3BlcnR5ICYmIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3I7XG4gIGZvciAodmFyIGtleSBpbiBvYmopIHtcbiAgICBpZiAoa2V5ICE9PSBcImRlZmF1bHRcIiAmJiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSB7XG4gICAgICB2YXIgZGVzYyA9IGhhc1Byb3BlcnR5RGVzY3JpcHRvciA/IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqLCBrZXkpIDogbnVsbDtcbiAgICAgIGlmIChkZXNjICYmIChkZXNjLmdldCB8fCBkZXNjLnNldCkpIHtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG5ld09iaiwga2V5LCBkZXNjKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG5ld09ialtrZXldID0gb2JqW2tleV07XG4gICAgICB9XG4gICAgfVxuICB9XG4gIG5ld09iai5kZWZhdWx0ID0gb2JqO1xuICBpZiAoY2FjaGUpIHtcbiAgICBjYWNoZS5zZXQob2JqLCBuZXdPYmopO1xuICB9XG4gIHJldHVybiBuZXdPYmo7XG59XG5mdW5jdGlvbiBfbmV3QXJyb3dDaGVjayhpbm5lclRoaXMsIGJvdW5kVGhpcykge1xuICBpZiAoaW5uZXJUaGlzICE9PSBib3VuZFRoaXMpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGluc3RhbnRpYXRlIGFuIGFycm93IGZ1bmN0aW9uXCIpO1xuICB9XG59XG5mdW5jdGlvbiBfb2JqZWN0RGVzdHJ1Y3R1cmluZ0VtcHR5KG9iaikge1xuICBpZiAob2JqID09IG51bGwpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgZGVzdHJ1Y3R1cmUgXCIgKyBvYmopO1xufVxuZnVuY3Rpb24gX29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzTG9vc2Uoc291cmNlLCBleGNsdWRlZCkge1xuICBpZiAoc291cmNlID09IG51bGwpIHJldHVybiB7fTtcbiAgdmFyIHRhcmdldCA9IHt9O1xuICB2YXIgc291cmNlS2V5cyA9IE9iamVjdC5rZXlzKHNvdXJjZSk7XG4gIHZhciBrZXksIGk7XG4gIGZvciAoaSA9IDA7IGkgPCBzb3VyY2VLZXlzLmxlbmd0aDsgaSsrKSB7XG4gICAga2V5ID0gc291cmNlS2V5c1tpXTtcbiAgICBpZiAoZXhjbHVkZWQuaW5kZXhPZihrZXkpID49IDApIGNvbnRpbnVlO1xuICAgIHRhcmdldFtrZXldID0gc291cmNlW2tleV07XG4gIH1cbiAgcmV0dXJuIHRhcmdldDtcbn1cbmZ1bmN0aW9uIF9vYmplY3RXaXRob3V0UHJvcGVydGllcyhzb3VyY2UsIGV4Y2x1ZGVkKSB7XG4gIGlmIChzb3VyY2UgPT0gbnVsbCkgcmV0dXJuIHt9O1xuICB2YXIgdGFyZ2V0ID0gX29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzTG9vc2Uoc291cmNlLCBleGNsdWRlZCk7XG4gIHZhciBrZXksIGk7XG4gIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7XG4gICAgdmFyIHNvdXJjZVN5bWJvbEtleXMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKHNvdXJjZSk7XG4gICAgZm9yIChpID0gMDsgaSA8IHNvdXJjZVN5bWJvbEtleXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGtleSA9IHNvdXJjZVN5bWJvbEtleXNbaV07XG4gICAgICBpZiAoZXhjbHVkZWQuaW5kZXhPZihrZXkpID49IDApIGNvbnRpbnVlO1xuICAgICAgaWYgKCFPYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwoc291cmNlLCBrZXkpKSBjb250aW51ZTtcbiAgICAgIHRhcmdldFtrZXldID0gc291cmNlW2tleV07XG4gICAgfVxuICB9XG4gIHJldHVybiB0YXJnZXQ7XG59XG5mdW5jdGlvbiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpIHtcbiAgaWYgKHNlbGYgPT09IHZvaWQgMCkge1xuICAgIHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTtcbiAgfVxuICByZXR1cm4gc2VsZjtcbn1cbmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHtcbiAgaWYgKGNhbGwgJiYgKHR5cGVvZiBjYWxsID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBjYWxsID09PSBcImZ1bmN0aW9uXCIpKSB7XG4gICAgcmV0dXJuIGNhbGw7XG4gIH0gZWxzZSBpZiAoY2FsbCAhPT0gdm9pZCAwKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkRlcml2ZWQgY29uc3RydWN0b3JzIG1heSBvbmx5IHJldHVybiBvYmplY3Qgb3IgdW5kZWZpbmVkXCIpO1xuICB9XG4gIHJldHVybiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpO1xufVxuZnVuY3Rpb24gX2NyZWF0ZVN1cGVyKERlcml2ZWQpIHtcbiAgdmFyIGhhc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QgPSBfaXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0KCk7XG4gIHJldHVybiBmdW5jdGlvbiBfY3JlYXRlU3VwZXJJbnRlcm5hbCgpIHtcbiAgICB2YXIgU3VwZXIgPSBfZ2V0UHJvdG90eXBlT2YoRGVyaXZlZCksXG4gICAgICByZXN1bHQ7XG4gICAgaWYgKGhhc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QpIHtcbiAgICAgIHZhciBOZXdUYXJnZXQgPSBfZ2V0UHJvdG90eXBlT2YodGhpcykuY29uc3RydWN0b3I7XG4gICAgICByZXN1bHQgPSBSZWZsZWN0LmNvbnN0cnVjdChTdXBlciwgYXJndW1lbnRzLCBOZXdUYXJnZXQpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXN1bHQgPSBTdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH1cbiAgICByZXR1cm4gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgcmVzdWx0KTtcbiAgfTtcbn1cbmZ1bmN0aW9uIF9zdXBlclByb3BCYXNlKG9iamVjdCwgcHJvcGVydHkpIHtcbiAgd2hpbGUgKCFPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSkpIHtcbiAgICBvYmplY3QgPSBfZ2V0UHJvdG90eXBlT2Yob2JqZWN0KTtcbiAgICBpZiAob2JqZWN0ID09PSBudWxsKSBicmVhaztcbiAgfVxuICByZXR1cm4gb2JqZWN0O1xufVxuZnVuY3Rpb24gX2dldCgpIHtcbiAgaWYgKHR5cGVvZiBSZWZsZWN0ICE9PSBcInVuZGVmaW5lZFwiICYmIFJlZmxlY3QuZ2V0KSB7XG4gICAgX2dldCA9IFJlZmxlY3QuZ2V0LmJpbmQoKTtcbiAgfSBlbHNlIHtcbiAgICBfZ2V0ID0gZnVuY3Rpb24gX2dldCh0YXJnZXQsIHByb3BlcnR5LCByZWNlaXZlcikge1xuICAgICAgdmFyIGJhc2UgPSBfc3VwZXJQcm9wQmFzZSh0YXJnZXQsIHByb3BlcnR5KTtcbiAgICAgIGlmICghYmFzZSkgcmV0dXJuO1xuICAgICAgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGJhc2UsIHByb3BlcnR5KTtcbiAgICAgIGlmIChkZXNjLmdldCkge1xuICAgICAgICByZXR1cm4gZGVzYy5nZXQuY2FsbChhcmd1bWVudHMubGVuZ3RoIDwgMyA/IHRhcmdldCA6IHJlY2VpdmVyKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBkZXNjLnZhbHVlO1xuICAgIH07XG4gIH1cbiAgcmV0dXJuIF9nZXQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn1cbmZ1bmN0aW9uIHNldCh0YXJnZXQsIHByb3BlcnR5LCB2YWx1ZSwgcmVjZWl2ZXIpIHtcbiAgaWYgKHR5cGVvZiBSZWZsZWN0ICE9PSBcInVuZGVmaW5lZFwiICYmIFJlZmxlY3Quc2V0KSB7XG4gICAgc2V0ID0gUmVmbGVjdC5zZXQ7XG4gIH0gZWxzZSB7XG4gICAgc2V0ID0gZnVuY3Rpb24gc2V0KHRhcmdldCwgcHJvcGVydHksIHZhbHVlLCByZWNlaXZlcikge1xuICAgICAgdmFyIGJhc2UgPSBfc3VwZXJQcm9wQmFzZSh0YXJnZXQsIHByb3BlcnR5KTtcbiAgICAgIHZhciBkZXNjO1xuICAgICAgaWYgKGJhc2UpIHtcbiAgICAgICAgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoYmFzZSwgcHJvcGVydHkpO1xuICAgICAgICBpZiAoZGVzYy5zZXQpIHtcbiAgICAgICAgICBkZXNjLnNldC5jYWxsKHJlY2VpdmVyLCB2YWx1ZSk7XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0gZWxzZSBpZiAoIWRlc2Mud3JpdGFibGUpIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHJlY2VpdmVyLCBwcm9wZXJ0eSk7XG4gICAgICBpZiAoZGVzYykge1xuICAgICAgICBpZiAoIWRlc2Mud3JpdGFibGUpIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgZGVzYy52YWx1ZSA9IHZhbHVlO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkocmVjZWl2ZXIsIHByb3BlcnR5LCBkZXNjKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIF9kZWZpbmVQcm9wZXJ0eShyZWNlaXZlciwgcHJvcGVydHksIHZhbHVlKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG4gIH1cbiAgcmV0dXJuIHNldCh0YXJnZXQsIHByb3BlcnR5LCB2YWx1ZSwgcmVjZWl2ZXIpO1xufVxuZnVuY3Rpb24gX3NldCh0YXJnZXQsIHByb3BlcnR5LCB2YWx1ZSwgcmVjZWl2ZXIsIGlzU3RyaWN0KSB7XG4gIHZhciBzID0gc2V0KHRhcmdldCwgcHJvcGVydHksIHZhbHVlLCByZWNlaXZlciB8fCB0YXJnZXQpO1xuICBpZiAoIXMgJiYgaXNTdHJpY3QpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdmYWlsZWQgdG8gc2V0IHByb3BlcnR5Jyk7XG4gIH1cbiAgcmV0dXJuIHZhbHVlO1xufVxuZnVuY3Rpb24gX3RhZ2dlZFRlbXBsYXRlTGl0ZXJhbChzdHJpbmdzLCByYXcpIHtcbiAgaWYgKCFyYXcpIHtcbiAgICByYXcgPSBzdHJpbmdzLnNsaWNlKDApO1xuICB9XG4gIHJldHVybiBPYmplY3QuZnJlZXplKE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHN0cmluZ3MsIHtcbiAgICByYXc6IHtcbiAgICAgIHZhbHVlOiBPYmplY3QuZnJlZXplKHJhdylcbiAgICB9XG4gIH0pKTtcbn1cbmZ1bmN0aW9uIF90YWdnZWRUZW1wbGF0ZUxpdGVyYWxMb29zZShzdHJpbmdzLCByYXcpIHtcbiAgaWYgKCFyYXcpIHtcbiAgICByYXcgPSBzdHJpbmdzLnNsaWNlKDApO1xuICB9XG4gIHN0cmluZ3MucmF3ID0gcmF3O1xuICByZXR1cm4gc3RyaW5ncztcbn1cbmZ1bmN0aW9uIF9yZWFkT25seUVycm9yKG5hbWUpIHtcbiAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlxcXCJcIiArIG5hbWUgKyBcIlxcXCIgaXMgcmVhZC1vbmx5XCIpO1xufVxuZnVuY3Rpb24gX3dyaXRlT25seUVycm9yKG5hbWUpIHtcbiAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlxcXCJcIiArIG5hbWUgKyBcIlxcXCIgaXMgd3JpdGUtb25seVwiKTtcbn1cbmZ1bmN0aW9uIF9jbGFzc05hbWVURFpFcnJvcihuYW1lKSB7XG4gIHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcIkNsYXNzIFxcXCJcIiArIG5hbWUgKyBcIlxcXCIgY2Fubm90IGJlIHJlZmVyZW5jZWQgaW4gY29tcHV0ZWQgcHJvcGVydHkga2V5cy5cIik7XG59XG5mdW5jdGlvbiBfdGVtcG9yYWxVbmRlZmluZWQoKSB7fVxuZnVuY3Rpb24gX3RkeihuYW1lKSB7XG4gIHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihuYW1lICsgXCIgaXMgbm90IGRlZmluZWQgLSB0ZW1wb3JhbCBkZWFkIHpvbmVcIik7XG59XG5mdW5jdGlvbiBfdGVtcG9yYWxSZWYodmFsLCBuYW1lKSB7XG4gIHJldHVybiB2YWwgPT09IF90ZW1wb3JhbFVuZGVmaW5lZCA/IF90ZHoobmFtZSkgOiB2YWw7XG59XG5mdW5jdGlvbiBfc2xpY2VkVG9BcnJheShhcnIsIGkpIHtcbiAgcmV0dXJuIF9hcnJheVdpdGhIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHx8IF91bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheShhcnIsIGkpIHx8IF9ub25JdGVyYWJsZVJlc3QoKTtcbn1cbmZ1bmN0aW9uIF9zbGljZWRUb0FycmF5TG9vc2UoYXJyLCBpKSB7XG4gIHJldHVybiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5TGltaXRMb29zZShhcnIsIGkpIHx8IF91bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheShhcnIsIGkpIHx8IF9ub25JdGVyYWJsZVJlc3QoKTtcbn1cbmZ1bmN0aW9uIF90b0FycmF5KGFycikge1xuICByZXR1cm4gX2FycmF5V2l0aEhvbGVzKGFycikgfHwgX2l0ZXJhYmxlVG9BcnJheShhcnIpIHx8IF91bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheShhcnIpIHx8IF9ub25JdGVyYWJsZVJlc3QoKTtcbn1cbmZ1bmN0aW9uIF90b0NvbnN1bWFibGVBcnJheShhcnIpIHtcbiAgcmV0dXJuIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXkoYXJyKSB8fCBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkoYXJyKSB8fCBfbm9uSXRlcmFibGVTcHJlYWQoKTtcbn1cbmZ1bmN0aW9uIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHtcbiAgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgcmV0dXJuIF9hcnJheUxpa2VUb0FycmF5KGFycik7XG59XG5mdW5jdGlvbiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB7XG4gIGlmIChBcnJheS5pc0FycmF5KGFycikpIHJldHVybiBhcnI7XG59XG5mdW5jdGlvbiBfbWF5YmVBcnJheUxpa2UobmV4dCwgYXJyLCBpKSB7XG4gIGlmIChhcnIgJiYgIUFycmF5LmlzQXJyYXkoYXJyKSAmJiB0eXBlb2YgYXJyLmxlbmd0aCA9PT0gXCJudW1iZXJcIikge1xuICAgIHZhciBsZW4gPSBhcnIubGVuZ3RoO1xuICAgIHJldHVybiBfYXJyYXlMaWtlVG9BcnJheShhcnIsIGkgIT09IHZvaWQgMCAmJiBpIDwgbGVuID8gaSA6IGxlbik7XG4gIH1cbiAgcmV0dXJuIG5leHQoYXJyLCBpKTtcbn1cbmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXkoaXRlcikge1xuICBpZiAodHlwZW9mIFN5bWJvbCAhPT0gXCJ1bmRlZmluZWRcIiAmJiBpdGVyW1N5bWJvbC5pdGVyYXRvcl0gIT0gbnVsbCB8fCBpdGVyW1wiQEBpdGVyYXRvclwiXSAhPSBudWxsKSByZXR1cm4gQXJyYXkuZnJvbShpdGVyKTtcbn1cbmZ1bmN0aW9uIF91bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheShvLCBtaW5MZW4pIHtcbiAgaWYgKCFvKSByZXR1cm47XG4gIGlmICh0eXBlb2YgbyA9PT0gXCJzdHJpbmdcIikgcmV0dXJuIF9hcnJheUxpa2VUb0FycmF5KG8sIG1pbkxlbik7XG4gIHZhciBuID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG8pLnNsaWNlKDgsIC0xKTtcbiAgaWYgKG4gPT09IFwiT2JqZWN0XCIgJiYgby5jb25zdHJ1Y3RvcikgbiA9IG8uY29uc3RydWN0b3IubmFtZTtcbiAgaWYgKG4gPT09IFwiTWFwXCIgfHwgbiA9PT0gXCJTZXRcIikgcmV0dXJuIEFycmF5LmZyb20obyk7XG4gIGlmIChuID09PSBcIkFyZ3VtZW50c1wiIHx8IC9eKD86VWl8SSludCg/Ojh8MTZ8MzIpKD86Q2xhbXBlZCk/QXJyYXkkLy50ZXN0KG4pKSByZXR1cm4gX2FycmF5TGlrZVRvQXJyYXkobywgbWluTGVuKTtcbn1cbmZ1bmN0aW9uIF9hcnJheUxpa2VUb0FycmF5KGFyciwgbGVuKSB7XG4gIGlmIChsZW4gPT0gbnVsbCB8fCBsZW4gPiBhcnIubGVuZ3RoKSBsZW4gPSBhcnIubGVuZ3RoO1xuICBmb3IgKHZhciBpID0gMCwgYXJyMiA9IG5ldyBBcnJheShsZW4pOyBpIDwgbGVuOyBpKyspIGFycjJbaV0gPSBhcnJbaV07XG4gIHJldHVybiBhcnIyO1xufVxuZnVuY3Rpb24gX25vbkl0ZXJhYmxlU3ByZWFkKCkge1xuICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiSW52YWxpZCBhdHRlbXB0IHRvIHNwcmVhZCBub24taXRlcmFibGUgaW5zdGFuY2UuXFxuSW4gb3JkZXIgdG8gYmUgaXRlcmFibGUsIG5vbi1hcnJheSBvYmplY3RzIG11c3QgaGF2ZSBhIFtTeW1ib2wuaXRlcmF0b3JdKCkgbWV0aG9kLlwiKTtcbn1cbmZ1bmN0aW9uIF9ub25JdGVyYWJsZVJlc3QoKSB7XG4gIHRocm93IG5ldyBUeXBlRXJyb3IoXCJJbnZhbGlkIGF0dGVtcHQgdG8gZGVzdHJ1Y3R1cmUgbm9uLWl0ZXJhYmxlIGluc3RhbmNlLlxcbkluIG9yZGVyIHRvIGJlIGl0ZXJhYmxlLCBub24tYXJyYXkgb2JqZWN0cyBtdXN0IGhhdmUgYSBbU3ltYm9sLml0ZXJhdG9yXSgpIG1ldGhvZC5cIik7XG59XG5mdW5jdGlvbiBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcihvLCBhbGxvd0FycmF5TGlrZSkge1xuICB2YXIgaXQgPSB0eXBlb2YgU3ltYm9sICE9PSBcInVuZGVmaW5lZFwiICYmIG9bU3ltYm9sLml0ZXJhdG9yXSB8fCBvW1wiQEBpdGVyYXRvclwiXTtcbiAgaWYgKCFpdCkge1xuICAgIGlmIChBcnJheS5pc0FycmF5KG8pIHx8IChpdCA9IF91bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheShvKSkgfHwgYWxsb3dBcnJheUxpa2UgJiYgbyAmJiB0eXBlb2Ygby5sZW5ndGggPT09IFwibnVtYmVyXCIpIHtcbiAgICAgIGlmIChpdCkgbyA9IGl0O1xuICAgICAgdmFyIGkgPSAwO1xuICAgICAgdmFyIEYgPSBmdW5jdGlvbiAoKSB7fTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHM6IEYsXG4gICAgICAgIG46IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBpZiAoaSA+PSBvLmxlbmd0aCkgcmV0dXJuIHtcbiAgICAgICAgICAgIGRvbmU6IHRydWVcbiAgICAgICAgICB9O1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBkb25lOiBmYWxzZSxcbiAgICAgICAgICAgIHZhbHVlOiBvW2krK11cbiAgICAgICAgICB9O1xuICAgICAgICB9LFxuICAgICAgICBlOiBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgIHRocm93IGU7XG4gICAgICAgIH0sXG4gICAgICAgIGY6IEZcbiAgICAgIH07XG4gICAgfVxuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJJbnZhbGlkIGF0dGVtcHQgdG8gaXRlcmF0ZSBub24taXRlcmFibGUgaW5zdGFuY2UuXFxuSW4gb3JkZXIgdG8gYmUgaXRlcmFibGUsIG5vbi1hcnJheSBvYmplY3RzIG11c3QgaGF2ZSBhIFtTeW1ib2wuaXRlcmF0b3JdKCkgbWV0aG9kLlwiKTtcbiAgfVxuICB2YXIgbm9ybWFsQ29tcGxldGlvbiA9IHRydWUsXG4gICAgZGlkRXJyID0gZmFsc2UsXG4gICAgZXJyO1xuICByZXR1cm4ge1xuICAgIHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgIGl0ID0gaXQuY2FsbChvKTtcbiAgICB9LFxuICAgIG46IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBzdGVwID0gaXQubmV4dCgpO1xuICAgICAgbm9ybWFsQ29tcGxldGlvbiA9IHN0ZXAuZG9uZTtcbiAgICAgIHJldHVybiBzdGVwO1xuICAgIH0sXG4gICAgZTogZnVuY3Rpb24gKGUpIHtcbiAgICAgIGRpZEVyciA9IHRydWU7XG4gICAgICBlcnIgPSBlO1xuICAgIH0sXG4gICAgZjogZnVuY3Rpb24gKCkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgaWYgKCFub3JtYWxDb21wbGV0aW9uICYmIGl0LnJldHVybiAhPSBudWxsKSBpdC5yZXR1cm4oKTtcbiAgICAgIH0gZmluYWxseSB7XG4gICAgICAgIGlmIChkaWRFcnIpIHRocm93IGVycjtcbiAgICAgIH1cbiAgICB9XG4gIH07XG59XG5mdW5jdGlvbiBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlckxvb3NlKG8sIGFsbG93QXJyYXlMaWtlKSB7XG4gIHZhciBpdCA9IHR5cGVvZiBTeW1ib2wgIT09IFwidW5kZWZpbmVkXCIgJiYgb1tTeW1ib2wuaXRlcmF0b3JdIHx8IG9bXCJAQGl0ZXJhdG9yXCJdO1xuICBpZiAoaXQpIHJldHVybiAoaXQgPSBpdC5jYWxsKG8pKS5uZXh0LmJpbmQoaXQpO1xuICBpZiAoQXJyYXkuaXNBcnJheShvKSB8fCAoaXQgPSBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkobykpIHx8IGFsbG93QXJyYXlMaWtlICYmIG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSBcIm51bWJlclwiKSB7XG4gICAgaWYgKGl0KSBvID0gaXQ7XG4gICAgdmFyIGkgPSAwO1xuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAoaSA+PSBvLmxlbmd0aCkgcmV0dXJuIHtcbiAgICAgICAgZG9uZTogdHJ1ZVxuICAgICAgfTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGRvbmU6IGZhbHNlLFxuICAgICAgICB2YWx1ZTogb1tpKytdXG4gICAgICB9O1xuICAgIH07XG4gIH1cbiAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkludmFsaWQgYXR0ZW1wdCB0byBpdGVyYXRlIG5vbi1pdGVyYWJsZSBpbnN0YW5jZS5cXG5JbiBvcmRlciB0byBiZSBpdGVyYWJsZSwgbm9uLWFycmF5IG9iamVjdHMgbXVzdCBoYXZlIGEgW1N5bWJvbC5pdGVyYXRvcl0oKSBtZXRob2QuXCIpO1xufVxuZnVuY3Rpb24gX3NraXBGaXJzdEdlbmVyYXRvck5leHQoZm4pIHtcbiAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgaXQgPSBmbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIGl0Lm5leHQoKTtcbiAgICByZXR1cm4gaXQ7XG4gIH07XG59XG5mdW5jdGlvbiBfdG9QcmltaXRpdmUoaW5wdXQsIGhpbnQpIHtcbiAgaWYgKHR5cGVvZiBpbnB1dCAhPT0gXCJvYmplY3RcIiB8fCBpbnB1dCA9PT0gbnVsbCkgcmV0dXJuIGlucHV0O1xuICB2YXIgcHJpbSA9IGlucHV0W1N5bWJvbC50b1ByaW1pdGl2ZV07XG4gIGlmIChwcmltICE9PSB1bmRlZmluZWQpIHtcbiAgICB2YXIgcmVzID0gcHJpbS5jYWxsKGlucHV0LCBoaW50IHx8IFwiZGVmYXVsdFwiKTtcbiAgICBpZiAodHlwZW9mIHJlcyAhPT0gXCJvYmplY3RcIikgcmV0dXJuIHJlcztcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQEB0b1ByaW1pdGl2ZSBtdXN0IHJldHVybiBhIHByaW1pdGl2ZSB2YWx1ZS5cIik7XG4gIH1cbiAgcmV0dXJuIChoaW50ID09PSBcInN0cmluZ1wiID8gU3RyaW5nIDogTnVtYmVyKShpbnB1dCk7XG59XG5mdW5jdGlvbiBfdG9Qcm9wZXJ0eUtleShhcmcpIHtcbiAgdmFyIGtleSA9IF90b1ByaW1pdGl2ZShhcmcsIFwic3RyaW5nXCIpO1xuICByZXR1cm4gdHlwZW9mIGtleSA9PT0gXCJzeW1ib2xcIiA/IGtleSA6IFN0cmluZyhrZXkpO1xufVxuZnVuY3Rpb24gX2luaXRpYWxpemVyV2FybmluZ0hlbHBlcihkZXNjcmlwdG9yLCBjb250ZXh0KSB7XG4gIHRocm93IG5ldyBFcnJvcignRGVjb3JhdGluZyBjbGFzcyBwcm9wZXJ0eSBmYWlsZWQuIFBsZWFzZSBlbnN1cmUgdGhhdCAnICsgJ3RyYW5zZm9ybS1jbGFzcy1wcm9wZXJ0aWVzIGlzIGVuYWJsZWQgYW5kIHJ1bnMgYWZ0ZXIgdGhlIGRlY29yYXRvcnMgdHJhbnNmb3JtLicpO1xufVxuZnVuY3Rpb24gX2luaXRpYWxpemVyRGVmaW5lUHJvcGVydHkodGFyZ2V0LCBwcm9wZXJ0eSwgZGVzY3JpcHRvciwgY29udGV4dCkge1xuICBpZiAoIWRlc2NyaXB0b3IpIHJldHVybjtcbiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgcHJvcGVydHksIHtcbiAgICBlbnVtZXJhYmxlOiBkZXNjcmlwdG9yLmVudW1lcmFibGUsXG4gICAgY29uZmlndXJhYmxlOiBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSxcbiAgICB3cml0YWJsZTogZGVzY3JpcHRvci53cml0YWJsZSxcbiAgICB2YWx1ZTogZGVzY3JpcHRvci5pbml0aWFsaXplciA/IGRlc2NyaXB0b3IuaW5pdGlhbGl6ZXIuY2FsbChjb250ZXh0KSA6IHZvaWQgMFxuICB9KTtcbn1cbmZ1bmN0aW9uIF9hcHBseURlY29yYXRlZERlc2NyaXB0b3IodGFyZ2V0LCBwcm9wZXJ0eSwgZGVjb3JhdG9ycywgZGVzY3JpcHRvciwgY29udGV4dCkge1xuICB2YXIgZGVzYyA9IHt9O1xuICBPYmplY3Qua2V5cyhkZXNjcmlwdG9yKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcbiAgICBkZXNjW2tleV0gPSBkZXNjcmlwdG9yW2tleV07XG4gIH0pO1xuICBkZXNjLmVudW1lcmFibGUgPSAhIWRlc2MuZW51bWVyYWJsZTtcbiAgZGVzYy5jb25maWd1cmFibGUgPSAhIWRlc2MuY29uZmlndXJhYmxlO1xuICBpZiAoJ3ZhbHVlJyBpbiBkZXNjIHx8IGRlc2MuaW5pdGlhbGl6ZXIpIHtcbiAgICBkZXNjLndyaXRhYmxlID0gdHJ1ZTtcbiAgfVxuICBkZXNjID0gZGVjb3JhdG9ycy5zbGljZSgpLnJldmVyc2UoKS5yZWR1Y2UoZnVuY3Rpb24gKGRlc2MsIGRlY29yYXRvcikge1xuICAgIHJldHVybiBkZWNvcmF0b3IodGFyZ2V0LCBwcm9wZXJ0eSwgZGVzYykgfHwgZGVzYztcbiAgfSwgZGVzYyk7XG4gIGlmIChjb250ZXh0ICYmIGRlc2MuaW5pdGlhbGl6ZXIgIT09IHZvaWQgMCkge1xuICAgIGRlc2MudmFsdWUgPSBkZXNjLmluaXRpYWxpemVyID8gZGVzYy5pbml0aWFsaXplci5jYWxsKGNvbnRleHQpIDogdm9pZCAwO1xuICAgIGRlc2MuaW5pdGlhbGl6ZXIgPSB1bmRlZmluZWQ7XG4gIH1cbiAgaWYgKGRlc2MuaW5pdGlhbGl6ZXIgPT09IHZvaWQgMCkge1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIHByb3BlcnR5LCBkZXNjKTtcbiAgICBkZXNjID0gbnVsbDtcbiAgfVxuICByZXR1cm4gZGVzYztcbn1cbnZhciBpZCA9IDA7XG5mdW5jdGlvbiBfY2xhc3NQcml2YXRlRmllbGRMb29zZUtleShuYW1lKSB7XG4gIHJldHVybiBcIl9fcHJpdmF0ZV9cIiArIGlkKysgKyBcIl9cIiArIG5hbWU7XG59XG5mdW5jdGlvbiBfY2xhc3NQcml2YXRlRmllbGRMb29zZUJhc2UocmVjZWl2ZXIsIHByaXZhdGVLZXkpIHtcbiAgaWYgKCFPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocmVjZWl2ZXIsIHByaXZhdGVLZXkpKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcImF0dGVtcHRlZCB0byB1c2UgcHJpdmF0ZSBmaWVsZCBvbiBub24taW5zdGFuY2VcIik7XG4gIH1cbiAgcmV0dXJuIHJlY2VpdmVyO1xufVxuZnVuY3Rpb24gX2NsYXNzUHJpdmF0ZUZpZWxkR2V0KHJlY2VpdmVyLCBwcml2YXRlTWFwKSB7XG4gIHZhciBkZXNjcmlwdG9yID0gX2NsYXNzRXh0cmFjdEZpZWxkRGVzY3JpcHRvcihyZWNlaXZlciwgcHJpdmF0ZU1hcCwgXCJnZXRcIik7XG4gIHJldHVybiBfY2xhc3NBcHBseURlc2NyaXB0b3JHZXQocmVjZWl2ZXIsIGRlc2NyaXB0b3IpO1xufVxuZnVuY3Rpb24gX2NsYXNzUHJpdmF0ZUZpZWxkU2V0KHJlY2VpdmVyLCBwcml2YXRlTWFwLCB2YWx1ZSkge1xuICB2YXIgZGVzY3JpcHRvciA9IF9jbGFzc0V4dHJhY3RGaWVsZERlc2NyaXB0b3IocmVjZWl2ZXIsIHByaXZhdGVNYXAsIFwic2V0XCIpO1xuICBfY2xhc3NBcHBseURlc2NyaXB0b3JTZXQocmVjZWl2ZXIsIGRlc2NyaXB0b3IsIHZhbHVlKTtcbiAgcmV0dXJuIHZhbHVlO1xufVxuZnVuY3Rpb24gX2NsYXNzUHJpdmF0ZUZpZWxkRGVzdHJ1Y3R1cmVTZXQocmVjZWl2ZXIsIHByaXZhdGVNYXApIHtcbiAgdmFyIGRlc2NyaXB0b3IgPSBfY2xhc3NFeHRyYWN0RmllbGREZXNjcmlwdG9yKHJlY2VpdmVyLCBwcml2YXRlTWFwLCBcInNldFwiKTtcbiAgcmV0dXJuIF9jbGFzc0FwcGx5RGVzY3JpcHRvckRlc3RydWN0dXJlU2V0KHJlY2VpdmVyLCBkZXNjcmlwdG9yKTtcbn1cbmZ1bmN0aW9uIF9jbGFzc0V4dHJhY3RGaWVsZERlc2NyaXB0b3IocmVjZWl2ZXIsIHByaXZhdGVNYXAsIGFjdGlvbikge1xuICBpZiAoIXByaXZhdGVNYXAuaGFzKHJlY2VpdmVyKSkge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJhdHRlbXB0ZWQgdG8gXCIgKyBhY3Rpb24gKyBcIiBwcml2YXRlIGZpZWxkIG9uIG5vbi1pbnN0YW5jZVwiKTtcbiAgfVxuICByZXR1cm4gcHJpdmF0ZU1hcC5nZXQocmVjZWl2ZXIpO1xufVxuZnVuY3Rpb24gX2NsYXNzU3RhdGljUHJpdmF0ZUZpZWxkU3BlY0dldChyZWNlaXZlciwgY2xhc3NDb25zdHJ1Y3RvciwgZGVzY3JpcHRvcikge1xuICBfY2xhc3NDaGVja1ByaXZhdGVTdGF0aWNBY2Nlc3MocmVjZWl2ZXIsIGNsYXNzQ29uc3RydWN0b3IpO1xuICBfY2xhc3NDaGVja1ByaXZhdGVTdGF0aWNGaWVsZERlc2NyaXB0b3IoZGVzY3JpcHRvciwgXCJnZXRcIik7XG4gIHJldHVybiBfY2xhc3NBcHBseURlc2NyaXB0b3JHZXQocmVjZWl2ZXIsIGRlc2NyaXB0b3IpO1xufVxuZnVuY3Rpb24gX2NsYXNzU3RhdGljUHJpdmF0ZUZpZWxkU3BlY1NldChyZWNlaXZlciwgY2xhc3NDb25zdHJ1Y3RvciwgZGVzY3JpcHRvciwgdmFsdWUpIHtcbiAgX2NsYXNzQ2hlY2tQcml2YXRlU3RhdGljQWNjZXNzKHJlY2VpdmVyLCBjbGFzc0NvbnN0cnVjdG9yKTtcbiAgX2NsYXNzQ2hlY2tQcml2YXRlU3RhdGljRmllbGREZXNjcmlwdG9yKGRlc2NyaXB0b3IsIFwic2V0XCIpO1xuICBfY2xhc3NBcHBseURlc2NyaXB0b3JTZXQocmVjZWl2ZXIsIGRlc2NyaXB0b3IsIHZhbHVlKTtcbiAgcmV0dXJuIHZhbHVlO1xufVxuZnVuY3Rpb24gX2NsYXNzU3RhdGljUHJpdmF0ZU1ldGhvZEdldChyZWNlaXZlciwgY2xhc3NDb25zdHJ1Y3RvciwgbWV0aG9kKSB7XG4gIF9jbGFzc0NoZWNrUHJpdmF0ZVN0YXRpY0FjY2VzcyhyZWNlaXZlciwgY2xhc3NDb25zdHJ1Y3Rvcik7XG4gIHJldHVybiBtZXRob2Q7XG59XG5mdW5jdGlvbiBfY2xhc3NTdGF0aWNQcml2YXRlTWV0aG9kU2V0KCkge1xuICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiYXR0ZW1wdGVkIHRvIHNldCByZWFkIG9ubHkgc3RhdGljIHByaXZhdGUgZmllbGRcIik7XG59XG5mdW5jdGlvbiBfY2xhc3NBcHBseURlc2NyaXB0b3JHZXQocmVjZWl2ZXIsIGRlc2NyaXB0b3IpIHtcbiAgaWYgKGRlc2NyaXB0b3IuZ2V0KSB7XG4gICAgcmV0dXJuIGRlc2NyaXB0b3IuZ2V0LmNhbGwocmVjZWl2ZXIpO1xuICB9XG4gIHJldHVybiBkZXNjcmlwdG9yLnZhbHVlO1xufVxuZnVuY3Rpb24gX2NsYXNzQXBwbHlEZXNjcmlwdG9yU2V0KHJlY2VpdmVyLCBkZXNjcmlwdG9yLCB2YWx1ZSkge1xuICBpZiAoZGVzY3JpcHRvci5zZXQpIHtcbiAgICBkZXNjcmlwdG9yLnNldC5jYWxsKHJlY2VpdmVyLCB2YWx1ZSk7XG4gIH0gZWxzZSB7XG4gICAgaWYgKCFkZXNjcmlwdG9yLndyaXRhYmxlKSB7XG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiYXR0ZW1wdGVkIHRvIHNldCByZWFkIG9ubHkgcHJpdmF0ZSBmaWVsZFwiKTtcbiAgICB9XG4gICAgZGVzY3JpcHRvci52YWx1ZSA9IHZhbHVlO1xuICB9XG59XG5mdW5jdGlvbiBfY2xhc3NBcHBseURlc2NyaXB0b3JEZXN0cnVjdHVyZVNldChyZWNlaXZlciwgZGVzY3JpcHRvcikge1xuICBpZiAoZGVzY3JpcHRvci5zZXQpIHtcbiAgICBpZiAoIShcIl9fZGVzdHJPYmpcIiBpbiBkZXNjcmlwdG9yKSkge1xuICAgICAgZGVzY3JpcHRvci5fX2Rlc3RyT2JqID0ge1xuICAgICAgICBzZXQgdmFsdWUodikge1xuICAgICAgICAgIGRlc2NyaXB0b3Iuc2V0LmNhbGwocmVjZWl2ZXIsIHYpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgIH1cbiAgICByZXR1cm4gZGVzY3JpcHRvci5fX2Rlc3RyT2JqO1xuICB9IGVsc2Uge1xuICAgIGlmICghZGVzY3JpcHRvci53cml0YWJsZSkge1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcImF0dGVtcHRlZCB0byBzZXQgcmVhZCBvbmx5IHByaXZhdGUgZmllbGRcIik7XG4gICAgfVxuICAgIHJldHVybiBkZXNjcmlwdG9yO1xuICB9XG59XG5mdW5jdGlvbiBfY2xhc3NTdGF0aWNQcml2YXRlRmllbGREZXN0cnVjdHVyZVNldChyZWNlaXZlciwgY2xhc3NDb25zdHJ1Y3RvciwgZGVzY3JpcHRvcikge1xuICBfY2xhc3NDaGVja1ByaXZhdGVTdGF0aWNBY2Nlc3MocmVjZWl2ZXIsIGNsYXNzQ29uc3RydWN0b3IpO1xuICBfY2xhc3NDaGVja1ByaXZhdGVTdGF0aWNGaWVsZERlc2NyaXB0b3IoZGVzY3JpcHRvciwgXCJzZXRcIik7XG4gIHJldHVybiBfY2xhc3NBcHBseURlc2NyaXB0b3JEZXN0cnVjdHVyZVNldChyZWNlaXZlciwgZGVzY3JpcHRvcik7XG59XG5mdW5jdGlvbiBfY2xhc3NDaGVja1ByaXZhdGVTdGF0aWNBY2Nlc3MocmVjZWl2ZXIsIGNsYXNzQ29uc3RydWN0b3IpIHtcbiAgaWYgKHJlY2VpdmVyICE9PSBjbGFzc0NvbnN0cnVjdG9yKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlByaXZhdGUgc3RhdGljIGFjY2VzcyBvZiB3cm9uZyBwcm92ZW5hbmNlXCIpO1xuICB9XG59XG5mdW5jdGlvbiBfY2xhc3NDaGVja1ByaXZhdGVTdGF0aWNGaWVsZERlc2NyaXB0b3IoZGVzY3JpcHRvciwgYWN0aW9uKSB7XG4gIGlmIChkZXNjcmlwdG9yID09PSB1bmRlZmluZWQpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiYXR0ZW1wdGVkIHRvIFwiICsgYWN0aW9uICsgXCIgcHJpdmF0ZSBzdGF0aWMgZmllbGQgYmVmb3JlIGl0cyBkZWNsYXJhdGlvblwiKTtcbiAgfVxufVxuZnVuY3Rpb24gX2RlY29yYXRlKGRlY29yYXRvcnMsIGZhY3RvcnksIHN1cGVyQ2xhc3MsIG1peGlucykge1xuICB2YXIgYXBpID0gX2dldERlY29yYXRvcnNBcGkoKTtcbiAgaWYgKG1peGlucykge1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbWl4aW5zLmxlbmd0aDsgaSsrKSB7XG4gICAgICBhcGkgPSBtaXhpbnNbaV0oYXBpKTtcbiAgICB9XG4gIH1cbiAgdmFyIHIgPSBmYWN0b3J5KGZ1bmN0aW9uIGluaXRpYWxpemUoTykge1xuICAgIGFwaS5pbml0aWFsaXplSW5zdGFuY2VFbGVtZW50cyhPLCBkZWNvcmF0ZWQuZWxlbWVudHMpO1xuICB9LCBzdXBlckNsYXNzKTtcbiAgdmFyIGRlY29yYXRlZCA9IGFwaS5kZWNvcmF0ZUNsYXNzKF9jb2FsZXNjZUNsYXNzRWxlbWVudHMoci5kLm1hcChfY3JlYXRlRWxlbWVudERlc2NyaXB0b3IpKSwgZGVjb3JhdG9ycyk7XG4gIGFwaS5pbml0aWFsaXplQ2xhc3NFbGVtZW50cyhyLkYsIGRlY29yYXRlZC5lbGVtZW50cyk7XG4gIHJldHVybiBhcGkucnVuQ2xhc3NGaW5pc2hlcnMoci5GLCBkZWNvcmF0ZWQuZmluaXNoZXJzKTtcbn1cbmZ1bmN0aW9uIF9nZXREZWNvcmF0b3JzQXBpKCkge1xuICBfZ2V0RGVjb3JhdG9yc0FwaSA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gYXBpO1xuICB9O1xuICB2YXIgYXBpID0ge1xuICAgIGVsZW1lbnRzRGVmaW5pdGlvbk9yZGVyOiBbW1wibWV0aG9kXCJdLCBbXCJmaWVsZFwiXV0sXG4gICAgaW5pdGlhbGl6ZUluc3RhbmNlRWxlbWVudHM6IGZ1bmN0aW9uIChPLCBlbGVtZW50cykge1xuICAgICAgW1wibWV0aG9kXCIsIFwiZmllbGRcIl0uZm9yRWFjaChmdW5jdGlvbiAoa2luZCkge1xuICAgICAgICBlbGVtZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgICAgICAgaWYgKGVsZW1lbnQua2luZCA9PT0ga2luZCAmJiBlbGVtZW50LnBsYWNlbWVudCA9PT0gXCJvd25cIikge1xuICAgICAgICAgICAgdGhpcy5kZWZpbmVDbGFzc0VsZW1lbnQoTywgZWxlbWVudCk7XG4gICAgICAgICAgfVxuICAgICAgICB9LCB0aGlzKTtcbiAgICAgIH0sIHRoaXMpO1xuICAgIH0sXG4gICAgaW5pdGlhbGl6ZUNsYXNzRWxlbWVudHM6IGZ1bmN0aW9uIChGLCBlbGVtZW50cykge1xuICAgICAgdmFyIHByb3RvID0gRi5wcm90b3R5cGU7XG4gICAgICBbXCJtZXRob2RcIiwgXCJmaWVsZFwiXS5mb3JFYWNoKGZ1bmN0aW9uIChraW5kKSB7XG4gICAgICAgIGVsZW1lbnRzLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgICAgICB2YXIgcGxhY2VtZW50ID0gZWxlbWVudC5wbGFjZW1lbnQ7XG4gICAgICAgICAgaWYgKGVsZW1lbnQua2luZCA9PT0ga2luZCAmJiAocGxhY2VtZW50ID09PSBcInN0YXRpY1wiIHx8IHBsYWNlbWVudCA9PT0gXCJwcm90b3R5cGVcIikpIHtcbiAgICAgICAgICAgIHZhciByZWNlaXZlciA9IHBsYWNlbWVudCA9PT0gXCJzdGF0aWNcIiA/IEYgOiBwcm90bztcbiAgICAgICAgICAgIHRoaXMuZGVmaW5lQ2xhc3NFbGVtZW50KHJlY2VpdmVyLCBlbGVtZW50KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sIHRoaXMpO1xuICAgICAgfSwgdGhpcyk7XG4gICAgfSxcbiAgICBkZWZpbmVDbGFzc0VsZW1lbnQ6IGZ1bmN0aW9uIChyZWNlaXZlciwgZWxlbWVudCkge1xuICAgICAgdmFyIGRlc2NyaXB0b3IgPSBlbGVtZW50LmRlc2NyaXB0b3I7XG4gICAgICBpZiAoZWxlbWVudC5raW5kID09PSBcImZpZWxkXCIpIHtcbiAgICAgICAgdmFyIGluaXRpYWxpemVyID0gZWxlbWVudC5pbml0aWFsaXplcjtcbiAgICAgICAgZGVzY3JpcHRvciA9IHtcbiAgICAgICAgICBlbnVtZXJhYmxlOiBkZXNjcmlwdG9yLmVudW1lcmFibGUsXG4gICAgICAgICAgd3JpdGFibGU6IGRlc2NyaXB0b3Iud3JpdGFibGUsXG4gICAgICAgICAgY29uZmlndXJhYmxlOiBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSxcbiAgICAgICAgICB2YWx1ZTogaW5pdGlhbGl6ZXIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGluaXRpYWxpemVyLmNhbGwocmVjZWl2ZXIpXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkocmVjZWl2ZXIsIGVsZW1lbnQua2V5LCBkZXNjcmlwdG9yKTtcbiAgICB9LFxuICAgIGRlY29yYXRlQ2xhc3M6IGZ1bmN0aW9uIChlbGVtZW50cywgZGVjb3JhdG9ycykge1xuICAgICAgdmFyIG5ld0VsZW1lbnRzID0gW107XG4gICAgICB2YXIgZmluaXNoZXJzID0gW107XG4gICAgICB2YXIgcGxhY2VtZW50cyA9IHtcbiAgICAgICAgc3RhdGljOiBbXSxcbiAgICAgICAgcHJvdG90eXBlOiBbXSxcbiAgICAgICAgb3duOiBbXVxuICAgICAgfTtcbiAgICAgIGVsZW1lbnRzLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgICAgdGhpcy5hZGRFbGVtZW50UGxhY2VtZW50KGVsZW1lbnQsIHBsYWNlbWVudHMpO1xuICAgICAgfSwgdGhpcyk7XG4gICAgICBlbGVtZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgICAgIGlmICghX2hhc0RlY29yYXRvcnMoZWxlbWVudCkpIHJldHVybiBuZXdFbGVtZW50cy5wdXNoKGVsZW1lbnQpO1xuICAgICAgICB2YXIgZWxlbWVudEZpbmlzaGVyc0V4dHJhcyA9IHRoaXMuZGVjb3JhdGVFbGVtZW50KGVsZW1lbnQsIHBsYWNlbWVudHMpO1xuICAgICAgICBuZXdFbGVtZW50cy5wdXNoKGVsZW1lbnRGaW5pc2hlcnNFeHRyYXMuZWxlbWVudCk7XG4gICAgICAgIG5ld0VsZW1lbnRzLnB1c2guYXBwbHkobmV3RWxlbWVudHMsIGVsZW1lbnRGaW5pc2hlcnNFeHRyYXMuZXh0cmFzKTtcbiAgICAgICAgZmluaXNoZXJzLnB1c2guYXBwbHkoZmluaXNoZXJzLCBlbGVtZW50RmluaXNoZXJzRXh0cmFzLmZpbmlzaGVycyk7XG4gICAgICB9LCB0aGlzKTtcbiAgICAgIGlmICghZGVjb3JhdG9ycykge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGVsZW1lbnRzOiBuZXdFbGVtZW50cyxcbiAgICAgICAgICBmaW5pc2hlcnM6IGZpbmlzaGVyc1xuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgdmFyIHJlc3VsdCA9IHRoaXMuZGVjb3JhdGVDb25zdHJ1Y3RvcihuZXdFbGVtZW50cywgZGVjb3JhdG9ycyk7XG4gICAgICBmaW5pc2hlcnMucHVzaC5hcHBseShmaW5pc2hlcnMsIHJlc3VsdC5maW5pc2hlcnMpO1xuICAgICAgcmVzdWx0LmZpbmlzaGVycyA9IGZpbmlzaGVycztcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSxcbiAgICBhZGRFbGVtZW50UGxhY2VtZW50OiBmdW5jdGlvbiAoZWxlbWVudCwgcGxhY2VtZW50cywgc2lsZW50KSB7XG4gICAgICB2YXIga2V5cyA9IHBsYWNlbWVudHNbZWxlbWVudC5wbGFjZW1lbnRdO1xuICAgICAgaWYgKCFzaWxlbnQgJiYga2V5cy5pbmRleE9mKGVsZW1lbnQua2V5KSAhPT0gLTEpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkR1cGxpY2F0ZWQgZWxlbWVudCAoXCIgKyBlbGVtZW50LmtleSArIFwiKVwiKTtcbiAgICAgIH1cbiAgICAgIGtleXMucHVzaChlbGVtZW50LmtleSk7XG4gICAgfSxcbiAgICBkZWNvcmF0ZUVsZW1lbnQ6IGZ1bmN0aW9uIChlbGVtZW50LCBwbGFjZW1lbnRzKSB7XG4gICAgICB2YXIgZXh0cmFzID0gW107XG4gICAgICB2YXIgZmluaXNoZXJzID0gW107XG4gICAgICBmb3IgKHZhciBkZWNvcmF0b3JzID0gZWxlbWVudC5kZWNvcmF0b3JzLCBpID0gZGVjb3JhdG9ycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICB2YXIga2V5cyA9IHBsYWNlbWVudHNbZWxlbWVudC5wbGFjZW1lbnRdO1xuICAgICAgICBrZXlzLnNwbGljZShrZXlzLmluZGV4T2YoZWxlbWVudC5rZXkpLCAxKTtcbiAgICAgICAgdmFyIGVsZW1lbnRPYmplY3QgPSB0aGlzLmZyb21FbGVtZW50RGVzY3JpcHRvcihlbGVtZW50KTtcbiAgICAgICAgdmFyIGVsZW1lbnRGaW5pc2hlckV4dHJhcyA9IHRoaXMudG9FbGVtZW50RmluaXNoZXJFeHRyYXMoKDAsIGRlY29yYXRvcnNbaV0pKGVsZW1lbnRPYmplY3QpIHx8IGVsZW1lbnRPYmplY3QpO1xuICAgICAgICBlbGVtZW50ID0gZWxlbWVudEZpbmlzaGVyRXh0cmFzLmVsZW1lbnQ7XG4gICAgICAgIHRoaXMuYWRkRWxlbWVudFBsYWNlbWVudChlbGVtZW50LCBwbGFjZW1lbnRzKTtcbiAgICAgICAgaWYgKGVsZW1lbnRGaW5pc2hlckV4dHJhcy5maW5pc2hlcikge1xuICAgICAgICAgIGZpbmlzaGVycy5wdXNoKGVsZW1lbnRGaW5pc2hlckV4dHJhcy5maW5pc2hlcik7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG5ld0V4dHJhcyA9IGVsZW1lbnRGaW5pc2hlckV4dHJhcy5leHRyYXM7XG4gICAgICAgIGlmIChuZXdFeHRyYXMpIHtcbiAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IG5ld0V4dHJhcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgdGhpcy5hZGRFbGVtZW50UGxhY2VtZW50KG5ld0V4dHJhc1tqXSwgcGxhY2VtZW50cyk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGV4dHJhcy5wdXNoLmFwcGx5KGV4dHJhcywgbmV3RXh0cmFzKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgZWxlbWVudDogZWxlbWVudCxcbiAgICAgICAgZmluaXNoZXJzOiBmaW5pc2hlcnMsXG4gICAgICAgIGV4dHJhczogZXh0cmFzXG4gICAgICB9O1xuICAgIH0sXG4gICAgZGVjb3JhdGVDb25zdHJ1Y3RvcjogZnVuY3Rpb24gKGVsZW1lbnRzLCBkZWNvcmF0b3JzKSB7XG4gICAgICB2YXIgZmluaXNoZXJzID0gW107XG4gICAgICBmb3IgKHZhciBpID0gZGVjb3JhdG9ycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICB2YXIgb2JqID0gdGhpcy5mcm9tQ2xhc3NEZXNjcmlwdG9yKGVsZW1lbnRzKTtcbiAgICAgICAgdmFyIGVsZW1lbnRzQW5kRmluaXNoZXIgPSB0aGlzLnRvQ2xhc3NEZXNjcmlwdG9yKCgwLCBkZWNvcmF0b3JzW2ldKShvYmopIHx8IG9iaik7XG4gICAgICAgIGlmIChlbGVtZW50c0FuZEZpbmlzaGVyLmZpbmlzaGVyICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICBmaW5pc2hlcnMucHVzaChlbGVtZW50c0FuZEZpbmlzaGVyLmZpbmlzaGVyKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZWxlbWVudHNBbmRGaW5pc2hlci5lbGVtZW50cyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgZWxlbWVudHMgPSBlbGVtZW50c0FuZEZpbmlzaGVyLmVsZW1lbnRzO1xuICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgZWxlbWVudHMubGVuZ3RoIC0gMTsgaisrKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBrID0gaiArIDE7IGsgPCBlbGVtZW50cy5sZW5ndGg7IGsrKykge1xuICAgICAgICAgICAgICBpZiAoZWxlbWVudHNbal0ua2V5ID09PSBlbGVtZW50c1trXS5rZXkgJiYgZWxlbWVudHNbal0ucGxhY2VtZW50ID09PSBlbGVtZW50c1trXS5wbGFjZW1lbnQpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiRHVwbGljYXRlZCBlbGVtZW50IChcIiArIGVsZW1lbnRzW2pdLmtleSArIFwiKVwiKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgZWxlbWVudHM6IGVsZW1lbnRzLFxuICAgICAgICBmaW5pc2hlcnM6IGZpbmlzaGVyc1xuICAgICAgfTtcbiAgICB9LFxuICAgIGZyb21FbGVtZW50RGVzY3JpcHRvcjogZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgIHZhciBvYmogPSB7XG4gICAgICAgIGtpbmQ6IGVsZW1lbnQua2luZCxcbiAgICAgICAga2V5OiBlbGVtZW50LmtleSxcbiAgICAgICAgcGxhY2VtZW50OiBlbGVtZW50LnBsYWNlbWVudCxcbiAgICAgICAgZGVzY3JpcHRvcjogZWxlbWVudC5kZXNjcmlwdG9yXG4gICAgICB9O1xuICAgICAgdmFyIGRlc2MgPSB7XG4gICAgICAgIHZhbHVlOiBcIkRlc2NyaXB0b3JcIixcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICB9O1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwgU3ltYm9sLnRvU3RyaW5nVGFnLCBkZXNjKTtcbiAgICAgIGlmIChlbGVtZW50LmtpbmQgPT09IFwiZmllbGRcIikgb2JqLmluaXRpYWxpemVyID0gZWxlbWVudC5pbml0aWFsaXplcjtcbiAgICAgIHJldHVybiBvYmo7XG4gICAgfSxcbiAgICB0b0VsZW1lbnREZXNjcmlwdG9yczogZnVuY3Rpb24gKGVsZW1lbnRPYmplY3RzKSB7XG4gICAgICBpZiAoZWxlbWVudE9iamVjdHMgPT09IHVuZGVmaW5lZCkgcmV0dXJuO1xuICAgICAgcmV0dXJuIF90b0FycmF5KGVsZW1lbnRPYmplY3RzKS5tYXAoZnVuY3Rpb24gKGVsZW1lbnRPYmplY3QpIHtcbiAgICAgICAgdmFyIGVsZW1lbnQgPSB0aGlzLnRvRWxlbWVudERlc2NyaXB0b3IoZWxlbWVudE9iamVjdCk7XG4gICAgICAgIHRoaXMuZGlzYWxsb3dQcm9wZXJ0eShlbGVtZW50T2JqZWN0LCBcImZpbmlzaGVyXCIsIFwiQW4gZWxlbWVudCBkZXNjcmlwdG9yXCIpO1xuICAgICAgICB0aGlzLmRpc2FsbG93UHJvcGVydHkoZWxlbWVudE9iamVjdCwgXCJleHRyYXNcIiwgXCJBbiBlbGVtZW50IGRlc2NyaXB0b3JcIik7XG4gICAgICAgIHJldHVybiBlbGVtZW50O1xuICAgICAgfSwgdGhpcyk7XG4gICAgfSxcbiAgICB0b0VsZW1lbnREZXNjcmlwdG9yOiBmdW5jdGlvbiAoZWxlbWVudE9iamVjdCkge1xuICAgICAgdmFyIGtpbmQgPSBTdHJpbmcoZWxlbWVudE9iamVjdC5raW5kKTtcbiAgICAgIGlmIChraW5kICE9PSBcIm1ldGhvZFwiICYmIGtpbmQgIT09IFwiZmllbGRcIikge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdBbiBlbGVtZW50IGRlc2NyaXB0b3JcXCdzIC5raW5kIHByb3BlcnR5IG11c3QgYmUgZWl0aGVyIFwibWV0aG9kXCIgb3InICsgJyBcImZpZWxkXCIsIGJ1dCBhIGRlY29yYXRvciBjcmVhdGVkIGFuIGVsZW1lbnQgZGVzY3JpcHRvciB3aXRoJyArICcgLmtpbmQgXCInICsga2luZCArICdcIicpO1xuICAgICAgfVxuICAgICAgdmFyIGtleSA9IF90b1Byb3BlcnR5S2V5KGVsZW1lbnRPYmplY3Qua2V5KTtcbiAgICAgIHZhciBwbGFjZW1lbnQgPSBTdHJpbmcoZWxlbWVudE9iamVjdC5wbGFjZW1lbnQpO1xuICAgICAgaWYgKHBsYWNlbWVudCAhPT0gXCJzdGF0aWNcIiAmJiBwbGFjZW1lbnQgIT09IFwicHJvdG90eXBlXCIgJiYgcGxhY2VtZW50ICE9PSBcIm93blwiKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0FuIGVsZW1lbnQgZGVzY3JpcHRvclxcJ3MgLnBsYWNlbWVudCBwcm9wZXJ0eSBtdXN0IGJlIG9uZSBvZiBcInN0YXRpY1wiLCcgKyAnIFwicHJvdG90eXBlXCIgb3IgXCJvd25cIiwgYnV0IGEgZGVjb3JhdG9yIGNyZWF0ZWQgYW4gZWxlbWVudCBkZXNjcmlwdG9yJyArICcgd2l0aCAucGxhY2VtZW50IFwiJyArIHBsYWNlbWVudCArICdcIicpO1xuICAgICAgfVxuICAgICAgdmFyIGRlc2NyaXB0b3IgPSBlbGVtZW50T2JqZWN0LmRlc2NyaXB0b3I7XG4gICAgICB0aGlzLmRpc2FsbG93UHJvcGVydHkoZWxlbWVudE9iamVjdCwgXCJlbGVtZW50c1wiLCBcIkFuIGVsZW1lbnQgZGVzY3JpcHRvclwiKTtcbiAgICAgIHZhciBlbGVtZW50ID0ge1xuICAgICAgICBraW5kOiBraW5kLFxuICAgICAgICBrZXk6IGtleSxcbiAgICAgICAgcGxhY2VtZW50OiBwbGFjZW1lbnQsXG4gICAgICAgIGRlc2NyaXB0b3I6IE9iamVjdC5hc3NpZ24oe30sIGRlc2NyaXB0b3IpXG4gICAgICB9O1xuICAgICAgaWYgKGtpbmQgIT09IFwiZmllbGRcIikge1xuICAgICAgICB0aGlzLmRpc2FsbG93UHJvcGVydHkoZWxlbWVudE9iamVjdCwgXCJpbml0aWFsaXplclwiLCBcIkEgbWV0aG9kIGRlc2NyaXB0b3JcIik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmRpc2FsbG93UHJvcGVydHkoZGVzY3JpcHRvciwgXCJnZXRcIiwgXCJUaGUgcHJvcGVydHkgZGVzY3JpcHRvciBvZiBhIGZpZWxkIGRlc2NyaXB0b3JcIik7XG4gICAgICAgIHRoaXMuZGlzYWxsb3dQcm9wZXJ0eShkZXNjcmlwdG9yLCBcInNldFwiLCBcIlRoZSBwcm9wZXJ0eSBkZXNjcmlwdG9yIG9mIGEgZmllbGQgZGVzY3JpcHRvclwiKTtcbiAgICAgICAgdGhpcy5kaXNhbGxvd1Byb3BlcnR5KGRlc2NyaXB0b3IsIFwidmFsdWVcIiwgXCJUaGUgcHJvcGVydHkgZGVzY3JpcHRvciBvZiBhIGZpZWxkIGRlc2NyaXB0b3JcIik7XG4gICAgICAgIGVsZW1lbnQuaW5pdGlhbGl6ZXIgPSBlbGVtZW50T2JqZWN0LmluaXRpYWxpemVyO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGVsZW1lbnQ7XG4gICAgfSxcbiAgICB0b0VsZW1lbnRGaW5pc2hlckV4dHJhczogZnVuY3Rpb24gKGVsZW1lbnRPYmplY3QpIHtcbiAgICAgIHZhciBlbGVtZW50ID0gdGhpcy50b0VsZW1lbnREZXNjcmlwdG9yKGVsZW1lbnRPYmplY3QpO1xuICAgICAgdmFyIGZpbmlzaGVyID0gX29wdGlvbmFsQ2FsbGFibGVQcm9wZXJ0eShlbGVtZW50T2JqZWN0LCBcImZpbmlzaGVyXCIpO1xuICAgICAgdmFyIGV4dHJhcyA9IHRoaXMudG9FbGVtZW50RGVzY3JpcHRvcnMoZWxlbWVudE9iamVjdC5leHRyYXMpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgZWxlbWVudDogZWxlbWVudCxcbiAgICAgICAgZmluaXNoZXI6IGZpbmlzaGVyLFxuICAgICAgICBleHRyYXM6IGV4dHJhc1xuICAgICAgfTtcbiAgICB9LFxuICAgIGZyb21DbGFzc0Rlc2NyaXB0b3I6IGZ1bmN0aW9uIChlbGVtZW50cykge1xuICAgICAgdmFyIG9iaiA9IHtcbiAgICAgICAga2luZDogXCJjbGFzc1wiLFxuICAgICAgICBlbGVtZW50czogZWxlbWVudHMubWFwKHRoaXMuZnJvbUVsZW1lbnREZXNjcmlwdG9yLCB0aGlzKVxuICAgICAgfTtcbiAgICAgIHZhciBkZXNjID0ge1xuICAgICAgICB2YWx1ZTogXCJEZXNjcmlwdG9yXCIsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgfTtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIFN5bWJvbC50b1N0cmluZ1RhZywgZGVzYyk7XG4gICAgICByZXR1cm4gb2JqO1xuICAgIH0sXG4gICAgdG9DbGFzc0Rlc2NyaXB0b3I6IGZ1bmN0aW9uIChvYmopIHtcbiAgICAgIHZhciBraW5kID0gU3RyaW5nKG9iai5raW5kKTtcbiAgICAgIGlmIChraW5kICE9PSBcImNsYXNzXCIpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQSBjbGFzcyBkZXNjcmlwdG9yXFwncyAua2luZCBwcm9wZXJ0eSBtdXN0IGJlIFwiY2xhc3NcIiwgYnV0IGEgZGVjb3JhdG9yJyArICcgY3JlYXRlZCBhIGNsYXNzIGRlc2NyaXB0b3Igd2l0aCAua2luZCBcIicgKyBraW5kICsgJ1wiJyk7XG4gICAgICB9XG4gICAgICB0aGlzLmRpc2FsbG93UHJvcGVydHkob2JqLCBcImtleVwiLCBcIkEgY2xhc3MgZGVzY3JpcHRvclwiKTtcbiAgICAgIHRoaXMuZGlzYWxsb3dQcm9wZXJ0eShvYmosIFwicGxhY2VtZW50XCIsIFwiQSBjbGFzcyBkZXNjcmlwdG9yXCIpO1xuICAgICAgdGhpcy5kaXNhbGxvd1Byb3BlcnR5KG9iaiwgXCJkZXNjcmlwdG9yXCIsIFwiQSBjbGFzcyBkZXNjcmlwdG9yXCIpO1xuICAgICAgdGhpcy5kaXNhbGxvd1Byb3BlcnR5KG9iaiwgXCJpbml0aWFsaXplclwiLCBcIkEgY2xhc3MgZGVzY3JpcHRvclwiKTtcbiAgICAgIHRoaXMuZGlzYWxsb3dQcm9wZXJ0eShvYmosIFwiZXh0cmFzXCIsIFwiQSBjbGFzcyBkZXNjcmlwdG9yXCIpO1xuICAgICAgdmFyIGZpbmlzaGVyID0gX29wdGlvbmFsQ2FsbGFibGVQcm9wZXJ0eShvYmosIFwiZmluaXNoZXJcIik7XG4gICAgICB2YXIgZWxlbWVudHMgPSB0aGlzLnRvRWxlbWVudERlc2NyaXB0b3JzKG9iai5lbGVtZW50cyk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBlbGVtZW50czogZWxlbWVudHMsXG4gICAgICAgIGZpbmlzaGVyOiBmaW5pc2hlclxuICAgICAgfTtcbiAgICB9LFxuICAgIHJ1bkNsYXNzRmluaXNoZXJzOiBmdW5jdGlvbiAoY29uc3RydWN0b3IsIGZpbmlzaGVycykge1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBmaW5pc2hlcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIG5ld0NvbnN0cnVjdG9yID0gKDAsIGZpbmlzaGVyc1tpXSkoY29uc3RydWN0b3IpO1xuICAgICAgICBpZiAobmV3Q29uc3RydWN0b3IgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIGlmICh0eXBlb2YgbmV3Q29uc3RydWN0b3IgIT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkZpbmlzaGVycyBtdXN0IHJldHVybiBhIGNvbnN0cnVjdG9yLlwiKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3RydWN0b3IgPSBuZXdDb25zdHJ1Y3RvcjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIGNvbnN0cnVjdG9yO1xuICAgIH0sXG4gICAgZGlzYWxsb3dQcm9wZXJ0eTogZnVuY3Rpb24gKG9iaiwgbmFtZSwgb2JqZWN0VHlwZSkge1xuICAgICAgaWYgKG9ialtuYW1lXSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3Iob2JqZWN0VHlwZSArIFwiIGNhbid0IGhhdmUgYSAuXCIgKyBuYW1lICsgXCIgcHJvcGVydHkuXCIpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcbiAgcmV0dXJuIGFwaTtcbn1cbmZ1bmN0aW9uIF9jcmVhdGVFbGVtZW50RGVzY3JpcHRvcihkZWYpIHtcbiAgdmFyIGtleSA9IF90b1Byb3BlcnR5S2V5KGRlZi5rZXkpO1xuICB2YXIgZGVzY3JpcHRvcjtcbiAgaWYgKGRlZi5raW5kID09PSBcIm1ldGhvZFwiKSB7XG4gICAgZGVzY3JpcHRvciA9IHtcbiAgICAgIHZhbHVlOiBkZWYudmFsdWUsXG4gICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgIGVudW1lcmFibGU6IGZhbHNlXG4gICAgfTtcbiAgfSBlbHNlIGlmIChkZWYua2luZCA9PT0gXCJnZXRcIikge1xuICAgIGRlc2NyaXB0b3IgPSB7XG4gICAgICBnZXQ6IGRlZi52YWx1ZSxcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgIGVudW1lcmFibGU6IGZhbHNlXG4gICAgfTtcbiAgfSBlbHNlIGlmIChkZWYua2luZCA9PT0gXCJzZXRcIikge1xuICAgIGRlc2NyaXB0b3IgPSB7XG4gICAgICBzZXQ6IGRlZi52YWx1ZSxcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgIGVudW1lcmFibGU6IGZhbHNlXG4gICAgfTtcbiAgfSBlbHNlIGlmIChkZWYua2luZCA9PT0gXCJmaWVsZFwiKSB7XG4gICAgZGVzY3JpcHRvciA9IHtcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgZW51bWVyYWJsZTogdHJ1ZVxuICAgIH07XG4gIH1cbiAgdmFyIGVsZW1lbnQgPSB7XG4gICAga2luZDogZGVmLmtpbmQgPT09IFwiZmllbGRcIiA/IFwiZmllbGRcIiA6IFwibWV0aG9kXCIsXG4gICAga2V5OiBrZXksXG4gICAgcGxhY2VtZW50OiBkZWYuc3RhdGljID8gXCJzdGF0aWNcIiA6IGRlZi5raW5kID09PSBcImZpZWxkXCIgPyBcIm93blwiIDogXCJwcm90b3R5cGVcIixcbiAgICBkZXNjcmlwdG9yOiBkZXNjcmlwdG9yXG4gIH07XG4gIGlmIChkZWYuZGVjb3JhdG9ycykgZWxlbWVudC5kZWNvcmF0b3JzID0gZGVmLmRlY29yYXRvcnM7XG4gIGlmIChkZWYua2luZCA9PT0gXCJmaWVsZFwiKSBlbGVtZW50LmluaXRpYWxpemVyID0gZGVmLnZhbHVlO1xuICByZXR1cm4gZWxlbWVudDtcbn1cbmZ1bmN0aW9uIF9jb2FsZXNjZUdldHRlclNldHRlcihlbGVtZW50LCBvdGhlcikge1xuICBpZiAoZWxlbWVudC5kZXNjcmlwdG9yLmdldCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgb3RoZXIuZGVzY3JpcHRvci5nZXQgPSBlbGVtZW50LmRlc2NyaXB0b3IuZ2V0O1xuICB9IGVsc2Uge1xuICAgIG90aGVyLmRlc2NyaXB0b3Iuc2V0ID0gZWxlbWVudC5kZXNjcmlwdG9yLnNldDtcbiAgfVxufVxuZnVuY3Rpb24gX2NvYWxlc2NlQ2xhc3NFbGVtZW50cyhlbGVtZW50cykge1xuICB2YXIgbmV3RWxlbWVudHMgPSBbXTtcbiAgdmFyIGlzU2FtZUVsZW1lbnQgPSBmdW5jdGlvbiAob3RoZXIpIHtcbiAgICByZXR1cm4gb3RoZXIua2luZCA9PT0gXCJtZXRob2RcIiAmJiBvdGhlci5rZXkgPT09IGVsZW1lbnQua2V5ICYmIG90aGVyLnBsYWNlbWVudCA9PT0gZWxlbWVudC5wbGFjZW1lbnQ7XG4gIH07XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgZWxlbWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIgZWxlbWVudCA9IGVsZW1lbnRzW2ldO1xuICAgIHZhciBvdGhlcjtcbiAgICBpZiAoZWxlbWVudC5raW5kID09PSBcIm1ldGhvZFwiICYmIChvdGhlciA9IG5ld0VsZW1lbnRzLmZpbmQoaXNTYW1lRWxlbWVudCkpKSB7XG4gICAgICBpZiAoX2lzRGF0YURlc2NyaXB0b3IoZWxlbWVudC5kZXNjcmlwdG9yKSB8fCBfaXNEYXRhRGVzY3JpcHRvcihvdGhlci5kZXNjcmlwdG9yKSkge1xuICAgICAgICBpZiAoX2hhc0RlY29yYXRvcnMoZWxlbWVudCkgfHwgX2hhc0RlY29yYXRvcnMob3RoZXIpKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwiRHVwbGljYXRlZCBtZXRob2RzIChcIiArIGVsZW1lbnQua2V5ICsgXCIpIGNhbid0IGJlIGRlY29yYXRlZC5cIik7XG4gICAgICAgIH1cbiAgICAgICAgb3RoZXIuZGVzY3JpcHRvciA9IGVsZW1lbnQuZGVzY3JpcHRvcjtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmIChfaGFzRGVjb3JhdG9ycyhlbGVtZW50KSkge1xuICAgICAgICAgIGlmIChfaGFzRGVjb3JhdG9ycyhvdGhlcikpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcIkRlY29yYXRvcnMgY2FuJ3QgYmUgcGxhY2VkIG9uIGRpZmZlcmVudCBhY2Nlc3NvcnMgd2l0aCBmb3IgXCIgKyBcInRoZSBzYW1lIHByb3BlcnR5IChcIiArIGVsZW1lbnQua2V5ICsgXCIpLlwiKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgb3RoZXIuZGVjb3JhdG9ycyA9IGVsZW1lbnQuZGVjb3JhdG9ycztcbiAgICAgICAgfVxuICAgICAgICBfY29hbGVzY2VHZXR0ZXJTZXR0ZXIoZWxlbWVudCwgb3RoZXIpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBuZXdFbGVtZW50cy5wdXNoKGVsZW1lbnQpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gbmV3RWxlbWVudHM7XG59XG5mdW5jdGlvbiBfaGFzRGVjb3JhdG9ycyhlbGVtZW50KSB7XG4gIHJldHVybiBlbGVtZW50LmRlY29yYXRvcnMgJiYgZWxlbWVudC5kZWNvcmF0b3JzLmxlbmd0aDtcbn1cbmZ1bmN0aW9uIF9pc0RhdGFEZXNjcmlwdG9yKGRlc2MpIHtcbiAgcmV0dXJuIGRlc2MgIT09IHVuZGVmaW5lZCAmJiAhKGRlc2MudmFsdWUgPT09IHVuZGVmaW5lZCAmJiBkZXNjLndyaXRhYmxlID09PSB1bmRlZmluZWQpO1xufVxuZnVuY3Rpb24gX29wdGlvbmFsQ2FsbGFibGVQcm9wZXJ0eShvYmosIG5hbWUpIHtcbiAgdmFyIHZhbHVlID0gb2JqW25hbWVdO1xuICBpZiAodmFsdWUgIT09IHVuZGVmaW5lZCAmJiB0eXBlb2YgdmFsdWUgIT09IFwiZnVuY3Rpb25cIikge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJFeHBlY3RlZCAnXCIgKyBuYW1lICsgXCInIHRvIGJlIGEgZnVuY3Rpb25cIik7XG4gIH1cbiAgcmV0dXJuIHZhbHVlO1xufVxuZnVuY3Rpb24gX2NsYXNzUHJpdmF0ZU1ldGhvZEdldChyZWNlaXZlciwgcHJpdmF0ZVNldCwgZm4pIHtcbiAgaWYgKCFwcml2YXRlU2V0LmhhcyhyZWNlaXZlcikpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiYXR0ZW1wdGVkIHRvIGdldCBwcml2YXRlIGZpZWxkIG9uIG5vbi1pbnN0YW5jZVwiKTtcbiAgfVxuICByZXR1cm4gZm47XG59XG5mdW5jdGlvbiBfY2hlY2tQcml2YXRlUmVkZWNsYXJhdGlvbihvYmosIHByaXZhdGVDb2xsZWN0aW9uKSB7XG4gIGlmIChwcml2YXRlQ29sbGVjdGlvbi5oYXMob2JqKSkge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgaW5pdGlhbGl6ZSB0aGUgc2FtZSBwcml2YXRlIGVsZW1lbnRzIHR3aWNlIG9uIGFuIG9iamVjdFwiKTtcbiAgfVxufVxuZnVuY3Rpb24gX2NsYXNzUHJpdmF0ZUZpZWxkSW5pdFNwZWMob2JqLCBwcml2YXRlTWFwLCB2YWx1ZSkge1xuICBfY2hlY2tQcml2YXRlUmVkZWNsYXJhdGlvbihvYmosIHByaXZhdGVNYXApO1xuICBwcml2YXRlTWFwLnNldChvYmosIHZhbHVlKTtcbn1cbmZ1bmN0aW9uIF9jbGFzc1ByaXZhdGVNZXRob2RJbml0U3BlYyhvYmosIHByaXZhdGVTZXQpIHtcbiAgX2NoZWNrUHJpdmF0ZVJlZGVjbGFyYXRpb24ob2JqLCBwcml2YXRlU2V0KTtcbiAgcHJpdmF0ZVNldC5hZGQob2JqKTtcbn1cbmZ1bmN0aW9uIF9jbGFzc1ByaXZhdGVNZXRob2RTZXQoKSB7XG4gIHRocm93IG5ldyBUeXBlRXJyb3IoXCJhdHRlbXB0ZWQgdG8gcmVhc3NpZ24gcHJpdmF0ZSBtZXRob2RcIik7XG59XG5mdW5jdGlvbiBfaWRlbnRpdHkoeCkge1xuICByZXR1cm4geDtcbn0iXX0=